// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://@sbaseurl@/jsapi/jsapi/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dojo/dom-geometry dojo/dom-class dojo/Evented dojo/debounce".split(" "),function(n,f,h,l,e,a,c,b){return n([l,c],{baseClass:"jimu-dijit-gridlayout",declaredClass:"jimu.dijit.GridLayout",container:null,layoutDefinition:null,components:null,editable:!1,_layout:null,_coordinates:null,_isCreatingLayout:null,postCreate:function(){this.inherited(arguments);this._isCreatingLayout=
!1;this._createLayout(this.layoutDefinition)},restoreLayout:function(a){a=a||this.layoutDefinition;this._createLayout(a)},destroy:function(){h.forEach(this.components,function(a){a.dijit.destroy()});this._layout.destroy();this.inherited(arguments)},getLayoutDefinition:function(){return this._layout.toConfig().content},resize:function(){var a=e.getMarginBox(this.container);this._layout.updateSize(a.w,a.h)},getComponentSize:function(a){return(a=this._layout.root.contentItems[0].getItemsById(a))&&0<
a.length?(a=a[0].container,{w:a.width,h:a.height}):{w:0,h:0}},getSize:function(){return{w:this._layout.width,h:this._layout.height}},setVisible:function(a,b){var d=this._layout.root.contentItems[0].getItemsById(a);d&&0<d.length&&!1===b?this._hideComponent(d[0]):d&&0!==d.length||!0!==b||this._showComponent(a)},highlightItem:function(a){(a=this._layout.root.contentItems[0].getItemsById(a))&&0<a.length&&a[0].highlight()},unhighlightItem:function(a){(a=this._layout.root.contentItems[0].getItemsById(a))&&
0<a.length&&a[0].unhighlight()},_createLayout:function(c){if(!this._isCreatingLayout){this._coordinates={};this._isCreatingLayout=!0;var g={settings:{hasHeaders:!1,resizeEnabled:this.editable,reorderEnabled:this.editable,selectionEnabled:this.editable,highlightEnabled:this.editable},dimensions:{borderWidth:1,dragProxyWidth:0,dragProxyHeight:0},content:c},d=this._layout;require(["libs/goldenlayout/goldenlayout"],f.hitch(this,function(m){this._layout=new m(g,this.container);this._layout.registerComponent("jimu grid",
f.hitch(this,function(a,d){var m;a.parent.config.id=d.id;h.some(this.components,function(b){if(b.id===d.id)return m=b.dijit,a.getElement().html(b.dijit.domNode),!0},this);a.on("resize",b(f.hitch(this,function(){0<a.width&&0<a.height&&m&&"function"===typeof m.resize&&m.resize(a.width,a.height)}),200));a.on("select",f.hitch(this,function(){this.editable&&a.parent.select();this.emit("mask-click",a.parent.config.id)}))}));this._layout.on("initialised",f.hitch(this,function(){this._resetCoordinate();this.emit("initialised");
this._isCreatingLayout=!1;d&&d.destroy()}));this._layout.on("stateChanged",f.hitch(this,function(){this._resetCoordinate()}));this._layout.init();this.editable||a.add(this._layout.root.childElementContainer[0],"viewonly");a.add(this._layout.root.childElementContainer[0],"jimu-dijit-gridlayout");setTimeout(f.hitch(this,this.resize),100)}))}},_hideComponent:function(a){a.parent&&a.parent.removeChild(a,!0)},_showComponent:function(a){var b,d,m,c,g,e,q;h.some(this.components,function(d){if(d.id===a)return b=
d,!0},this);b&&(c={id:a,type:"component",componentName:"jimu grid",componentState:{id:a}},d=this._coordinates[a],g=this._layout.root,d?(d[0].type!==g.contentItems[0].type&&(e=g.contentItems[0],g.replaceChild(e,{type:d[0].type,content:[]}),g.contentItems[0].addChild(e)),m=g,h.forEach(d,function(a){q=a.index<=m.contentItems.length?a.index:m.contentItems.length;"component"===a.type?m.addChild(c,q):("stack"!==a.type&&m.contentItems[a.index].type===a.type||m.addChild({type:a.type,content:[]},q),m=m.contentItems[q])},
this)):("stack"===g.contentItems[0].type&&(e=g.contentItems[0],g.replaceChild(e,{type:"column",content:[]}),g.contentItems[0].addChild(e)),g.contentItems[0].addChild(c)))},_resetCoordinate:function(){var a=this._layout.root.getItemsByType("component"),b=function(a,m){var d=a.parent;d&&(h.some(d.contentItems,function(d,b){if(d===a)return m.push({type:d.type,index:b}),!0}),b(d,m))};h.forEach(a,function(a){var d=[];b(a,d);this._coordinates[a.config.id]=d.reverse()},this)}})})},"widgets/Infographic/DijitFactory":function(){define("dojo/aspect dojo/_base/lang ./dijits/TextDijit ./dijits/ImageDijit ./dijits/ChartDijit ./dijits/GaugeDijit ./dijits/NumberDijit".split(" "),
function(n,f,h,l,e,a,c){var b={},g={},k=null,d=null,m=null,p=null,t={};b._dijits=g;b.createDijit=function(b){var q=null;if(g[b.id])return(q=g[b.id])&&"function"===typeof q.setVisible&&q.setVisible(b.visible),q;var u;switch(b.type){case "text":u=h;break;case "image":u=l;break;case "chart":u=e;break;case "gauge":u=a;break;case "number":u=c}if(!u)return console.error("Unknow type:",b.type),null;q={nls:k,config:b.config,map:d,inSettingPage:m,appConfig:p,jsonId:b.id,visible:b.visible};f.mixin(q,t);q=new u(q);
n.after(q,"destroy",function(){delete g[b.id]});return g[b.id]=q};b.setNls=function(a){k=a};b.setMap=function(a){d=a;Object.keys(g).forEach(function(a){g[a].setMap(d)})};b.setInSettingPage=function(a){m=a;Object.keys(g).forEach(function(a){g[a].setInSettingPage(m)})};b.setAppConfig=function(a){p=a;Object.keys(g).forEach(function(a){g[a].setAppConfig(p)})};b.setContext=function(a){t=a;Object.keys(g).forEach(function(a){f.mixin(g[a],t)})};return b})},"widgets/Infographic/dijits/TextDijit":function(){define(["dojo/_base/declare",
"dojo/_base/html","./BaseDijit","./styleUtils"],function(n,f,h,l){return n([h],{templateString:"\x3cdiv\x3e\x3c/div\x3e",type:"text",config:null,postCreate:function(){this.setConfig(this.config)},setConfig:function(e){this.config=e;f.empty(this.domNode);f.addClass(this.domNode,"table-layout-container");f.addClass(this.domNode,"no-trim");this.innerDom=f.create("div",{},this.domNode);f.place(this.innerDom,this.domNode);e={};l.background.setStyle(this.config.background,e,this);l.font.setStyle(this.config.font,
e);l.font.setText(this.config,this);f.setStyle(this.innerDom,e)}})})},"widgets/Infographic/dijits/BaseDijit":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin"],function(n,f,h){return n([f,h],{templateString:"\x3cdiv\x3ePlease create a sub class\x3c/div\x3e",type:"BaseDijit",config:null,inSettingPage:!0,appConfig:null,constructor:function(f){this.config=f.config},setInSettingPage:function(f){this.inSettingPage=f},setConfig:function(f){this.config=f},setMap:function(f){this.map=
f},setDataSource:function(f){this.dataSource=f},resize:function(){},setAppConfig:function(f){this.appConfig=f},onDataSourceDataUpdate:function(f){this.data=f},isDarkTheme:function(){var f=!1;this.appConfig&&("DashboardTheme"!==this.appConfig.theme.name||"default"!==this.appConfig.theme.styles[0]&&"style3"!==this.appConfig.theme.styles[0]?"DartTheme"===this.appConfig.theme.name&&(f=!0):f=!0);return f}})})},"widgets/Infographic/dijits/styleUtils":function(){define(["dojo/on","dojo/_base/lang","jimu/utils"],
function(n,f,h){var l={background:{setStyle:function(e,a,c){if(!e)return{};a||(a={});l.background.setBackgroundColor(e,a);l.background.setAlignment(e,a);l.background.setLink(e,a,c)},setBackgroundColor:function(e,a){e.backgroundColor&&(a.backgroundColor=e.backgroundColor)},setAlignment:function(e,a){if(e.alignment){if(e.alignment.horizontal)switch(e.alignment.horizontal){case "left":a.textAlign="left";break;case "center":a.textAlign="center";break;case "right":a.textAlign="right";break;default:a.textAlign=
"center"}if(e.alignment.vertical)switch(a.display="table-cell",e.alignment.vertical){case "top":a.verticalAlign="top";break;case "middle":a.verticalAlign="middle";break;case "bottom":a.verticalAlign="bottom";break;default:a.verticalAlign="middle"}}},setLink:function(e,a,c){c.clickHanlder&&(c.clickHanlder[0]&&c.clickHanlder[0].remove(),c.clickHanlder=null,a.cursor="auto");e.link&&(c.clickHanlder=c.own(n(c.domNode,"click",f.hitch(c,function(){window.open(e.link)}))),a.cursor="pointer")}},font:{setText:function(e,
a){var c="";e.text&&(c=e.text);a.innerDom.innerHTML=c},setStyle:function(e,a){if(!e)return{};a||(a={});l.font.setFont(e,a);l.font.setTextColor(e,a);l.font.setFontSize(e,a)},setFont:function(e,a){a.fontWeight="normal";a.fontStyle="normal";a.textDecoration="none";e.font&&(e.font.fontFamily&&(a.fontFamily=e.font.fontFamily),e.font.bold&&(a.fontWeight="bold"),e.font.italic&&(a.fontStyle="italic"),e.font.underline&&(a.textDecoration="underline"))},setTextColor:function(e,a){e.textColor&&(a.color=e.textColor)},
setFontSize:function(e,a){e.fontSize&&(a.fontSize=e.fontSize+"px")}},image:{setStyle:function(e,a,c){if(!e)return{};a||(a={});l.image.setBackgroundImg(e,a,c);l.image.setAlignment(e,a)},setBackgroundImg:function(e,a,c){var b="";if(b=e&&!e.image&&c&&c.folderUrl?"url("+c.folderUrl+"/images/default_image.png)":"url("+h.processUrlInWidgetConfig(e.image,c.folderUrl)+")")a.backgroundImage=b,a.backgroundRepeat="no-repeat",a.backgroundSize="contain"},setAlignment:function(e,a){if(e&&e.background){var c="center",
b="center";if(e.background.alignment){e.background.alignment.horizontal&&(c=e.background.alignment.horizontal);if(e.background.alignment.vertical)switch(e.background.alignment.vertical){case "top":b="top";break;case "middle":b="center";break;case "bottom":b="bottom";break;default:a.verticalAlign="center"}a.backgroundPosition=c+" "+b}}}},dataFormat:{getText:function(e,a){var c="";e.dataFormat&&(c=a?a:e.text,c=l.dataFormat.setDataFomat(e,c),e.dataFormat.prefix&&(c=e.dataFormat.prefix+" "+c),e.dataFormat.suffix&&
(c=c+" "+e.dataFormat.suffix));return c},setDataFomat:function(e,a){var c=e.dataFormat.unit;"none"===e.dataFormat.unit?c="":"percentage"===e.dataFormat.unit&&(c="%");return a=a+c+"("+e.dataFormat.decimalPlaces+") "}}};return l})},"widgets/Infographic/dijits/ImageDijit":function(){define(["dojo/_base/declare","dojo/_base/html","./BaseDijit","./styleUtils"],function(n,f,h,l){return n([h],{templateString:"\x3cdiv\x3e\x3c/div\x3e",type:"image",config:null,constructor:function(e){this.config=e.config},
postCreate:function(){this.setConfig(this.config)},setConfig:function(e){this.config=e;this.domNode.innerHTML="";f.addClass(this.domNode,"table-layout-container");this.innerDom=f.create("div",{"class":"image-node"},this.domNode);f.place(this.innerDom,this.domNode);e={};l.background.setStyle(this.config.background,e,this);l.image.setStyle(this.config,e,this);f.setStyle(this.innerDom,e)}})})},"widgets/Infographic/dijits/ChartDijit":function(){define("dojo/_base/lang dojo/_base/html dojo/_base/declare ./BaseDijit dojo/text!./ChartDijit.html moment/moment jimu/dijit/_chartDijitOption jimu/dijit/Chart jimu/DataSourceManager jimu/LayerInfos/LayerInfos ../utils".split(" "),
function(n,f,h,l,e,a,c,b,g,k,d){window.makeTwix(a);return h([l],{templateString:e,type:"chart",baseClass:"infographic-chart-dijit",layerInfosObj:null,dataSourceManager:null,featuresCountForPreview:50,dataSource:null,config:null,map:null,maxTimeIntervals:1E4,maxLabels:1E4,dsType:"",constructor:function(a){this.visible=a.visible;this.config=this._classifyChartConfig(a.config);this.layerInfosObj=k.getInstanceSync();this.dataSourceManager=g.getInstance();this.popupInfo=this.layerObject=this.featureLayerForFrameWork=
null},postCreate:function(){this.inherited(arguments);this._init()},setLayerInfo:function(a,d,b){this.layerObject=a;this.popupInfo=b;this.featureLayerForFrameWork=d;this._initChartDijitOption()},getDataURL:function(){if(this.chart)return this.chart.getDataURL()},resize:function(){this.chart&&this.chart.resize()},setVisible:function(a){this.visible=a},destroy:function(){this.chart&&this.chart.destroy();this.chart=null;this.inherited(arguments)},clearChart:function(){this.chart&&this.chart.clear();
this.showNodata()},setBackgroundColor:function(a){this.domNode.style.backgroundColor=a},_setyAxisName:function(){var a=(this.config=this._classifyChartConfig(this.config))&&this.config.display;(a=a&&a.yAxis)&&a.show&&"undefined"!==typeof a.name?(this._showyAxisName(),this._setyAxisNameText(a.name),(a=a.nameTextStyle)&&a.color&&this._setyAxisNameColor(a.color)):this._hideyAxisName()},_setyAxisNameText:function(a){this.yAxisName.innerHTML=a},_setyAxisNameColor:function(a){f.setStyle(this.yAxisName,
"color",a)},_hideyAxisName:function(){f.setStyle(this.yAxisName,"display","none")},_showyAxisName:function(){f.setStyle(this.yAxisName,"display","flex")},resetData:function(){this.dataSource=null;this.dsType="";this.data=null;this._hasStatisticsed=void 0;this.featureLayerForFrameWork=this.popupInfo=this.layerObject=null;this.chartDijitOption.init(null,null,null,this.map)},setDataSource:function(a){this.inherited(arguments);this.dataSource=a;this._calcDataSourceType(this.dataSource)},onUpdateDataStart:function(){this._showOverlay()},
onUpdateDataDone:function(){this._hideOverlay()},_calcDataSourceType:function(a){a.layerId?this.dsType="CLIENT_FEATURES":a.frameWorkDsId&&(a=(a=d.getDsTypeInfoMeta(a.frameWorkDsId,this.appConfig))&&a.dsMeta)&&("Features"===a.type?this.dsType="FRAMEWORK_FEATURES":"FeatureStatistics"===a.type&&(this.dsType="FRAMEWORK_STATISTICS"))},setConfig:function(a){this.config=this._classifyChartConfig(a)},onDataSourceDataUpdate:function(a){a&&"undefined"!==typeof a.features&&(this.inSettingPage&&a.features.length>
this.featuresCountForPreview&&(a.features=a.features.slice(0,this.featuresCountForPreview)),this.data=a,this._hasStatisticsed=!!a.hasStatisticsed)},startRendering:function(){this._shouldRenderChart()&&((this.chart||this._createJimuChart(),this._updateBackgroundColor(),this._setyAxisName(),this._splitConfig(),this._createChartSeriesOption(),this.seriesOption)?this._checkIsTooManyLabels(this.seriesOption)||(this._createChartOption(),this.chart.updateConfig(this.chartOption),this.chart.resize()):this.showNodata())},
_createChartOption:function(){var a=this._isSameFeatures(),b=d.isEqual(this.dataOption,this._oldDataOption)&&d.isEqual(this.displayOption,this._oldDisplayOption);a&&b||(this.chartOption=null,this.seriesOption&&(this.chartOption=this.chartDijitOption.updateChartOptionDisplay(n.clone(this.seriesOption),this.displayOption,this.dataOption),this._oldDisplayOption=null,this._oldDisplayOption=n.clone(this.displayOption)))},_createChartSeriesOption:function(){var a=this._isSameFeatures(),b=d.isEqual(this.dataOption,
this._oldDataOption);a&&b||(this._oldDataOption=null,this._oldDataOption=n.clone(this.dataOption),a=this.dataOption,a.features=this.features,b=this.chartDijitOption.getClientStatisticsData(a),this.seriesOption=null,b&&(this.chartDijitOption.bindChartEvent(this.chart,a,b),this.seriesOption=this.chartDijitOption.getChartOptionSeries(this.dataOption,b)))},_splitConfig:function(){if(this.config){this.config=this._classifyChartConfig(this.config);var a=this.config.data,d=this.config.display;this.features=
this._cleanFeatures(this.data.features);var b=this.dataSource.filterByExtent,c=this.dataSource.useSelection,g=this._isStatisticsed(),b={filterByExtent:b,useSelection:c,hasStatisticsed:g};this.dataOption=null;this.dataOption=n.mixin(b,a);this.displayOption=null;this.displayOption=d}},_cleanFeatures:function(a){if(a&&a.length)return a.map(function(a){return{attributes:a.attributes}})},_isSameFeatures:function(){var a=this.features;if(!a)return!0;a=a.map(function(a){return a.attributes});if(d.isEqual(a,
this._oldFeatureAttrs))return!0;this._oldFeatureAttrs=a},_isStatisticsed:function(){return this.inSettingPage?"FRAMEWORK_STATISTICS"===this.dsType:!!this._hasStatisticsed},_shouldRenderChart:function(){if(this.visible&&this.config){var a=this.domNode&&this.data&&this.data.features&&this._hasVaildConfig(this.config.data),d;if("CLIENT_FEATURES"===this.dsType)d=!!this.layerObject;else if("FRAMEWORK_FEATURES"===this.dsType||"FRAMEWORK_STATISTICS"===this.dsType)d=!!this.featureLayerForFrameWork;if(a&&
d){if(this._checkIsTooManyTimeInterval(this.data.features))return this.showNodata(this.nls.parsingperiodTip),!1}else return this.showNodata(),!1;this.hideNodata();return!0}},_hasVaildConfig:function(a){if(!a||!a.mode)return!1;var d=a.valueFields;if("feature"===a.mode)return a.labelField&&d&&d.length;if("category"===a.mode)return a.categoryField&&a.operation&&d&&d.length;if("count"===a.mode)return a.categoryField;if("field"===a.mode)return a.operation&&d&&d.length},_getNodataTextColor:function(){var a;
a=this.config&&this.config.display;var d=this.config&&this.config.data;if(!a||!d)return"#666";(a="pie"===d.type?a.dataLabelColor:a.horizontalAxisTextColor||a.verticalAxisTextColor)||(a="#666");return a},_classifyChartConfig:function(a){if(a)return a&&!a.data&&(a=d.classifyChartConfig(a)),this._specialChartConfig(a),a},_specialChartConfig:function(a){var d=a&&a.data;if(d){var b=d.mode,c=d.sortOrder;"feature"===b&&c&&c.field===d.labelField&&(c.isLabelAxis=!0);"undefined"!==typeof d.labelField&&"feature"===
b?d.clusterField=d.labelField:"undefined"===typeof d.categoryField||"category"!==b&&"count"!==b||(d.clusterField=d.categoryField)}if(a=a&&a.display)d&&(a.mode=d.mode),a.theme||(a.theme=this._getChartTheme())},_showOverlay:function(){f.removeClass(this.overlap,"hide")},_hideOverlay:function(){f.addClass(this.overlap,"hide")},showNodata:function(a){f.addClass(this.domNode,"no-data");this._setNoDataColor();a&&(this.noDataDiv.innerHTML=a)},_setNoDataColor:function(){var a=this._getNodataTextColor();this.noDataDiv&&
this.noDataDiv.style&&(this.noDataDiv.style.color=a)},_initChartDijitOption:function(){if(this.chartDijitOption){var a=null,a="CLIENT_FEATURES"===this.dsType?this.layerObject:this.featureLayerForFrameWork;this.chartDijitOption.init(a,this.layerObject,this.popupInfo,this.map,this.layerObject)}},_checkIsTooManyLabels:function(a){return(a=a.labels)&&a.length>this.maxLabels?(this.showNodata(this.nls.manyCategoryTip),!0):!1},_checkIsTooManyTimeInterval:function(d){var b=this.config&&this.config.data,b=
b&&b.dateConfig;if(!b||"automatic"===b.minPeriod)return!1;var c=b.categoryField,g=d.map(n.hitch(this,function(a){return a.attributes[c]})),g=g.filter(function(a){return!!a});d=Math.min.apply(Math,g);g=Math.max.apply(Math,g);d=a(d).subtract(1,"seconds").local();g=a(g).add(1,"seconds").local();return Math.round(g.diff(d,b.minPeriod,!0))>=this.maxTimeIntervals},_createChartDijitOption:function(){var a={map:null};this.inSettingPage||(a.map=this.map);this.chartDijitOption=new c(a)},_init:function(){this._createChartDijitOption();
this._updateBackgroundColor()},_createJimuChart:function(){var a=this.config&&this.config.data;this.DEFAULT_CONFIG={type:a&&a.type||"column",theme:this._getChartTheme(),labels:[],series:[{data:[]}]};this.chart=new b({chartDom:this.chartDomNode,config:this.DEFAULT_CONFIG});this.chart.placeAt(this.chartDomNode);this.chart.resize()},_getChartTheme:function(){return this.isDarkTheme()?"dark":"light"},_updateBackgroundColor:function(){var a=(this.config=this._classifyChartConfig(this.config))&&this.config.display;
a&&a.backgroundColor&&this.setBackgroundColor(a.backgroundColor)},hideNodata:function(){f.removeClass(this.domNode,"no-data")}})})},"jimu/dijit/_chartDijitOption":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/_base/lang","jimu/clientStatisticsUtils","jimu/_chartHelpUtils"],function(n,f,h,l,e){return n([f],{postMixInProperties:function(){this.nls=window.jimuNls.statisticsChart},constructor:function(a){this.map=a.map;this.chartHelpUtils=new e({map:this.map,clientStatisticsUtils:l})},
init:function(a,c,b,g,k){this.chartHelpUtils.setLayerFeatureLayer(a);this.chartHelpUtils.setSymbolLayer(c);this.chartHelpUtils.setPopupInfo(b);this.chartHelpUtils.setMap(g);this.chartHelpUtils.setLayerObject(k)},getClientStatisticsData:function(a){var c=l.getClietStatisticsData(a),c=l.sortClientStatisticsData(c,a),c=l.getDataForMaxLabels(c,a.maxLabels);return c=this.chartHelpUtils.keepStatisticsDataBestDecimalPlace(a,c,a.mode)},bindChartEvent:function(a,c,b){this.chartHelpUtils.bindChartEvent(a,c,
b)},getChartOptionSeries:function(a,c){return this._createOptionSeries(a,c)},updateChartOptionDisplay:function(a,c,b){this._assigneeSettingColorToSeries(a,c,b);this.chartHelpUtils.updateChartSeriesDisplayName(a,c,b);return this._mapSettingConfigToChartOption(a,c,b)},_assigneeSettingColorToSeries:function(a,c,b){if(!a||!a.series)return a;this.chartHelpUtils.assigneeSettingColor(c,a.series,b)},_createOptionSeries:function(a,c){var b=a.type,g=a.mode;a=a.valueFields;var k=[],k="count"===g?[""]:"field"===
g?[""]:h.clone(a),d=null,d={type:b,labels:[],series:[]};d.series=k.map(h.hitch(this,function(a){return{name:a,type:b,data:[]}}));c.forEach(h.hitch(this,function(a){var b=a.label;d.labels.push(b);for(var c=0;c<a.values.length;c++){var m={value:a.values[c],name:b,unit:a.unit};"feature"===g&&(m.originValue=a.originalValues[c]);d.series[c].data.push(m)}}));return d},_mapSettingConfigToChartOption:function(a,c,b){var g=b.type;this._settingColorArrayForPie(a,c,g,b.mode);this._settingAxisDisplay(a,c,g);
a.type=g;a.dataZoom=["inside","slider"];a.confine=!0;a.backgroundColor=c.backgroundColor;c.marks&&c.marks.markLine&&(a.markLine=h.clone(c.marks.markLine));c.marks&&c.marks.markArea&&(a.markArea=h.clone(c.marks.markArea));c.legend&&(a.legend=h.clone(c.legend));c.xAxis&&(a.xAxis=h.clone(c.xAxis));c.yAxis&&(a.yAxis=h.clone(c.yAxis));c.dataLabel&&(a.dataLabel=h.clone(c.dataLabel));"pie"===g&&(a.innerRadius=c.innerRadius);a.theme=c.theme||"light";return a},_settingColorArrayForPie:function(a,c,b,g){"pie"===
b&&"field"!==g&&(c=c.seriesStyle)&&c.styles&&c.styles[0]&&(c=c.styles[0].style)&&Array.isArray(c.color)&&(b=h.clone(c.color),2===b.length&&(b=this.chartHelpUtils.getColors(h.clone(c.color),6)),a.color=b)},_settingAxisDisplay:function(a,c,b){if(!(0>["column","bar","line"].indexOf(b))){c.stack||(c.stack=!1);if("column"===b||"bar"===b||"line"===b&&c.area)a.stack=c.stack;"line"!==b||c.area||(c.area=!1);"line"===b&&(a.area=c.area);a.axisPointer=!0;a.scale=!1}}})})},"jimu/clientStatisticsUtils":function(){define(["dojo/_base/lang",
"moment/moment","./_chartHelpUtils","jimu/utils"],function(n,f,h,l){window.makeTwix&&window.makeTwix(f);return{getClietStatisticsData:function(e){var a=e.mode;if("feature"===a)return this.getFeatureModeStatisticsData(e);if("category"===a)return this.getCategoryModeStatisticsData(e);if("count"===a)return this.getCountModeStatisticsData(e);if("field"===a)return this.getFieldModeStatisticsData(e)},sortClientStatisticsData:function(e,a){return this.sortStatisticsData(e,a.mode,a.sortOrder,a.clusterField,
a.valueFields)},getDataForMaxLabels:function(e,a){return e&&e.length&&"number"===typeof a&&0<a&&a<e.length?e.slice(0,a):e},getFeatureModeStatisticsData:function(e){var a=e.features,c=e.clusterField,b=e.valueFields;e=void 0!==e.showNullLabelData?e.showNullLabelData:!0;var g=this.separateFeaturesWhetherFieldValueNull(c,a),a=g.notNullLabelFeatures,g=g.nullLabelFeatures,a=e?a.concat(g):a;e=[];return e=a.map(function(a){var d=a.attributes,g=d&&d[c],g=this.convertingNullOrUndefinedAsPlaceholders(g);a={label:g,
values:[],features:[a]};a.values=b.map(function(a){return d[a]});return a}.bind(this))},getCategoryModeStatisticsData:function(e){function a(a){var d=[],p=null,e;for(e in a){p=a[e];e=this.keepFieldValueType(e,p.type,k);var f=this.calcValuesByFeaturesForCatetoryMode(b,p,c,g,m);d.push({label:e,values:f,features:p.features,unit:p.unit})}return d}var c=e.hasStatisticsed,b=e.valueFields,g=e.operation,k=e.dateConfig,d=void 0!==e.showNullLabelData?e.showNullLabelData:!0,m=e.nullValue,p=[],p=this.getCluseringObj(e.clusterField,
e.features,k);e=p.nullLabel;p=a.call(this,p.notNullLabel);e=a.call(this,e);return p=d?p.concat(e):p},getCountModeStatisticsData:function(e){function a(a){var d=[],b=null,g;for(g in a){var b=a[g],e=this.calcValuesByFeaturesForCountMode(b,k);g=this.keepFieldValueType(g,b.type,c);d.push({label:g,values:e,features:b.features,unit:b.unit})}return d}var c=e.dateConfig,b=void 0!==e.showNullLabelData?e.showNullLabelData:!0,g=[],k=e.hasStatisticsed&&!c,g=this.getCluseringObj(e.clusterField,e.features,c);e=
g.nullLabel;g=a.call(this,g.notNullLabel);e=a.call(this,e);return g=b?g.concat(e):g},calcValuesByFeaturesForCountMode:function(e,a){return a?e.features.map(function(a){var b=(a=a.attributes)&&a.STAT_COUNT;"undefined"===typeof b&&(b=a.stat_count);return b}.bind(this)):[e.count]},getFieldModeStatisticsData:function(e){var a=e.hasStatisticsed,c=e.features,b=e.operation,g=e.nullValue,k=[];return k=e.valueFields.map(n.hitch(this,function(d){var m=this.getValuesByValueFieldForFieldMode(d,c,a,b),m=this.calcValueByOperation(m,
b,g);return{label:d,values:[m]}}))},getValuesByValueFieldForFieldMode:function(e,a,c,b){b="average"===b?"avg":b;if(c)var g=l.upperCaseString(e+"_"+b),k=l.lowerCaseString(e+"_"+b);return a.map(n.hitch(this,function(a){if(a=a.attributes){var d;c?(d=a[g],"undefined"===typeof d&&(d=a[k])):d=a[e];return d}}))},sortStatisticsData:function(e,a,c,b,g){function k(a,d,c){var m;if("category"===d)c.isLabelAxis?c.isLabelAxis&&(m=a.label):c.field||1!==a.values.length?(c=g.indexOf(c.field),m=a.values[c]):m=a.values[0];
else if("count"===d)m=a.label,m=c.isLabelAxis?m:a.values[0];else if("field"===d)m=c.isLabelAxis?a.label:a.values[0];else if("feature"===d){var k=c.field;a&&a.features&&a.features[0]&&(d=a.features[0].attributes)&&(c.isLabelAxis?m=d[b]:k?m=d[k]:a.values.length&&(m=a.values[0]))}return m}if(!c)return e;var d=c.isAsc;if(!Array.isArray(e))return e;e.sort(function(b,g){b=k(b,a,c);g=k(g,a,c);"_NULL\x26UNDEFINED_"===b&&(b=Infinity);"_NULL\x26UNDEFINED_"===g&&(g=Infinity);l.isNumberOrNumberString(b)&&(b=
Number(b));l.isNumberOrNumberString(g)&&(g=Number(g));var m=b>g?d:!d;Infinity===b?m=d:Infinity===g&&(m=!d);var p=0;b!==g&&(p=m?1:-1);return p}.bind(this));return e},convertingNullOrUndefinedAsPlaceholders:function(e){return null===e||void 0===e?"_NULL\x26UNDEFINED_":e},keepFieldValueType:function(e,a,c){"number"===a&&(e=Number(e));c&&"_NULL\x26UNDEFINED_"!==e&&(e=Number(e));return e},calcValuesByFeaturesForCatetoryMode:function(e,a,c,b,g){return e.map(function(k){k=this.getValuesByValueFieldForCategoryMode(k,
a.features,c,b);return this.calcValueByOperation(k,b,g)}.bind(this))},getValuesByValueFieldForCategoryMode:function(e,a,c,b){b="average"===b?"avg":b;if(c)var g=l.upperCaseString(e+"_"+b),k=l.lowerCaseString(e+"_"+b);return a.map(n.hitch(this,function(a){if(a=a.attributes){var d;c?(d=a[g],"undefined"===typeof d&&(d=a[k])):d=a[e];return d}}))},_isNumber:function(e){return"[object number]"===Object.prototype.toString.call(e).toLowerCase()},_getDateUnit:function(e,a){var c=a;"automatic"===a&&(a=f(e[0]).local(),
e=f(e[1]).local(),e=Math.round(e.diff(a,"minute",!0)),0<=e&&1>=e?c="second":1<e&&60>=e?c="minute":60<e&&1440>=e?c="hour":1440<e&&43200>=e?c="day":43200<e&&518400>=e?c="month":518400<e&&(c="year"));return c},_getTimeRange:function(e,a){var c=e.map(n.hitch(this,function(b){return(b=b.attributes)&&b[a]})),c=c.filter(function(a){return!!a});e=Math.min.apply(Math,c);c=Math.max.apply(Math,c);return[e,c]},_getTimeTwixs:function(e,a,c){if(0>"year month day hour minute second automatic".split(" ").indexOf(c))return console.log("Invaild data formatter: "+
c),!1;e=this._getTimeRange(e,a);if(e[0]===e[1])return!1;c=this._getDateUnit(e,c);a=this.getStartTimeByUnit(e[0],c);a=f(a).local();e=f(e[1]).local();e=a.twix(e).split(1,c);a={startValue:e[e.length-1].end().valueOf(),endValue:Infinity};e.push(a);return{twixs:e,dateUnit:c}},getCluseringObj:function(e,a,c){var b={},g={};c?(e=this.getClusteringObjForDateType(e,a,c),b=e.notNullLabel,g=e.nullLabel):(b=this.separateFeaturesWhetherFieldValueNull(e,a),a=b.nullLabelFeatures,b=this.getClusteringObjByField(b.notNullLabelFeatures,
e),g=this.getClusteringObjByField(a,e));return{notNullLabel:b,nullLabel:g}},calcValueByOperation:function(e,a,c){if(e&&1===e.length){if(!c)return e[0];if(!this._isNumber(e[0]))return 0}var b;if(0!==e.length){b=0;"max"===a?b=-Infinity:"min"===a&&(b=Infinity);e=c?e.map(function(a){this._isNumber(a)||(a=0);return a}.bind(this)):e.filter(function(a){return this._isNumber(a)}.bind(this));var g=0;e.forEach(n.hitch(this,function(c){g++;"average"===a||"sum"===a?b+=c:"max"===a?b=Math.max(b,c):"min"===a&&(b=
Math.min(b,c))}));0<g?"average"===a&&(b/=g):b=null}else b=null;return b},getClusteringObjByField:function(e,a){var c={};e.forEach(n.hitch(this,function(b){var g=b.attributes,g=g&&g[a],k=typeof g,g=this.convertingNullOrUndefinedAsPlaceholders(g),d=null;c.hasOwnProperty(g)?(d=c[g],d.features.push(b),d.count++):(d={count:1,features:[b],type:k},c[g]=d)}));return c},_removeNaNDataItem:function(e){return e.filter(function(a){var c=!1;a=a.category;"number"===typeof a&&(c=isNaN(a));return!c})},separateFeaturesWhetherFieldValueNull:function(e,
a){var c=[],b=[];Array.isArray(a)&&(b=a.filter(function(a){var b=a.attributes,b=b&&b[e];if(null===b||void 0===b)c.push(a);else return!0}));return{nullLabelFeatures:c,notNullLabelFeatures:b}},getStartTimeByUnit:function(e,a){return f(e).startOf(a).utc().valueOf()},_mosaicFieldNameWithOperatorAndUpper:function(e,a){return l.upperCaseString(e+"_"+a)},_mosaicFieldNameWithOperatorAndLower:function(e,a){return l.lowerCaseString(e+"_"+a)},getClusteringObjForDateType:function(e,a,c){function b(a,d,b){a[d]?
(a=a[d],a.count+=b.count,a.features=a.features.concat(b.features)):a[d]=b}function g(a,d,b,c){d=Number(d);c=this.getStartTimeByUnit(d,c);a[c]?(a=a[c],a.count+=b.count,a.features=a.features.concat(b.features)):(b.originTime=d,a[c]=b)}function k(a,d,b){b[a[0].attributes[d]]={count:1,features:a};return b}var d=this.separateFeaturesWhetherFieldValueNull(e,a),m=d.notNullLabelFeatures;a={};a=this.getClusteringObjByField(d.nullLabelFeatures,e);d={};if(1===m.length)d=k.call(this,m,e,d,c);else if(0!==m.length){var p=
this._getTimeTwixs(m,e,c.minPeriod);if(p){var f={},l=p.dateUnit;p.twixs.forEach(function(a){var d="undefined"!==typeof a.startValue?a.startValue:a.start().valueOf(),g="undefined"!==typeof a.endValue?a.endValue:a.end().valueOf(),k={unit:l,count:0,features:[]};m.forEach(n.hitch(this,function(a){var b=a.attributes,b=b&&b[e];b>=d&&b<g&&(k.features.push(a),k.count++)}));c.isNeedFilled?b.call(this,f,d,k):0<k.count&&b.call(this,f,d,k)}.bind(this));var p={},q,h;for(q in f)f.hasOwnProperty(q)&&(h=f[q],g.call(this,
p,q,h,l));for(q in p)if(p.hasOwnProperty(q)){h=p[q];var w=h.originTime;delete h.originTime;d[w]=h}}else d=k.call(this,m,e,d,c)}return{notNullLabel:d,nullLabel:a}},_mapOptions:function(e,a){"feature"===a?(a=e.labelField,delete e.labelField,e.clusterField=a,e.showNullLabelData=!0):"category"===a?(a=e.categoryField,delete e.categoryField,e.clusterField=a,e.showNullLabelData=!0):"count"===a?(a=e.categoryField,delete e.categoryField,e.clusterField=a):"field"===a&&(e.showNullLabelData=!0);return e},_mapDataItemForStatisticsChart:function(e,
a){var c,b,g;return e.map(function(k){c=k.label;delete k.label;b=k.values;delete k.values;g=k.features;delete k.features;"feature"===a?(k.category=c,k.valueFields=b,k.dataFeatures=g):"category"===a?(k.category=c,k.valueFields=b,k.dataFeatures=g):"count"===a?(k.fieldValue=c,k.count=b[0],k.dataFeatures=g):"field"===a&&(k.label=c,k.value=b[0]);return k})},getFeatureModeStatisticsInfo:function(e){var a=new h({featureLayer:e.layerDefinition,popupInfo:e.popupFieldInfosObj});e=this._mapOptions(e,"feature");
var c=e.clusterField,b=this.getFeatureModeStatisticsData(e),b=this.sortStatisticsData(b,"feature",e.sortOrder,c),b=this.getDataForMaxLabels(b,e.maxLabels),b=a.getBestLabelDisplay(b,c,"feature"),b=a.keepStatisticsDataBestDecimalPlace(e,b,"feature");return this._mapDataItemForStatisticsChart(b,"feature")},getCategoryModeStatisticsInfo:function(e){var a=new h({featureLayer:e.layerDefinition,popupInfo:e.popupFieldInfosObj});e=this._mapOptions(e,"category");var c=e.clusterField,b=this.getCategoryModeStatisticsData(e),
b=this.sortStatisticsData(b,"category",e.sortOrder,null,e.valueFields),b=this._removeNaNDataItem(b),b=this.getDataForMaxLabels(b,e.maxLabels),b=a.getBestLabelDisplay(b,c,"category"),b=a.keepStatisticsDataBestDecimalPlace(e,b,"category");return this._mapDataItemForStatisticsChart(b,"category")},getCountModeStatisticsInfo:function(e){var a=new h({featureLayer:e.layerDefinition,popupInfo:e.popupFieldInfosObj});e=this._mapOptions(e,"count");var c=e.clusterField,b=this.getCountModeStatisticsData(e),b=
this.sortStatisticsData(b,"count",e.sortOrder),b=this.getDataForMaxLabels(b,e.maxLabels),b=a.getBestLabelDisplay(b,c,"count");return this._mapDataItemForStatisticsChart(b,"count")},getFieldModeStatisticsInfo:function(e){var a=new h({featureLayer:e.layerDefinition,popupInfo:e.popupFieldInfosObj});e=this._mapOptions(e,"category");var c=this.getFieldModeStatisticsData(e),c=this.sortStatisticsData(c,"field",e.sortOrder),c=this.getDataForMaxLabels(c,e.maxLabels),c=a.getBestLabelDisplay(c,null,"field"),
c=a.keepStatisticsDataBestDecimalPlace(e,c,"field");return this._mapDataItemForStatisticsChart(c,"field")}}})},"jimu/_chartHelpUtils":function(){define("dojo/_base/declare jimu/utils dojo/_base/lang dojo/_base/config dojo/_base/Color ./_dateFormat moment/moment esri/lang esri/graphic esri/symbols/jsonUtils".split(" "),function(n,f,h,l,e,a,c,b,g,k){return n(null,{constructor:function(a){a&&h.mixin(this,a);this.popupInfo||(this.popupInfo={});this.featureLayer||(this.featureLayer={});this._cachePlaces=
{}},setLayerFeatureLayer:function(a){this.featureLayer=a},setLayerObject:function(a){this.layerObject=a},setSymbolLayer:function(a){this.symbolLayer=a},setPopupInfo:function(a){this.popupInfo=a},setMap:function(a){this.map=a},getBestLabelDisplay:function(a,b,c){if("feature"===c)return this.betterDataCategoryForFeatureMode(a,b);if("category"===c||"count"===c)return this.betterDataCategoryForCategoryCountMode(a,b);if("field"===c)return this.betterDataCategoryForFieldMode(a)},betterDataCategoryForFeatureMode:function(a,
b){a.forEach(h.hitch(this,function(a){a.label=this.getBestDisplayValue(b,a.label)}));return a},betterDataCategoryForFieldMode:function(a){a.forEach(h.hitch(this,function(a){a.label=this.getFieldAlias(a.label)}));return a},betterDataCategoryForCategoryCountMode:function(a,b){a.forEach(h.hitch(this,function(a){a.label="undefined"!==typeof a.unit?this.getCategoryDisplayForDateUnit(a.label,a.unit):this.getBestDisplayValue(b,a.label)}));return a},keepStatisticsDataBestDecimalPlace:function(a,b,c){if("count"===
c)return b;var d=a.valueFields,g=a.operation;this.cacheDecimalPlace(d,a.features,this.popupInfo);var m=null;"feature"===c||"category"===c?b.forEach(h.hitch(this,function(a){a.originalValues=h.clone(a.values);d.forEach(h.hitch(this,function(d,b){var c=a.values[b];this.isIntegerNumberField(d)&&"average"===g?c=this.getBestValueForIntegerFieldAverage(c,6):(m=this._getFieldDecimalPlaceFromCache(d),c=this.formatValuePlaces(c,m));a.values[b]=c}))})):"field"===c&&d.forEach(h.hitch(this,function(a){b.some(h.hitch(this,
function(d){if(d.label===a){var b=d.values[0];this.isIntegerNumberField(a)&&"average"===g?b=this.getBestValueForIntegerFieldAverage(b,6):(m=this._getFieldDecimalPlaceFromCache(a),b=this.formatValuePlaces(b,m));d.values[0]=b;return!0}return!1}))}));return b},isIntegerNumberField:function(a){if(!this.featureLayer||!this.featureLayer.fields)return!1;var d=["esriFieldTypeSmallInteger","esriFieldTypeInteger"];return this.featureLayer.fields.some(h.hitch(this,function(b){return b.name===a&&0<=d.indexOf(b.type)}))},
formatValuePlaces:function(a,b){return"number"!==typeof b||!a&&0!==a?a:a.toFixed(b)},getBestValueForIntegerFieldAverage:function(a,b){a=Number(a);if("number"!==typeof a)return a;var d=0,c=a.toString().split(".");1===c.length?d=0:2===c.length&&(d=c[1].length);return 0<d?(d>b&&(d=b),a=a.toFixed(d),parseFloat(a)):a},_getFieldDecimalPlaceFromCache:function(a){var d;this._cachePlaces&&(a=this._cachePlaces[a],"number"===typeof a&&(d=a));return d},cacheDecimalPlace:function(a,b,c){this._cachePlaces={};if(a&&
a.length){var d=a.filter(h.hitch(this,function(a){return this.isFloatNumberField(a)})),g={};d.forEach(h.hitch(this,function(a){g[a]=[]}));b&&0<b.length&&b.forEach(h.hitch(this,function(a){var b=a.attributes;b&&d.forEach(h.hitch(this,function(a){var d=b[a];"number"===typeof d&&g[a].push(d)}))}));d.forEach(h.hitch(this,function(a){var d=this.getFieldInfoFromPopupInfo(c,a);this._cachePlaces[a]=0;var b=g[a];if(0<b.length)try{var m=this.getBestDecimalPlaceForArrayValues(b);this._cachePlaces[a]=m}catch(r){this._cachePlaces[a]=
0,console.error(r)}c&&((d=this.getPlacesFromPopupFieldInfo(d))||0===d)&&(this._cachePlaces[a]=d)}))}},getBestDecimalPlaceForArrayValues:function(a){var d=0,b={};a.forEach(function(a){a=a.toString().split(".");var d=null;1===a.length?d=0:2===a.length&&(d=a[1].length);null!==d&&(b[d]=void 0===b[d]?1:b[d]+1)});a=null;for(var c in b){c=parseInt(c,10);var g=b[c];a?g>a.value&&(a={key:c,value:g}):a={key:c,value:g}}a&&(d=parseInt(a.key,10));return d},getFieldInfoFromPopupInfo:function(a,b){var d=null;return a&&
a.fieldInfos?d=a.fieldInfos.filter(function(a){return a.fieldName===b})[0]:d},getPlacesFromPopupFieldInfo:function(a){return a&&a.format&&a.format.places},getAliasFromPopupInfo:function(a,b){var d=b;if(!a||!a.fieldInfos)return d;(a=a.fieldInfos)&&0<a.length&&a.some(function(a){if(a.fieldName===b)return d=a.label,!0});return d},isFloatNumberField:function(a){if(!this.featureLayer||!this.featureLayer.fields)return!1;var b=["esriFieldTypeSingle","esriFieldTypeDouble"];return this.featureLayer.fields.some(h.hitch(this,
function(d){return d.name===a&&0<=b.indexOf(d.type)}))},isNumberField:function(a){if(!this.featureLayer||!this.featureLayer.fields)return!1;var b=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return this.featureLayer.fields.some(h.hitch(this,function(d){return d.name===a&&0<=b.indexOf(d.type)}))},isDateField:function(a){return(a=this.getFieldInfo(a))?"esriFieldTypeDate"===a.type:!1},getFieldInfo:function(a){if(this.featureLayer)for(var b=this.featureLayer.fields,
d=0;d<b.length;d++)if(b[d].name===a)return b[d];return null},getFieldAliasArray:function(a){return a.map(h.hitch(this,function(a){return this.getFieldAlias(a)}))},getBestDisplayValue:function(a,b){if("_NULL\x26UNDEFINED_"===b)return"null";if(this.isDateField(a))return this.formatedDateByPopupInfoOrLocal(a,b);var d={};d[a]=b;d=f.getDisplayValueForCodedValueOrSubtype(this.layerObject||this.featureLayer,a,d);d.isCodedValueOrSubtype?b=d.displayValue:this.isNumberField(a)&&(a=this.getFieldInfoFromPopupInfo(this.popupInfo,
a),b=f.localizeNumberByFieldInfo(b,a));return b},formatedDateByPopupInfoOrLocal:function(a,c,g){g||(g=this.popupInfo);a:{if(g&&b.isDefined(g.fieldInfos))for(var d=0,m=g.fieldInfos.length;d<m;d++){var k=g.fieldInfos[d];if(k.fieldName===a){a=k.format;break a}}a=null}c=Number(c);return f.fieldFormatter.getFormattedDate(c,a)},getDisplayValForNumberCodedValueSubTypes:function(a,b){var d=this.tryLocaleNumber(b,a);if(this.featureLayer&&this.featureLayer.typeIdField===a){var c=this.featureLayer.types;if(c&&
0<c.length&&(c=c.filter(h.hitch(this,function(a){return a.id===b})),0<c.length))return d=c[0].name}(a=this.getFieldInfo(a))&&a.domain&&(a=a.domain.codedValues)&&0<a.length&&a.some(function(a){return a.code===b?(d=a.name,!0):!1});return d},tryLocaleNumber:function(a,c){var d=a;if(b.isDefined(a)&&isFinite(a))try{var g;if(c&&this.isNumberField(c)){var m=this.popupInfo[c];g=m&&h.exists("format.places",m)?f.localizeNumberByFieldInfo(a,m):f.localizeNumber(a)}else g=a;"string"===typeof g&&(d=g)}catch(q){console.error(q)}return d+
""},getCategoryDisplayForDateUnit:function(a,b){if(!b)return a;a=Number(a);return this._getFormatteredDate(a,b)},_getFormatteredDate:function(a,b){var d=this._getDateTemplate(b);0<=["year","month","day"].indexOf(b)?d=f.localizeDate(new Date(a),{selector:"date",datePattern:d.date}):(b=f.localizeDate(new Date(a),{selector:"date",datePattern:d.date}),a=c(a).format(d.time),d=b+d.connector+a);return d},_getDateTemplate:function(b){var d=a[l.locale];(d=d||{},d.date)||(d.date={"short":"short"});d&&!d.time&&
(d.time={medium:"HH:mm:ss a"});d&&!d.connector&&(d.connector=" ");d&&!d.sNoDay&&(d.sNoDay="MMM, y");var c={};"year"===b?c.date="y":"month"===b?c.date=d.date.sNoDay:"day"===b?c.date=d.date["short"]:"hour"===b?(c.date=d.date["short"],c.time="HH a",c.connector=d.connector):"minute"===b?(c.date=d.date["short"],c.time="HH:mm a",c.connector=d.connector):"second"===b&&(c.date=d.date["short"],c.time=d.time.medium,c.connector=d.connector);return c},_getSymbolLayerGraphics:function(a,b){if(!this.symbolLayer)return null;
if(!this.symbolLayer.refreshInterval&&this.symbolGraphics&&!1===this.symbolGraphics.filterByExtent&&!1===this.symbolGraphics.useSelection)return this.symbolGraphics.graphics;var d=null;this.map&&this.symbolLayer&&(d=f.getClientFeaturesFromMap(this.map,this.symbolLayer,b,!!a));this.symbolGraphics={filterByExtent:a,useSelection:b,graphics:d};return d},_isContainAttr:function(a,b){if("object"!==typeof b||"object"!==typeof b)return!1;var d=!0,c;for(c in b)b.hasOwnProperty(c)&&(d=b[c]===a[c]);return d},
_getFeaturesByAttr:function(a,b){if(b){var d=null;b.some(function(b){return this._isContainAttr(b.attributes,a)?(d=b,!0):!1}.bind(this));return d}},_getFeaturesByClusterfield:function(a,b,c,g){var d=this._getSymbolLayerGraphics(c);if(d)return c=null,a=this.clientStatisticsUtils.getCluseringObj(a,d,g),(b=h.mixin(a.notNullLabel,a.nullLabel)[b])&&b.features&&b.features.length&&(c=b.features),c},_getFeatureForSerieData:function(a,b,c){var d=b.clusterField,m=b.mode,k=b.filterByExtent;b=b.useSelection;
var e={};e[d]=a.name;if("feature"===m)return this._getFeatureBySerieDataItem(a,d,c,k,b);if("category"===m||"count"===m)return new g(null,null,e)},_getFeatureBySerieDataItem:function(a,b,c,g,k){var d={};d[b]=a.name;d[c]=Number("undefined"!==typeof a.originValue?a.originValue:a.value);a=this._getSymbolLayerGraphics(g,k);return this._getFeaturesByAttr(d,a)},_getFeatureBycsuDataItem:function(a,b,c,g,k,e){var d={};d[b]=a.label;a=a.originalValues||a.values;d[c]=Number(a&&a[g]);c=this._getSymbolLayerGraphics(k,
e);return this._getFeaturesByAttr(d,c)},bindChartEvent:function(a,b,c){var d=b.filterByExtent,g=b.useSelection,m=b.clusterField,k=b.valueFields,e=null;"undefined"!==b.dateConfig&&(e=b.dateConfig);this.highLightColor=b.highLightColor||"#00ffff";var p=b.mode;if(this.map&&0!==c.length){b=h.hitch(this,function(a){if("series"===a.componentType){var b=null,f=this._getSymbolLayerGraphics(d,g);if("field"===p)b=f;else if(f=c[a.dataIndex])if("feature"===p){var q=a.seriesIndex,l=k[q];if(!l)return;(f=this._getFeatureBycsuDataItem(f,
m,l,q,d,g))&&(b=[f])}else f=f.label,"undefined"!==typeof f&&(b=this._getFeaturesByClusterfield(m,f,d,e));b&&"mouseover"===a.type&&(this._mouseoverFeatures=b,this._mouseOverChartItem(b))}});var f=h.hitch(this,function(){this._mouseoverFeatures&&(this._mouseOutChartItem(this._mouseoverFeatures),this._mouseoverFeatures=null)});[{name:"mouseover",callback:b},{name:"mouseout",callback:f}].forEach(h.hitch(this,function(b){a.chart.off(b.name);a.chart.on(b.name,h.hitch(this,function(a){"mouseover"===a.type?
(this._hasTriggerMouseoverEvent||(this._hasTriggerMouseoverEvent=!0,b.callback(a)),setTimeout(h.hitch(this,function(){this._hasTriggerMouseoverEvent=!1},500))):"mouseout"===a.type&&b.callback(a)}))}))}},_mouseOverChartItem:function(a){if(this.featureLayer&&this.featureLayer.getMap()&&this.featureLayer.visible){var b=f.getTypeByGeometryType(this.featureLayer.geometryType);a.forEach(h.hitch(this,function(a){a._originalSymbol=a.symbol}));var d=null;if("point"===b)d=this._getHighLightMarkerSymbol(),this.tempGraphics=
[],a.forEach(h.hitch(this,function(a){a=new g(a.geometry,d);this.tempGraphics.push(a);this.featureLayer.add(a)}));else if("polyline"===b)d=this._getHighLightLineSymbol(this.highLightColor),a.forEach(h.hitch(this,function(a){a.setSymbol(d)}));else if("polygon"===b){var c=this.featureLayer.getSelectedFeatures()||[];a.forEach(h.hitch(this,function(a){var b=0<=c.indexOf(a),b=this._getHighLightFillSymbol(this.featureLayer,a,b);a.setSymbol(b)}));this._getSymbolLayerGraphics(!1,!1).length!==a.length&&"polygon"===
b&&(a.forEach(h.hitch(this,function(a){this.featureLayer.remove(a)})),a.forEach(h.hitch(this,function(a){this.featureLayer.add(a)})))}}},_mouseOutChartItem:function(a){this._removeTempGraphics();a.forEach(h.hitch(this,function(a){a.setSymbol(a._originalSymbol||null)}))},_removeTempGraphics:function(){if(this.featureLayer&&this.tempGraphics&&0<this.tempGraphics.length)for(;0<this.tempGraphics.length;)this.featureLayer.remove(this.tempGraphics[0]),this.tempGraphics.splice(0,1);this.tempGraphics=null},
_getHighLightMarkerSymbol:function(){var a=k.fromJson({color:[255,255,255,0],size:18,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSSquare",outline:{color:[0,0,128,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}});a.setSize(30);a.outline.setColor(new e(this.highLightColor));return a},_getHighLightLineSymbol:function(a){var b=k.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"});b.setColor(new e(a||this.highLightColor));return b},_getDefaultHighLightFillSymbol:function(){var a=
k.fromJson({color:[0,255,255,128],outline:{color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"});a.outline.setColor(new e(this.highLightColor));return a},_getSymbolByRenderer:function(a,b){var d=this._getDefaultHighLightFillSymbol(),c=this.getVisualVariableByType("colorInfo",a.visualVariables);if(c){if(a=a.getColor(b,{colorInfo:c}))a=h.clone(a),d.setColor(a)}else d=a.getSymbol(b);return d},getVisualVariableByType:function(a,b){return b&&(b=b.filter(function(b){return b.type===
a&&!b.target}),b.length)?b[0]:null},_getHighLightFillSymbol:function(a,b,c){var d=null,g=b.symbol,d=a.renderer;!g&&d&&(g=this._getSymbolByRenderer(d,b));g&&"function"===typeof g.setOutline?(d=k.fromJson(g.toJson()),b=1.5,g.outline&&0<g.outline.width&&(b=g.outline.width+1),c=this._getHighLightLineSymbol(c?"#ff0000":"#00ffff"),c.setWidth(b),d.setOutline(c)):d=this._getDefaultHighLightFillSymbol();return d},_isNumberField:function(a){var b=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle",
"esriFieldTypeDouble"];return this.featureLayer.fields.some(h.hitch(this,function(d){return d.name===a&&0<=b.indexOf(d.type)}))},getFieldAlias:function(a){var b;this.popupInfo&&(b=this.getAliasFromPopupInfo(this.popupInfo,a));b||(b=a,(a=this.getFieldInfo(a))&&a.alias&&(b=a.alias));return b},_removeDuplicateElementForObjArray:function(a){if(!Array.isArray(a))return a;var b=[];b.push(a[0]);a.forEach(function(a){b.some(function(b){return f.isEqual(b,a)})||b.push(a)});return b},assigneeSettingColor:function(a,
b,c){if(!b||!b.length)return b;var d=a.seriesStyle;if(!d)return b;"layerSymbol"===d.type?b=this._assigneeStyleLayerSymbolColor(b,c):"series"===d.type?b=this._assigneeStyleSeriesColor(a,b):"custom"===d.type&&(b=this._assigneeStyleCustomColor(a,b));return b},_assigneeStyleCustomColor:function(a,b){a=a.seriesStyle;if(!a||!a.customColor)return b;var d=a.customColor;a=d.categories;d=d.others;if(!(a&&a.length||d&&d.length))return b;d&&d.length&&this._setCustomOthersColor(d,b);a&&a.length&&this._setCustomCategoriesColor(a,
b)},_setCustomCategoriesColor:function(a,b){b.forEach(function(b){(b=b.data)&&b.length&&b.forEach(function(b){if("undefined"!==typeof b.name){var d=this._getMatchingCustomColor(b.name,a);this.setColorToDataItem(b,d)}}.bind(this))}.bind(this))},_getMatchingCustomColor:function(a,b){var d=!1;if(!b||!b.length)return d;(b=b.filter(function(b){return b.id===a})[0])&&b.color&&(d=b.color);return d},_getMatchingCustomLabel:function(a,b){var d=!1;if(!b||!b.length)return d;(b=b.filter(function(b){return b.id===
a})[0])&&b.label&&(d=b.label);return d},_setCustomOthersColor:function(a,b){this._setOtherColorForCustomColor(a,b);this._setNullLabelColorForCustomColor(a,b)},_setOtherColorForCustomColor:function(a,b){(a=a.filter(function(a){return"others"===a.id})[0])&&a.color&&this.setColorToAllSerieDataItem(b,a.color)},_setNullLabelColorForCustomColor:function(a,b){if((a=a.filter(function(a){return"null"===a.id})[0])&&a.color){var d=a.color;b.forEach(function(a){(a=a.data)&&a.length&&a.forEach(function(a){a.name&&
"_NULL\x26UNDEFINED_"===a.name&&this.setColorToDataItem(a,d)}.bind(this))}.bind(this))}},_assigneeStyleSeriesColor:function(a,b){var d=a.seriesStyle;if(!d||!d.styles||!d.styles[0])return b;var c=a.mode,g=a.area;return b.map(function(a){var b=null,k=a.type;if("field"===c)"line"===k?(b=d.styles[0].style,a=this._setStyleToSerie(b,a,g)):(k=a.data)&&k[0]&&(a.data=k.map(function(a){b=this._getMatchingStyle(a.name,d);return this.setStyleToSerieDataItem(b,a)}.bind(this)));else if("column"===k||"bar"===k||
"line"===k)"count"===c?(b=d.styles[0].style,a=this._setStyleToSerie(b,a,g)):"undefined"!==typeof a.name&&(b=this._getMatchingStyle(a.name,d))&&(a=this._setStyleToSerie(b,a,g));return a}.bind(this))},_assigneeStyleLayerSymbolColor:function(a,b){a.forEach(function(a){var d=a.name;(a=a.data)&&a.length&&a.forEach(function(a){var c=[this._getFeatureForSerieData(a,b,d)];if(c=this._getSymbolColorForDataItem(c))a.itemStyle={color:c}}.bind(this))}.bind(this))},_setStyleToSerie:function(a,b,c){b.itemStyle||
(b.itemStyle={});a&&"undefined"!==typeof a.color&&(Array.isArray(a.color)?b.itemStyle.color=a.color[0]:b.itemStyle.color=a.color);a&&"undefined"!==typeof a.opacity&&(c?(b.areaStyle||(b.areaStyle={}),b.areaStyle.opacity=1-parseFloat(a.opacity/10)):b.itemStyle.opacity=1-parseFloat(a.opacity/10));return b},_getMatchingStyle:function(a,b){var d=null;b=b.styles;if(!b||!b[0]||""===a)return d;b.forEach(function(b){b.name===a&&(d=b.style)});return d},_getSymbolColorForDataItem:function(a){var b=!1;if(!this.symbolLayer)return b;
a=a&&a[0];return a?b=this._getColorForFeature(this.symbolLayer.renderer,a):b},_getColorForFeature:function(a,b){var c=!1,d=this.getVisualVariableByType("colorInfo",a.visualVariables);d?(a=a.getColor(b,{colorInfo:d}))&&(c=this._convertToEchartsRbga(a)):(a=a.getSymbol(b))&&"undefined"!==typeof a.color&&(c=this._convertToEchartsRbga(a.color));return c},_convertToEchartsRbga:function(a){if(!a||"undefined"===typeof a.r)return a;a=window.JSON.parse(window.JSON.stringify(a));var b;b="rgba("+(a.r+",");b+=
a.g+",";b+=a.b+",";return b+=a.a+")"},getColors:function(a,b){var c=[];if(2===a.length)c=this._createGradientColors(a[0],a[a.length-1],b);else{for(var d=Math.ceil(b/a.length),g=0;g<d;g++)c=c.concat(a);c=c.slice(0,b)}return c},_createGradientColors:function(a,b,c){var d=[];a=new e(a);var g=new e(b);b=(g.r-a.r)/c;for(var k=(g.g-a.g)/c,g=(g.b-a.b)/c,m=new e,f=0,p=0,l=0,h=0;h<c;h++)f=parseInt(a.r+b*h,10),p=parseInt(a.g+k*h,10),l=parseInt(a.b+g*h,10),m.setColor([f,p,l]),d.push(m.toHex());return d},setStyleToSerieDataItem:function(a,
b){b.itemStyle||(b.itemStyle={});a&&"undefined"!==typeof a.color&&(Array.isArray(a.color)?b.itemStyle.color=a.color[0]:b.itemStyle.color=a.color);a&&"undefined"!==typeof a.opacity&&(b.itemStyle.opacity=1-parseFloat(a.opacity/10));return b},setColorToSerie:function(a,b){if(!a||"object"!==typeof a||Array.isArray(a))return a;a.itemStyle||(a.itemStyle={});b&&(a.itemStyle.color=b)},setColorToDataItem:function(a,b){if(!a||"object"!==typeof a)return a;a.itemStyle||(a.itemStyle={});b&&(a.itemStyle.color=
b)},setColorToAllSerieDataItem:function(a,b){a.forEach(function(a){(a=a.data)&&a.length&&a.forEach(function(a){this.setColorToDataItem(a,b)}.bind(this))}.bind(this))},_updateDataItemNameForCustom:function(a,b,c){var d;"undefined"!==typeof a.name&&(d=a.name,"_NULL\x26UNDEFINED_"===a.name&&b?d=b:(b=this._getMatchingCustomLabel("undefined"!==typeof a.originName?a.originName:a.name,c))&&(d=b),a.name=d);return d},_updateSerieDataItemName:function(a,b,c){var d=a.name,g=d,g=a.unit&&d?this.getCategoryDisplayForDateUnit(d,
a.unit):"field"!==b?this.getBestDisplayValue(c,d):this.getFieldAlias(d);a.name=g;a.originName=d;return g},updateChartSeriesDisplayName:function(a,b,c){var d="feature"===c.mode?c.labelField:c.categoryField,g=c.mode;c=a.series;var k=[];b=b.seriesStyle;var e,m,f;c.forEach(function(a,b){a.name&&(a.name=this.getFieldAlias(a.name));(a=a.data)&&a.length&&a.forEach(function(a,c){f=this._updateSerieDataItemName(a,g,d);0===b&&(k[c]=f)}.bind(this))}.bind(this));"custom"===b.type&&((b=b.customColor)&&b.categories&&
b.categories.length&&(e=b.categories,b=b.others||[],(b=b.filter(function(a){return"null"===a.id})[0])&&b.label&&(m=b.label)),c.forEach(function(a,b){(a=a.data)&&a.length&&a.forEach(function(a,c){f=this._updateDataItemNameForCustom(a,m,e);0===b&&(k[c]=f)}.bind(this))}.bind(this)));a.labels=null;a.labels=k}})})},"jimu/_dateFormat":function(){define([],function(){return{ar:{date:{"short":"d/M/y",medium:"dd/MM/y","long":"d MMMM. y",onlyDate:"dd/MM",mNoDay:"MM/y",sNoDay:"M/y"},time:{"short":"h:mm a",medium:"h:mm:ss a"}},
bs:{date:{"short":"d.M.yy.",medium:"d. MMM. y.","long":"d. MMMM y.",onlyDate:"d. MMM.",mNoDay:"MMM. y.",sNoDay:"M.yy"}},cs:{date:{"short":"dd.MM.yy",medium:"d. M. y",onlyDate:"d. M.",mNoDay:"M. y",sNoDay:"MM.yy"}},da:{date:{"short":"dd/MM/y",medium:"d. MMM y","long":"d. MMMM y",onlyDate:"d. MMM",mNoDay:"MMM y",sNoDay:"MM/y"}},de:{date:{"short":"dd.MM.yy",medium:"dd.MM.y",onlyDate:"dd.MM."},connector:" , ",mNoDay:"MM.y",sNoDay:"MM.yy"},el:{date:{"short":"d/M/yy",medium:"d MMM y",onlyDate:"d MMM"},
connector:" , ",mNoDay:"MMM y",sNoDay:"M/yy"},en:{date:{"short":"M/d/yy",medium:"MMM d, y",onlyDate:"MMM d",mNoDay:"MMM, y",sNoDay:"M/yy"}},es:{date:{"short":"d/M/yy",medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"M/yy"}},et:{date:{"short":"d.MM.y",medium:"d. MMM y",onlyDate:"d. MMM",mNoDay:"MMM y",sNoDay:"MM.y"},time:{"short":"H:mm",medium:"H:mm:ss"}},fi:{date:{"short":"d.M.y",medium:"d.M.y",onlyDate:"d.M.",mNoDay:"M.y",sNoDay:"M.y"},connector:" 'klo' "},fr:{date:{"short":"dd/MM/y",medium:"d MMM y",
onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM/y"},connector:" '\u00e0' "},he:{date:{"short":"dd/MM/yy",medium:"d '\u05d1'MMM y",onlyDate:"d '\u05d1'MMM",mNoDay:"'\u05d1'MMM y",sNoDay:"MM/yy"},connector:" , "},hi:{date:{"short":"d/M/yy",medium:"dd/MM/y","long":"d MMMM y",onlyDate:"dd/MM",mNoDay:"MM/y",sNoDay:"M/yy"},time:{"short":"h:mm a",medium:"h:mm:ss a",sNoDay:""},connector:" , "},hr:{date:{"short":"d.M.y",medium:"d. MMM y.",onlyDate:"d. MMM",mNoDay:"MMM y.",sNoDay:"M.y"}},id:{"short":"dd/MM/yy",
date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM/yy"}},it:{date:{medium:"dd MMM y","long":"d MMMM y",onlyDate:"dd MMM",mNoDay:"MMM y",sNoDay:"MM/yy"},connector:" , "},ja:{date:{medium:"y/MM/dd",onlyDate:"MM/dd",mNoDay:"y/MM",sNoDay:"y/MM"},time:{"short":"a h:mm",medium:"a h:mm:ss"}},ko:{date:{medium:"y. M. d.",onlyDate:"M. d.",mNoDay:"y. M.",sNoDay:"yy. M."}},lt:{date:{medium:"y-MM-dd","long":"y 'm'. MMMM d 'd'.",onlyDate:"MM-dd",mNoDay:"y-MM",sNoDay:"y-MM"},time:{medium:"HH:mm:ss"}},
lv:{date:{"short":"dd.MM.y",medium:"y. 'gada' d. MMM.","long":"y. 'gada' d. MMMM",onlyDate:"d. MMM.",mNoDay:"y. 'gada' MMM.",sNoDay:"MM.y"}},nb:{date:{"short":"dd.MM.y",medium:"d. MMM y","long":"d. MMMM y",onlyDate:"d. MMM",mNoDay:"MMM y",sNoDay:"MM.y"},time:{"short":"HH:mm",medium:"HH:mm:ss"},connector:" , "},nl:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM-yy"}},pl:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM.y"},connector:" , "},"pt-br":{date:{"short":"dd/MM/y",
medium:"d 'de' MMM 'de' y",onlyDate:"d 'de' MMM",mNoDay:"MMM 'de' y",sNoDay:"MM/y"}},"pt-pt":{date:{medium:"dd/MM/y",onlyDate:"dd/MM",mNoDay:"MM/y",sNoDay:"MM/yy"}},ro:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM.y"},connector:" , "},ru:{date:{"short":"dd.MM.y",medium:"d MMM y '\u0433.'",onlyDate:"d MMM",mNoDay:"MMM y '\u0433.'",sNoDay:"MM.y"},connector:" , "},sr:{date:{medium:"dd.MM.y.",onlyDate:"dd.MM.",mNoDay:"MM.y.",sNoDay:"M.yy."},time:{"short":"HH:mm",medium:"HH:mm:ss"}},
sv:{date:{medium:"d MMM. y",onlyDate:"d MMM.",mNoDay:"MMM. y",sNoDay:"y-MM"}},th:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"M/yy"}},tr:{date:{medium:"d MMM y",onlyDate:"d MMM",mNoDay:"MMM y",sNoDay:"MM.y"}},vi:{date:{"short":"dd/MM/y",medium:"d MMM, y","long":"'Ng\u00e0y' dd 'th\u00e1ng' MM 'n\u0103m' y",onlyDate:"d MMM",mNoDay:"MMM, y",sNoDay:"MM/y"},time:{"short":"hh:mm a",medium:"hh:mm:ss a"},connector:" , "},"zh-cn":{date:{"short":"y/M/d",medium:"y'\u5e74'M'\u6708'd'\u65e5'",
onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"y/M"}},"zh-hk":{date:{medium:"y'\u5e74'M'\u6708'd'\u65e5'",onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"M/y"}},"zh-tw":{date:{medium:"y'\u5e74'M'\u6708'd'\u65e5'",onlyDate:"M'\u6708'd'\u65e5'",mNoDay:"y'\u5e74'M'\u6708'",sNoDay:"y/M"}}}})},"jimu/dijit/Chart":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/Evented libs/echarts/echarts jimu/utils ./_chartUtils ./_Gauge ./_ChartOptionFactory libs/echarts/light libs/echarts/dark".split(" "),
function(n,f,h,l,e,a,c,b,g,k){return n([f,e],{baseClass:"jimu-dijit-chart",templateString:"\x3cdiv\x3e\x3c/div\x3e",declaredClass:"jimu.dijit.chart",config:null,postCreate:function(){this.inherited(arguments);this._initChart()},updateConfig:function(a){if(!a)return!1;this.config=a;this._specialThemeByConfig(a);var b=this._chartFactory(a);this.chart.setOption(b,!0);this._settingByGrid(a,b);return!0},_settingByGrid:function(a,b){if("gauge"===a.type)return this._resetGaugePosition(a);var c=this.chartUtils.getAxisZeroPosition();
a.layout=this.chartUtils.calcDefaultLayout(a);this.chartUtils.isAxisChart(a)&&(b=this.chartUtils.settingGrid(b,a),b=this.chartUtils.settingDataZoom(b,a,c));b=this.chartUtils.settingChartLayout(b,a);this.chart.setOption(b,!1)},_resetGaugePosition:function(a){this._resetGaugeGrid(a);this._resetGaugeGraphic(a)},setConfig:function(a){if(!a)return!1;this.config=a;this._specialThemeByConfig(this.config);this.clear();var b=this._chartFactory(this.config);this.chart.setOption(b,!0);this._setAixsGrid(a,b);
this._resetGaugePosition(a,b);return!0},destroy:function(){this._offEvents();this.clear();this.inherited(arguments)},_chartFactory:function(a){return this.option=this.chartOptionFactory.produceOption(a)},bindEvents:function(a){this.chart&&a.events&&a.events.length&&(this._offEvents(),a.events.forEach(h.hitch(this,function(a){this.chart.on(a.name,a.callback)})))},_offEvents:function(){this.config.events&&this.config.events[0]&&this.config.events.forEach(h.hitch(this,function(a){this.chart.off(a.name)}))},
getDataURL:function(){if(this.chart)return this.chart.getDataURL()},clear:function(){this.chart&&this.chart.clear()},resize:function(a,b){this.chart&&(l.setStyle(this.domNode,{width:a||"100%",height:b||"100%"}),this.chart.resize(),this._resizeDataZoom(),this._resetGaugePosition(this.config))},_resizeDataZoom:function(){var a=this.option,b=this.config;if(a&&b){var c=this.chartUtils.getAxisZeroPosition(),a=this.chartUtils.settingDataZoom(a,b,c);this.chart.setOption(a)}},_setAixsGrid:function(a,b){this.chartUtils.isAxisChart(a)&&
(b=this.chartUtils.settingGrid(b,a),this.chart.setOption(b,!1))},_resetGaugeGraphic:function(a){"gauge"===a.type&&this.gauge.resetGraphic(a)},_resetGaugeGrid:function(a){"gauge"===a.type&&this.gauge.resetGrid(a)},_specialChartTheme:function(){this.chart&&(this.chart._theme.tooltip.axisPointer={type:"cross",label:{show:!0,precision:2,formatter:function(a){return"number"===typeof a.value?(a=parseFloat(a.value).toFixed(2),this.chartUtils.tryLocaleNumber(a)):a.value}.bind(this)},lineStyle:{color:"#27727B",
type:"dashed"},crossStyle:{color:"#27727B"},shadowStyle:{color:"rgba(200,200,200,0.3)"}},this.chart._theme.valueAxis||(this.chart._theme.valueAxis={}),this.chart._theme.valueAxis.axisLabel||(this.chart._theme.valueAxis.axisLabel={}),this.chart._theme.valueAxis.axisLabel.formatter=function(a){return c.localizeNumber(a)})},_specialThemeByConfig:function(a){this._initChartTheme();a.color&&a.color[0]&&(this.chart._theme.color=a.color);this.chart._theme.tooltip.confine=!0;var b="percent"===a.stack;this.chart._theme.tooltip.formatter=
function(a){return this.chartUtils.handleToolTip(a,null,!1,b)}.bind(this)},_initChartTheme:function(){this.chart&&(this.chart._theme||(this.chart._theme={}),this.chart._theme.tooltip||(this.chart._theme.tooltip={}),this.chart._theme.valueAxis||(this.chart._theme.valueAxis={}),this.chart._theme.valueAxis.axisLabel||(this.chart._theme.valueAxis.axisLabel={}))},_initChart:function(){this.chart=a.init(this.domNode,this.config&&this.config.theme||"light");this.chartUtils=new b({chart:this.chart});this.gauge=
new g({chart:this.chart,chartUtils:this.chartUtils});this.chartOptionFactory=new k({chart:this.chart,gauge:this.gauge,chartUtils:this.chartUtils});this._specialChartTheme(this.config)}})})},"jimu/dijit/_chartUtils":function(){define(["dojo/_base/declare","jimu/utils","esri/lang","dojo/_base/lang"],function(n,f,h,l){var e={curved:{name:"",type:"gauge",center:["50%","60%"],startAngle:200,endAngle:-20,axisLine:{lineStyle:{color:[[.31,"#5CB4CA"],[1,"#E5E5E5"]],shadowColor:"rgba(0, 0, 0, 0.5)",shadowBlur:0}},
axisTick:{show:!1},splitLine:{show:!1},axisLabel:{distance:-52,textStyle:{color:"#000"}},pointer:{length:"65%",width:5},itemStyle:{opacity:.7},detail:{show:!0,offsetCenter:[0,"68%"],textStyle:{color:"#24B5CC"}},title:{show:!1},data:[{value:0}],animationEasingUpdate:"bounceOut",animationDurationUpdate:500},vertical:{yAxis:{show:!0,offset:-10,type:"value",interval:1,scale:!1,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1,showMinLabel:!0,showMaxLabel:!0,textStyle:{color:"#949494",fontStyle:"normal",
fontWeight:"normal"}},splitLine:{show:!1}},xAxis:{show:!1,type:"category",data:[]},series:[{name:"",type:"bar",barWidth:30,silent:!0,animation:!1,itemStyle:{color:"#E5E5E5"},barGap:"-100%",data:[100],z:1},{name:"",type:"bar",barWidth:30,label:{show:!0,position:"insideTopLeft",offset:[30,-15],textStyle:{}},data:[{value:40,label:{textStyle:{color:"#24B5CC",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}},itemStyle:{}}],itemStyle:{color:"#24B5CC"},z:10}]},horizontal:{xAxis:{show:!0,
offset:-27,type:"value",scale:!1,interval:1,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1,showMinLabel:!0,showMaxLabel:!0,textStyle:{color:"#949494",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}},splitLine:{show:!1}},yAxis:{show:!1,type:"category",data:[]},series:[{name:"",type:"bar",barWidth:30,silent:!0,animation:!1,itemStyle:{color:"#E5E5E5"},barGap:"-100%",data:[100],z:1},{name:"",type:"bar",barWidth:30,label:{show:!0,position:"top",offset:[20,0],textStyle:{}},
data:[{value:40,label:{textStyle:{color:"#24B5CC",fontStyle:"normal",fontWeight:"normal",fontFamily:"Avenir Next",fontSize:12}},itemStyle:{}}],itemStyle:{color:"#24B5CC"},z:10}]}};return n([],{constructor:function(a){this.chart=a&&a.chart;this.horIconUrl="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjdweCIgaGVpZ2h0PSI1cHgiIHZpZXdCb3g9IjAgMCA3IDUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkNhcmRXaWRnZXRfTGF5b3V0NCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTg3NS4wMDAwMDAsIC0yOTcuMDAwMDAwKSIgZmlsbD0iIzkzOTM5MyI+DQogICAgICAgICAgICA8ZyBpZD0iQ2FyZDJfSG9yaXpvbnRhbEdhdWdlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3OTIuMDAwMDAwLCAxODEuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Ikhvcml6b250YWxHYXVnZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDY2LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjguNTAwMDAwLCA0Mi41MDAwMDApIHJvdGF0ZSgtMjcwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMjguNTAwMDAwLCAtNDIuNTAwMDAwKSB0cmFuc2xhdGUoODYuMDAwMDAwLCAtODYuMDAwMDAwKSIgaWQ9Ik51bWJlcnMrVHJpYW5nbGVzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwLjAwMDAwMCwgMC4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iVHJpYW5nbGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIuNTAwMDAwLCAxNzAuNTQzODAzKSByb3RhdGUoLTE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtMi41MDAwMDAsIC0xNzAuNTQzODAzKSAiIHBvaW50cz0iNSAxNzAuNTQzODAzIC0xLjcwNTMwMjU3ZS0xMyAxNzQuMDQzODAzIC0xLjY5NjQyMDc4ZS0xMyAxNjcuMDQzODAzIj48L3BvbHlnb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4\x3d";
this.verIconUrl="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjVweCIgaGVpZ2h0PSI4cHgiIHZpZXdCb3g9IjAgMCA1IDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkNhcmRXaWRnZXRfTGF5b3V0NCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTg3Ni4wMDAwMDAsIC0zMjQuMDAwMDAwKSIgZmlsbD0iIzkzOTM5MyI+DQogICAgICAgICAgICA8ZyBpZD0iQ2FyZDJfSG9yaXpvbnRhbEdhdWdlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3OTIuMDAwMDAwLCAxODEuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Ikhvcml6b250YWxHYXVnZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDY2LjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjguNTAwMDAwLCA0Mi41MDAwMDApIHJvdGF0ZSgtMjcwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMjguNTAwMDAwLCAtNDIuNTAwMDAwKSB0cmFuc2xhdGUoODYuMDAwMDAwLCAtODYuMDAwMDAwKSIgaWQ9Ik51bWJlcnMrVHJpYW5nbGVzIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUwLjAwMDAwMCwgMC4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iVHJpYW5nbGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMwLjYyODk1MiwgMTcwLjQ1ODY1NCkgcm90YXRlKC05MC4wMDAwMDApIHRyYW5zbGF0ZSgtMzAuNjI4OTUyLCAtMTcwLjQ1ODY1NCkgIiBwb2ludHM9IjMzLjEyODk1MjMgMTcwLjQ1ODY1NCAyOC4xMjg5NTIzIDE3My45NTg2NTQgMjguMTI4OTUyMyAxNjYuOTU4NjU0Ij48L3BvbHlnb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4\x3d";
this.verIconUrlRTL="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjVweCIgaGVpZ2h0PSI3cHgiIHZpZXdCb3g9IjAgMCA1IDciIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0NC4xICg0MTQ1NSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPlRyaWFuZ2xlPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IkxheW91dC0yTmV3IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4NCiAgICAgICAgPGcgaWQ9IkFydGJvYXJkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTIxLjAwMDAwMCwgLTQ0Ny4wMDAwMDApIiBmaWxsPSIjOTM5MzkzIj4NCiAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJUcmlhbmdsZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTIzLjUwMDAwMCwgNDUwLjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTEyMy41MDAwMDAsIC00NTAuNTAwMDAwKSAiIHBvaW50cz0iMTI2IDQ1MC41IDEyMSA0NTQgMTIxIDQ0NyI+PC9wb2x5Z29uPg0KICAgICAgICA8L2c+DQogICAgPC9nPg0KPC9zdmc+";
a=l.clone(e);this.curved=a.curved;this.vertical=a.vertical;this.horizontal=a.horizontal;this.unitDistance=23;this.defultGrid={top:10,bottom:10,left:10,right:10,containLabel:!0}},getAxisZeroPosition:function(){if(!this.chart)return!1;var a;try{a=this.chart.convertToPixel({xAxisIndex:0,yAxisIndex:0},[0,0])}catch(k){}if(!a)return{};var c=a[0];a=a[1];var b=this.chart.getHeight(),g=this.chart.getWidth();return{left:c,right:g-c,top:a,bottom:b-a}},getTextWidth:function(a,c){if(!a&&0!==a)return 0;var b=(this.getTextWidth.canvas||
(this.getTextWidth.canvas=document.createElement("canvas"))).getContext("2d");b.font=c;return b.measureText(a).width},getHeightByFontSize:function(a){a=Math.round(a);if("number"!==typeof a||6>a||40<a)return 0;var c=0;a-=6;switch(!0){case 7>=a:c=1*a;break;case 8<=a&&11>=a:c=1*(a-1)+2;break;case 12<=a&&15>=a:c=1*(a-2)+4;break;case 16<=a&&19>=a:c=1*(a-3)+6;break;case 20<=a&&21>=a:c=1*(a-4)+8;break;case 22<=a&&23>=a:c=1*(a-5)+8;break;case 24<=a&&27>=a:c=1*(a-6)+10;break;case 28<=a&&31>=a:c=1*(a-7)+12;
break;case 32<=a&&34>=a:c=1*(a-8)+14}return 8+c},tryLocaleNumber:function(a){var c=a;if(h.isDefined(a)&&isFinite(a))try{var b=f.localizeNumber(a);"string"===typeof b&&(c=b)}catch(g){console.error(g)}return c+""},isAxisChart:function(a){return"column"===a.type||"bar"===a.type||"line"===a.type},isBaseChartType:function(a){return this.isAxisChart(a)||"pie"===a.type},_getTooltipDisplayValue:function(a,c){"number"===typeof Number(a)&&(a=c?f.convertNumberToPercentage(a):this.tryLocaleNumber(a));return a},
generateToolTip:function(a,c,b,g,k){var d="",d=b?'\x3cdiv class\x3d"tooltip-tr reverse"\x3e':'\x3cdiv class\x3d"tooltip-tr"\x3e';b="";a.color&&"auto"!==a.color&&(b='\x3cdiv class\x3d"colorEl marginRight5" style\x3d"background-color:'+f.encodeHTML(a.color)+'"\x3e\x3c/div\x3e');d+=b;b="";"radar"!==a.seriesType&&this._isVaildValue(a.seriesName)?b=a.seriesName:this._isVaildValue(k)&&(b=k);d=""===b?d+("\x3cdiv\x3e"+b+"\x3c/div\x3e"):d+("\x3cdiv\x3e"+b+"\x3c/div\x3e\x3cdiv\x3e : \x3c/div\x3e");k="null";
this._isNotZeroBoolean(c)?k=c:this._isVaildValue(a.value)&&(k=a.value);d+="\x3cdiv\x3e"+this._getTooltipDisplayValue(k,g)+"\x3c/div\x3e";"pie"===a.seriesType&&(a=a.percent,a=this._isVaildValue(a)?a/100:0,d+='\x3cdiv class\x3d"space-left"\x3e('+f.convertNumberToPercentage(a)+")\x3c/div\x3e");return d+"\x3c/div\x3e"},handleToolTip:function(a,c,b,g,k){var d='\x3cdiv class\x3d"tooltip-div"\x3e';Array.isArray(a)||(a=[a]);this._isVaildValue(a[0].name)&&(d+='\x3cdiv class\x3d"tr"\x3e'+a[0].name+"\x3c/div\x3e");
a.forEach(function(a){d="radar"!==a.seriesType?d+this.generateToolTip(a,c,b,g,k):d+this._handleRadarTooltip(a,b,g,k)}.bind(this));return d+="\x3c/div\x3e"},_handleRadarTooltip:function(a,c,b,g){var k="";(a.value||[]).forEach(function(d,e){k+=this.generateToolTip(a,d,c,b,g[e])}.bind(this));return k},_isVaildValue:function(a){return"%00-"===encodeURI(a)?!1:this._isNotZeroBoolean(a)},_isNotZeroBoolean:function(a){return 0===a?!0:!!a},settingAdvanceOption:function(a,c){c.advanceOption&&("object"===typeof c.advanceOption?
l.mixin(a,c.advanceOption):"function"===typeof c.advanceOption&&c.advanceOption(a));return a},settingColor:function(a,c){c.color&&c.color[0]&&(a.color=c.color);return a},settingToolTip:function(a,c){a.tooltip={};c.confine&&(a.tooltip.confine=!0);if("radar"===c.type)return a.tooltip.trigger="item",a;if(c.axisPointer){if(a.tooltip.trigger="axis","column"===c.type||"bar"===c.type)a.tooltip.axisPointer={type:"shadow",snap:!0}}else a.tooltip.axisPointer={type:""};return a},settingDataZoom:function(a,c,
b){return this.isAxisChart(c)&&c.series&&c.series.length?c.dataZoom&&c.dataZoom.length?a=this._settingDataZoom(c,a,b):(a.dataZoom=[],a):a},_settingDataZoom:function(a,c,b){if(!this.chart)return c;var g=this.chart.getWidth(),k=a.series[0].data.length,d=a.series.length,k=a.stack?k:k*d;if(!k||!g)return c.dataZoom=h,c;var g="bar"!==a.type?window.isRTL?b.left:g-b.left-c.grid.right:b.top,e=20>g/k,f=g/(20*k),f=parseFloat(100*f,10).toFixed(3),f=100<f?100:f,f=0===f?.01:f,h=[],n="bar"===a.type?"yAxisIndex":
"xAxisIndex",h=a.dataZoom.map(l.hitch(this,function(a){a={type:a,start:0,show:e};a[n]=[0];a.end=f;a.showDataShadow=!1;a.realtime=!1;return a}));c.dataZoom=h;return c},mockChartDataWhenNoData:function(a){a&&Array.isArray(a.labels)&&0===a.labels.length&&a.labels.push("");a&&Array.isArray(a.series)&&0<a.series.length&&a.series.forEach(function(a){a&&Array.isArray(a.data)&&0===a.data.length&&a.data.push(0)});return a},settingDefaultGrid:function(a){a.grid=l.clone(this.defultGrid);return a},settingGrid:function(a,
c){if(!this.isAxisChart(c))return a;a.grid.containLabel=c.yAxis&&c.yAxis.show;var b=c.layout;if(!b||!b.length)return a;var g=0,k=0,d=0,e=0,f=1;b.forEach(function(a){a=a.layout&&a.layout.position;if("xAixsName"===name||"yAixsName"===name)f=.7;"t"===a?g+=f:"b"===a?k+=f:"l"===a?d+=f:"r"===a&&(e+=f)}.bind(this));var h=l.clone(this.defultGrid),b=h.top||0,n=h.bottom||0,q=h.left||0,h=h.right||0,b=b+this.unitDistance*g,n=n+this.unitDistance*k,q=q+this.unitDistance*d,h=h+this.unitDistance*e;c.yAxis&&!c.yAxis.show&&
(n+=this.unitDistance);a.grid.top=b;a.grid.bottom=n;a.grid.left=q;a.grid.right=h;a=this._settingxAxisNameGap(a,c);return a=this._settingGridForMarkName(a,c)},_settingGridForMarkName:function(a,c){var b=c.markLine,g=c.markArea,k=[],d=[];b&&b.data&&b.data.length&&b.data.forEach(function(a){this._hasEndPosName(a)&&k.push(a.name+"");this._hasStartPosName(a)&&d.push(a.name+"")}.bind(this));g&&g.data&&g.data.length&&g.data.forEach(function(a){a=a[0];this._hasOutRightAxisName(c.type,a)&&k.push(a.name+"");
this._hasOutLeftAxisName(c.type,a)&&d.push(a.name+"")}.bind(this));if(!k.length&&!d.length)return a;if("bar"===c.type)return a.grid.top+=15,a;b=this._getyAxisLabelWidth(c);g=this._getMaxLengthString(k);g=this.getTextWidth(g,"normal 12px sans-serif");window.isRTL?a.grid.left+=g:a.grid.right+=g;g=this._getMaxLengthString(d);g=this.getTextWidth(g,"normal 12px sans-serif");g-=b;if(0>=g)return a;g+=10;window.isRTL?a.grid.right=g:a.grid.left=g;return a},_getyAxisLabelWidth:function(a){var c=a&&a.yAxis;
return c&&c.show?(a=this._getMaxData(a))||0===a?this.getTextWidth(a,"normal "+(c&&c.textStyle&&c.textStyle.fontSize||12)+"px sans-serif"):0:0},_getMaxData:function(a){if((a=a.series)&&a.length)return a=a.map(function(a){if((a=a.data)&&a.length)return a.map(function(a){var b;"number"===typeof a?b=a:a&&"undefined"!==typeof a.value&&(b=a.value);return b=parseInt(b,10)})}).map(function(a){if(a.length)return Math.max.apply(Math,a)}),a.length&&Math.max.apply(Math,a)},_getMaxLengthString:function(a){return a.sort(function(a,
b){a=this.getTextWidth(a);b=this.getTextWidth(b);return b-a}.bind(this))[0]},_hasOutRightAxisName:function(a,c){var b=c.name||0===c.name;c=c.label;var g=window.isRTL?"eft":"ight";a=c&&c.position&&-1<c.position.indexOf("bar"===a?"op":g);c=c&&c.position&&-1<c.position.indexOf("inside");return b&&a&&!c},_hasOutLeftAxisName:function(a,c){var b=c.name||0===c.name;c=c.label;var g=window.isRTL?"ight":"eft";a=c&&c.position&&-1<c.position.indexOf("bar"===a?"op":g);c=c&&c.position&&-1<c.position.indexOf("inside");
return b&&a&&!c},_hasEndPosName:function(a){var c=a.label,c=!c||!c.position||"end"===c.position;return(a.name||0===a.name)&&c},_hasStartPosName:function(a){var c=a.label,c=!c||!c.position||"start"===c.position;return(a.name||0===a.name)&&c},_settingxAxisNameGap:function(a,c){if(!this.isAxisChart(c)||!a.xAxis)return a;c=this.getHeightByFontSize(c.xAxis&&c.xAxis.textStyle&&c.xAxis.textStyle.fontSize||12);a.xAxis.nameGap=10+c;return a},calcDefaultLayout:function(a){if(this.isBaseChartType(a)){var c=
a.legend,b=a.xAxis,g=null;a=a.type;"pie"!==a&&(g="bar"!==a?{name:"dataZoom",layout:{position:"t",inner:!1}}:{name:"dataZoom",layout:{position:window.isRTL?"l":"r",inner:!1}});a=null;c&&c.show&&(a={name:"legend",layout:{position:"b",inner:!1}});c=null;b&&b.show&&"undefined"!==typeof b.name&&(c={name:"xAxisName",layout:{position:"b",inner:!1}},a&&(c.layout.inner=!0));b=[];a&&b.push(a);g&&b.push(g);c&&b.push(c);return b.length&&b}},settingRenderOption:function(a,c){if("curved"===c.shape)return a.animationThreshold=
99999999,a.hoverLayerThreshold=99999,a.progressiveThreshold=99999,a;a.hoverLayerThreshold=500;a.progressiveThreshold=500;a.progressive=100;a.animationThreshold=500;return a},settingBackgroundColor:function(a,c){c.backgroundColor&&(a.backgroundColor=c.backgroundColor);return a},settingAxisChartAxis:function(a,c){var b=c.xAxis,g=c.yAxis,k={nameLocation:"center"},d={nameLocation:"center"};"column"===c.type||"line"===c.type&&c.labels?(k.data=c.labels,k.type="category",d.type="value"):"bar"===c.type&&
c.labels&&(d.data=c.labels,d.type="category",k.type="value");c=null;b&&(k.name=b.name,k.show=!!b.show,b.textStyle&&(k.axisLabel=b.textStyle),b.nameTextStyle&&(k.nameTextStyle=b.nameTextStyle),c=b.format)&&(k.minInterval="int"===c.type?1:0);g&&(d.show=!!g.show,g.textStyle&&(d.axisLabel=g.textStyle),c=g.format)&&(d.minInterval="int"===c.type?1:0);window.isRTL&&(k.inverse=!0,d.position="right");a.xAxis=k;a.yAxis=d;return a},settingRadar:function(a,c){if("radar"!==c.type)return a;a.radar={nameGap:6,radius:"70%"};
a.radar.axisLabel={show:!0,formatter:function(){}};c.radarShape&&(a.radar.shape=c.radarShape);c.indicator?(this._handleRadarIndicator(c),a.radar.indicator=c.indicator):console.error("No radar indicator");return a},_handleRadarIndicator:function(a){var c=a.series[0].data,b=[];a.indicator.forEach(function(a,k){if("undefined"!==typeof a.max)return a;b=c.map(function(a){b.push(a.value[k])});var g=Math.max.apply(Math,b);a.max=g})},settingArea:function(a,c){if("line"!==c.type||!c.area)return a;a.series=
a.series.map(function(a){a.areaStyle||(a.areaStyle={});"undefined"===typeof a.areaStyle.opacity&&(a.areaStyle.opacity=.4);a.sthisoth=!0;a.smoothMonotone="x";return a});return a},_mockNegativeValue:function(a){return a&&a[0]&&a[0].data?a.map(function(a){a.data=a.data.map(function(a,c){var b=0===c%2;a&&"undefined"!==typeof a.value?(c=a.value,c=Number(c),a.value=b?-c:c):(c=Number(a),a=-(b?-c:c));return a});return a}):a},hasNegativeValue:function(a){if((a=a.series)&&a[0]&&a[0].data)return a.some(function(a){return a.data.some(function(a){a=
a&&"undefined"!==typeof a.value?a.value:a;a=Number(a);return"number"===typeof a&&0>a})})},allNegativeValue:function(a){return(a=a.series)&&a[0]&&a[0].data?a.every(function(a){return a.data.every(function(a){a=a&&a.value?a.value:a;a=Number(a);return"number"===typeof a&&0>a})}):!1},settingStack:function(a,c){c=this._stackForPercent(c);if("percent"===c.stack){var b=this.hasNegativeValue(c),g=this.allNegativeValue(c),k=0,d=1;b&&(k=-1,g&&(d=0),"bar"===c.type?(a.xAxis.max=d,a.xAxis.min=k):(a.yAxis.max=
d,a.yAxis.min=k))}c.stack&&(a.series=a.series.map(function(a){a.stack="stack";return a}));return a},_stackForPercent:function(a){if("percent"!==a.stack)return a;var c=[];a.series.forEach(function(a){l.clone(a.data).forEach(function(a,b){c[b]||(c[b]=[]);(a=a&&"undefined"!==typeof a.value?a.value:a)||(a=0);c[b].push(a)})});var b=[];c.forEach(function(a,c){b[c]||(b[c]=0);a.forEach(function(a){b[c]+=Math.abs(a)})});var g=c.map(function(a,c){return a.map(function(a){return 0===b[c]?null:0<=a?Math.abs(a)/
b[c]:-Math.abs(a)/b[c]})});a.series=a.series.map(function(a,b){var c=l.clone(a.data),c=c.map(function(a,c){if(!a)return a;"undefined"!==typeof a.value?a.value=g[c][b]:a=g[c][b];return a});a.data=c;return a});return a},settingLegend:function(a,c){var b=c.legend;if(!b)return a.legend={show:!1},a;var g={show:b.show,type:"scroll",itemHeight:11,orient:"horizontal",pageButtonPosition:"end",pageTextStyle:{color:"#939393"}};b.textStyle&&(g.textStyle=b.textStyle);a.legend=g;return a=this._handleLegendRTL(a,
c)},_handleLegendRTL:function(a,c){if(!c.legend)return a;c={};window.isRTL?(c.x="right",c.pageButtonPosition="start"):(c.x="left",c.pageButtonPosition="end");a.legend=l.mixin(a.legend,c);return a},settingScale:function(a,c){if(!c.scale)return a;if("bar"===c.type)a.xAxis.scale=!0;else if("line"===c.type||"column"===c.type)a.yAxis.scale=!0;return a},pieChartAvoidLegendLabelOverLap:function(a,c){if("pie"!==c.type)return a;var b=c.dataLabel&&c.dataLabel.show?.75:.85;c.legend&&c.legend.show&&(b-=.12);
a.series[0].radius[1]=100*b+"%";return a},settingChartLayout:function(a,c){if(!this.isBaseChartType(c))return a;(c=c.layout)&&c.length&&c.forEach(function(b){this._assigneeLayout(a,b)}.bind(this));return a},avoidAdjoiningColorSameForPie:function(a,c){if("pie"!==c.type||!a.color||2>=a.color.length)return a;a.series&&a.series[0]&&a.series.forEach(l.hitch(this,function(b){var c=b.data.length;0===(c-1)%a.color.length&&(b=b.data[c-1],b.itemStyle||(b.itemStyle={}),b.itemStyle.color||(b.itemStyle.color=
a.color[1]))}));return a},_assigneeLayout:function(a,c){var b=c.name;if("xAxisName"!==b&&"yAxisName"!==b){var g=c.layout;c=this._getOperateObjByProperty(a,b);if(!c)return a;var k=this._getSubPosition(g&&g.subPosition),d=g&&g.position,g=g&&g.inner,e={};"l"===d?e.left=g?this.unitDistance+this.defultGrid.left-5:this.defultGrid.left-5:"r"===d?e.right=g?this.unitDistance+this.defultGrid.right-5:this.defultGrid.right-5:"t"===d?e.top=g?this.defultGrid.top+this.unitDistance-5:this.defultGrid.top-5:"b"===
d&&(e.bottom=g?this.unitDistance+this.defultGrid.bottom-5:this.defultGrid.bottom-5);l.mixin(c,e);l.mixin(c,k);this._specialLegend(c,b,d);this._specialSliderDataZoom(c,b,d);return a}},_getSubPosition:function(a){if("l"===a)return{left:this.defultGrid.left-5,right:"auto"};if("r"===a)return{right:this.defultGrid.right-5,left:"auto"};if("t"===a)return{top:this.defultGrid.top-5,bottom:"auto"};if("b"===a)return{bottom:this.defultGrid.bottom-5,top:"auto"}},_specialLegend:function(a,c,b){"legend"===c&&(a.orient=
"l"===b||"r"===b?"vertical":"horizontal")},_specialSliderDataZoom:function(a,c,b){"dataZoom"===c&&("l"===b||"r"===b?(a.orient="vertical",a.width=15):(a.orient="horizontal",a.height=15))},_getOperateObjByProperty:function(a,c){if("dataZoom"===c)return this._getSliderDataZoom(a);if("legend"===c)return a.legend},_getSliderDataZoom:function(a){var c=null;(a=a.dataZoom)&&a.length&&a.some(function(a){return"slider"===a.type?(c=a,!0):!1});return c},settingAxisSeries:function(a,c){a=this._setTypeToSeries(a,
c);a.series=c.series;return a},settingMarks:function(a,c){a=this.settingMarkLine(a,c);return a=this.settingMarkArea(a,c)},settingMarkLine:function(a,c){(c=c.markLine)&&c.data&&(c.silent=!0,c.data.forEach(function(a){a.label||(a.label={show:!1,position:"end"});"undefined"!==typeof a.name&&(a.label.show=!0,a.label.formatter=a.name)}),a.series[0].markLine=l.clone(c));return a},settingMarkArea:function(a,c){c.markArea&&(this._handleMarkAreaRTL(c.markArea),c.markArea.silent=!0,a.series[0].markArea=c.markArea);
return a},_handleMarkAreaRTL:function(a){window.isRTL&&a&&a.data&&a.data.length&&a.data.forEach(function(a){var b=(a=a&&a[0]&&a[0].label)&&a.position;b&&("left"===b?b="right":"right"===b?b="left":"insideLeft"===b?b="insideRight":"insideRight"===b&&(b="insideLeft"),a.position=b)})},_settingSeriesDataLabel:function(a,c){c=c.dataLabel;if(!c)return a;var b={};b.show=!!c.show;"undefined"!==typeof c.textStyle&&(b.textStyle=c.textStyle);a.series.forEach(function(a){a.label=b});return a},settingRadarSeries:function(a,
c){a=this._setTypeToSeries(a,c);a.series=c.series.map(l.hitch(this,function(a){a.data=this._handleSeriesDataForPieLikeType(a,c);return a=this._settingRaderSerie(a,c)}));return a},_settingRaderSerie:function(a,c){if("radar"!==a.type)return a;var b=c.indicator.map(function(a){return a.name});a.tooltip={};a.tooltip.formatter=function(a){return this.handleToolTip(a,null,!1,!1,b)};return a},settingFunnelSeries:function(a,c){a=this._setTypeToSeries(a,c);a.series=c.series.map(l.hitch(this,function(a){a.data=
this._handleSeriesDataForPieLikeType(a,c);return a=this._settingFunnelSerie(a,c)}));return a},_settingFunnelSerie:function(a,c){if("funnel"!==a.type)return a;a.minSize="0%";a.maxSize="100%";a.sort="descending";a.min=c.min||0;a.max=c.max||100;a.max=c.funnelSort||"descending";return a},settingPieSeries:function(a,c){a=this._setTypeToSeries(a,c);a.series=c.series.map(l.hitch(this,function(a){a.data=this._handleSeriesDataForPieLikeType(a,c);return a=this._settingPieSerie(a,c)}));return a},_settingPieSerie:function(a,
c){if("pie"!==a.type)return a;var b=c.dataLabel&&c.dataLabel.show;a.selectedMode="single";a.selectedOffset=10;a.hoverOffset=5;a.radius=[0,"70%"];a.labelLine={show:!0,length:5,length2:5};a.labelLine.show="undefined"===typeof c.labelLine?!0:c.labelLine;b||(a.labelLine.show=!1);"number"===typeof c.innerRadius&&(0>c.innerRadius&&(c.innerRadius=0),60<c.innerRadius&&(c.innerRadius=60),a.radius[0]=c.innerRadius+"%");"rose"===c.pieMode&&(a.roseType=c.roseType||"radius");return a=this._absoluteValueForPieChart(a)},
_absoluteValueForPieChart:function(a){if(!a||!a.data||!a.data[0])return a;a.data=a.data.map(function(a){"number"===typeof a?a=Math.abs(a):"object"===typeof a&&"number"===typeof a.value&&(a.value=Math.abs(a.value));return a});return a},_handleSeriesDataForPieLikeType:function(a,c){return a.data.map(l.hitch(this,function(a,g){var b={};a||"number"===typeof a?(b.value="undefined"!==typeof a.value?a.value:a,a.itemStyle&&(b.itemStyle||(b.itemStyle={}),b.itemStyle=l.mixin(b.itemStyle,a.itemStyle))):b.value=
a;b.name=c.labels[g]||"";return b}))},_setTypeToSeries:function(a,c){var b=c.series;if(!b)return a;b.forEach(function(a){a.type||(a.type=c.type);a.type="column"===c.type?"bar":c.type});return a},splitAxisStackColumn:function(a,c){var b=a.series;if(!b||!b.length)return a;var g;b.some(function(a){a=a.data;if(!a||!a.length)return!0;a.some(function(a){if(a&&a.itemStyle&&"undefined"!==typeof a.itemStyle.color&&"line"!==c.type)return g=c.stack?"stack":"single",!0;g=!1})});var k=0;"single"===g?k=.1:"stack"===
g&&(k=1);var d="";"stack"===g&&(d="#fff",c.backgroundColor&&"transparent"!==c.backgroundColor&&(d=c.backgroundColor));a.series=a.series.map(function(a){if("bar"===a.type||"pie"===a.type)a.itemStyle||(a.itemStyle={}),a.emphasis||(a.emphasis={}),a.itemStyle.borderWidth=k,a.emphasis.borderWidth=k,d?(a.itemStyle.borderColor=d,a.emphasis.borderColor=d):(a.itemStyle.borderColor="transparent",a.emphasis.borderColor="transparent");return a});return a},preProcessConfig:function(a,c){c.min=c.min||0;c.max=c.max||
1E3;return a},settingLabelColor:function(a,c){var b="#000";c.gaugeOption&&c.gaugeOption.labelColor&&(b=c.gaugeOption.labelColor);"curved"===c.shape?a.series[0].axisLabel.textStyle.color=b:"horizontal"===c.shape?a.xAxis.axisLabel.textStyle.color=b:"vertical"===c.shape&&(a.yAxis.axisLabel.textStyle.color=b);return a},settingValueStyle:function(a,c){var b=c.gaugeOption&&c.gaugeOption.valueStyle,g=b&&b.textStyle,b=b&&b.formatter;g&&l.mixin("curved"===c.shape?a.series[0].detail.textStyle:a.series[1].data[0].label.textStyle,
g);b&&("curved"===c.shape?a.series[0].detail.formatter=b:a.series[1].data[0].label.formatter=b);return a},settingGaugeColumnColor:function(a,c){var b=c.gaugeOption&&c.gaugeOption.bgColor;c=c.gaugeOption&&c.gaugeOption.columnColor;b&&(a.series[0].itemStyle.color=b);c&&(a.series[1].data[0].itemStyle.color=c);return a},initHorizontalOption:function(a){l.mixin(a,this.horizontal);return a},setHorizontalGrid:function(a){a.grid={top:"middle",height:90,left:"10%",right:"10%",containLabel:!0};return a},settingHorizontalAxis:function(a,
c){a.xAxis.max=c.max;a.xAxis.min=c.min;a.xAxis.scale=!0;return a},settingHorizontalSeries:function(a,c){var b=a.series;if(!b||!b.length)return a;var g=b[1];b[0].data[0]=c.max;a=this._handleValueDisplayForColumnGauge(a,c);g.data[0].name=c.labels&&c.labels[0]||"";g.name=c.series[0].name||"";return a},settingHorizontalGaugeRTL:function(a){if(!window.isRTL)return a;a.series[1].label.offset=[-20,0];a.xAxis.inverse=!0;a.yAxis.position="right";return a},initVerticalOption:function(a){l.mixin(a,this.vertical);
return a},setVerticalGrid:function(a){a.grid={left:"middle",width:60,top:"10%",bottom:"10%",containLabel:!0};a.grid.left=this._getGridLeftOfVerticalGauge();return a},settingVerticalAxis:function(a,c){a.yAxis.max=c.max;a.yAxis.min=c.min;return a},settingVerticalSeries:function(a,c){var b=a.series;if(!b||!b.length)return a;var g=b[1];b[0].data[0]=c.max;a=this._handleValueDisplayForColumnGauge(a,c);g.data[0].name=c.labels&&c.labels[0]||"";g.name=c.series[0].name||"";return a},settingVerticalGaugeRTL:function(a,
c){if(!window.isRTL)return a;var b=(c.series[0].data[0]+"").length-1;c.gaugeOption&&c.gaugeOption.valueStyle&&"undefined"!==typeof c.gaugeOption.valueStyle.decimalPlaces&&(b+=c.gaugeOption.valueStyle.decimalPlaces);a.series[1].label.offset=[-17-9*b,-15];a.xAxis.inverse=!0;a.yAxis.position="right";return a},initCurvedOption:function(a){a.series=[this.curved];return a},settingCurvedTooltip:function(a){a.tooltip.formatter=function(a){return this.handleToolTip(a,null,!1)}.bind(this);return a},settingCurvedSeries:function(a,
c){var b=a.series&&a.series[0];if(!b)return a;var g=c.max,k=c.min;b.min=k;b.max=g;var d=c.series&&c.series[0]&&c.series[0].data&&c.series[0].data[0],d=d||0;b.data[0].value=d;g=d<=k?0:d>=g?1:parseFloat((d-k)/(g-k)).toFixed(2);b.axisLine.lineStyle.color[0][0]=g;if(g=c.labels&&c.labels[0])b.data[0].name=g;b.name=c.series[0]&&c.series[0].name||"";b.axisLine.lineStyle.width=30;a.series=[b];return a},settingCurvedGaugeColor:function(a,c){var b=a.series&&a.series[0];c.gaugeOption&&(c.gaugeOption.bgColor&&
(b.axisLine.lineStyle.color[1][1]=c.gaugeOption.bgColor),c.gaugeOption.columnColor&&(b.axisLine.lineStyle.color[0][1]=c.gaugeOption.columnColor,b.itemStyle.color=c.gaugeOption.columnColor));return a},settingCurvedTargets:function(a,c){if(!a.series)return a;a.series[0].splitNumber=1E3;a.series[0].axisTick.splitNumber=1;a.series[0].axisTick.show=!1;this.targets=this._getTargetValues(c);return a=this._showTargetsForCurved(a,c,this.targets)},createTargetGraphic:function(a){var c=a.shape,b=[];if("vertical"!==
c&&"horizontal"!==c)return b;var g="#000";a.gaugeOption&&a.gaugeOption.labelColor&&(g=a.gaugeOption.labelColor);var k,d=a.min||0,e=a.max||100;a=this._getTargetValues(a);var f=a.range;a.values.forEach(function(a){if(!(a>e||a<d)){k=this._calcGraphicPosition(a,c);var f=k.top,m=k.textLeft,h=this._createGraphic(k.graphicLeft,f,a,g,"image",c);a=this._createGraphic(m,f,a,g,"text",c);b.push(h);b.push(a)}}.bind(this));f.forEach(function(a){a>e||a<d||(k=this._calcGraphicPosition(a,c),a=this._createGraphic(k.textLeft,
k.top,a,g,"text",c),b.push(a))}.bind(this));return b},_calcGraphicPosition:function(a,c){var b,g,k;"vertical"===c?(b=this.chart.convertToPixel({xAxisIndex:0},0),b=parseFloat(b,10).toFixed(2),b=Number(b),window.isRTL&&(b+=40),g=b-26,k=window.isRTL?g+11:g-11-6*(a.toString().length-1),b=this._getyAxisValueTop(a),b-=2):"horizontal"===c&&(b=this.chart.convertToPixel({yAxisIndex:0},0),b=parseInt(b,10),b=Number(b)+16,g=this._getxAxisValueLeft(a),a=6*(a.toString().length-2),k=g,0<a&&(k=g-a));return{top:b,
graphicLeft:g,textLeft:k}},_createGraphic:function(a,c,b,g,k,d){var e=this.horIconUrl;"vertical"===d&&(e=window.isRTL?this.verIconUrlRTL:this.verIconUrl);var h=null;"image"===k?h={z:10,type:"image",$action:"merge",id:"wab_gid_image-"+f.getRandomString(),left:a,style:{image:e,width:10,height:10},silent:!0,top:c}:"text"===k&&(b=this.tryLocaleNumber(b),h={z:10,type:"text",$action:"merge",id:"wab_gid_text-"+f.getRandomString(),left:a,style:{text:b,fill:g,font:"normal 11px sans-serif"},silent:!0});"text"===
k&&(h.top="vertical"===d?c-2:c+11);return h},updateGridForVerticalGauge:function(a){if("gauge"===a.type&&"vertical"===a.shape)return{left:this._getGridLeftOfVerticalGauge(),width:60,top:"10%",bottom:"10%"}},_getTargetValues:function(a){var c=a.gaugeOption&&a.gaugeOption.showTargetValueLabel,b=a.gaugeOption&&a.gaugeOption.showDataRangeLabel,g=a.gaugeOption&&a.gaugeOption.targetValue,k=a.min||0;a=a.max||1E3;var d={values:[],range:[]};g&&c&&g.forEach(function(a){d.values.push(a)});b&&(0>d.values.indexOf(k)&&
(d.range[0]=k),0>d.values.indexOf(a)&&(d.range[1]=a));return d},_showTargetsForCurved:function(a,c,b){var g=b.values.concat(b.range),k=(c.max-c.min)/1E3;g.sort(function(a,b){return a-b});a.series[0].axisLabel.formatter=l.hitch(this,function(a){var b;g.forEach(function(c){"undefined"===typeof b&&c>=a&&c<a+k&&(b=c)});"number"===typeof b&&(b=this.tryLocaleNumber(b));return b});return a},_handleValueDisplayForColumnGauge:function(a,c){var b=c.min||0,g=c.max||1E3,k;k=c.series[0].data[0];c=k>=g?g:k<=b?
b:k;a.tooltip.formatter=function(a){return this.handleToolTip(a,k,!1)}.bind(this);a.series[1].data[0].value=c;return a},_getGridLeftOfVerticalGauge:function(){return this.chart.getWidth()/2-30},_getxAxisValueLeft:function(a){a=this.chart.convertToPixel({xAxisIndex:0},a);return parseFloat(a,10)-4},_getyAxisValueTop:function(a){a=this.chart.convertToPixel({yAxisIndex:0},a);return parseFloat(a,10)}})})},"jimu/dijit/_Gauge":function(){define(["dojo/_base/declare"],function(n){return n([],{constructor:function(f){this.chart=
f.chart;this.chartUtils=f.chartUtils},produceOption:function(f,h){f=this.chartUtils.preProcessConfig(f,h);"curved"===h.shape?f=this.setCurvedGaugeOption(f,h):"vertical"===h.shape?f=this.setVerticalGaugeOption(f,h):"horizontal"===h.shape?f=this.setHorizontalGaugeOption(f,h):console.error("invaild gauge shape");f=this.chartUtils.settingLabelColor(f,h);return f=this.chartUtils.settingValueStyle(f,h)},setCurvedGaugeOption:function(f,h){f=this.chartUtils.initCurvedOption(f);f=this.chartUtils.settingCurvedSeries(f,
h);f=this.chartUtils.settingCurvedTooltip(f,h);f=this.chartUtils.settingCurvedGaugeColor(f,h);return f=this.chartUtils.settingCurvedTargets(f,h)},setVerticalGaugeOption:function(f,h){f=this.chartUtils.initVerticalOption(f,this.vertical);f=this.chartUtils.setVerticalGrid(f);f=this.chartUtils.settingVerticalAxis(f,h);f=this.chartUtils.settingVerticalSeries(f,h);f=this.chartUtils.settingGaugeColumnColor(f,h);return f=this.chartUtils.settingVerticalGaugeRTL(f,h)},setHorizontalGaugeOption:function(f,h){f=
this.chartUtils.initHorizontalOption(f,this.horizontal);f=this.chartUtils.setHorizontalGrid(f);f=this.chartUtils.settingHorizontalAxis(f,h);f=this.chartUtils.settingHorizontalSeries(f,h);f=this.chartUtils.settingGaugeColumnColor(f,h);return f=this.chartUtils.settingHorizontalGaugeRTL(f,h)},resetGraphic:function(f){if("horizontal"===f.shape||"vertical"===f.shape)f=this.chartUtils.createTargetGraphic(f),this.clearGraphic(),this.chart.setOption({graphic:f}),this.cacheGraphic=null,this.cacheGraphic=f},
clearGraphic:function(){this.cacheGraphic&&(this.cacheGraphic.forEach(function(f){f.$action="remove"}),this.chart.setOption({graphic:this.cacheGraphic}))},resetGrid:function(f){("horizontal"===f.shape||"vertical"===f.shape)&&(f=this.chartUtils.updateGridForVerticalGauge(f))&&this.chart.setOption({grid:f})}})})},"jimu/dijit/_ChartOptionFactory":function(){define(["dojo/_base/declare"],function(n){return n([],{constructor:function(f){this.chart=f.chart;this.gauge=f.gauge;this.chartUtils=f.chartUtils},
produceOption:function(f){if(f&&f.type){var h=f.type,l={},l=this.setCommonOption(l,f);this.chartUtils.isAxisChart(f)?l=this.setAxisChartOption(l,f):"pie"===h?l=this.setPieChartOption(l,f):"funnel"===h?l=this.setFunnelChartOption(l,f):"radar"===h?l=this.setRadarChartOption(l,f):f.shape&&(l=this.setGaugeChartOption(l,f));return l=this.chartUtils.settingAdvanceOption(l,f)}},setPieChartOption:function(f,h){f=this.chartUtils.settingPieSeries(f,h);f=this.chartUtils._settingSeriesDataLabel(f,h);f=this.chartUtils.pieChartAvoidLegendLabelOverLap(f,
h);return f=this.chartUtils.avoidAdjoiningColorSameForPie(f,h)},setGaugeChartOption:function(f,h){return f=this.gauge.produceOption(f,h)},setFunnelChartOption:function(f,h){return f=this.chartUtils.settingFunnelSeries(f,h)},setRadarChartOption:function(f,h){f=this.chartUtils.settingRadar(f,h);return f=this.chartUtils.settingRadarSeries(f,h)},setAxisChartOption:function(f,h){f=this.chartUtils.settingDefaultGrid(f,h);f=this.chartUtils.settingAxisChartAxis(f,h);f=this.chartUtils.settingAxisSeries(f,
h);f=this.chartUtils.settingMarks(f,h);f=this.chartUtils._settingSeriesDataLabel(f,h);f=this.chartUtils.splitAxisStackColumn(f,h);f=this.chartUtils.settingStack(f,h);f=this.chartUtils.settingArea(f,h);return f=this.chartUtils.settingScale(f,h)},setCommonOption:function(f,h){this.chart._theme||(this.chart._theme={});f=this.chartUtils.settingRenderOption(f,h);f=this.chartUtils.settingBackgroundColor(f,h);f=this.chartUtils.settingColor(f,h);f=this.chartUtils.settingToolTip(f,h);return f=this.chartUtils.settingLegend(f,
h)}})})},"libs/echarts/light":function(){(function(n,f){"function"===typeof define&&define.amd?define(["exports","./echarts"],f):"object"===typeof exports&&"string"!==typeof exports.nodeName?f(exports,require("./echarts")):f({},n.echarts)})(this,function(n,f){f?f.registerTheme("light",{color:"#2ec7c9 #b6a2de #5ab1ef #ffb980 #d87a80 #8d98b3 #e5cf0d #97b552 #95706d #dc69aa #07a2a4 #9a7fd1 #588dd5 #f5994e #c05050 #59678c #c9ab00 #7eb00a #6f5553 #c14089".split(" "),textStyle:{},title:{textStyle:{color:"#008acd"},
subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{normal:{}},lineStyle:{normal:{width:"1"}},symbolSize:"5",symbol:"circle",smooth:!1},radar:{itemStyle:{normal:{}},lineStyle:{normal:{width:"1"}},symbolSize:"6",symbol:"circle",smooth:!1},gauge:{axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#E5E5E5"]]}},itemStyle:{normal:{color:"#686868"},emphasis:{color:"#686868"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#333"}},
splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(0,0,0,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#333"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(0,0,0,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{normal:{borderColor:"#2ec7c9"},
emphasis:{borderColor:"#18a4a6"}}},legend:{textStyle:{color:"#333333"}},tooltip:{axisPointer:{lineStyle:{color:"#008acd",width:"1"},crossStyle:{color:"#008acd",width:"1"}}},dataZoom:{backgroundColor:"#F4F4F4",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"#E0E0E0",handleColor:"#777777",handleSize:"100%",borderColor:"#F4F4F4",textStyle:{color:"#939393"}}}):"undefined"!==typeof console&&console&&console.error&&console.error("ECharts is not Loaded")})},"libs/echarts/dark":function(){(function(n,
f){"function"===typeof define&&define.amd?define(["exports","./echarts"],f):"object"===typeof exports&&"string"!==typeof exports.nodeName?f(exports,require("./echarts")):f({},n.echarts)})(this,function(n,f){f?f.registerTheme("dark",{color:"#fc97af #87f7cf #f7f494 #72ccff #f7c5a0 #d4a4eb #d2f5a6 #76f2f2".split(" "),textStyle:{},title:{textStyle:{color:"#ffffff"},subtextStyle:{color:"#dddddd"}},line:{itemStyle:{normal:{}},lineStyle:{normal:{width:"1"}},symbolSize:"5",symbol:"circle",smooth:!1},radar:{itemStyle:{normal:{}},
lineStyle:{normal:{width:"1"}},symbolSize:"5",symbol:"circle",smooth:!1},gauge:{axisLine:{lineStyle:{color:[[.31,"#58f7f3"],[1,"#1E5F6F"]]}},itemStyle:{normal:{color:"#D9D9D9"},emphasis:{color:"#D9D9D9"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#939393"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(255,255,255,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},
valueAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,textStyle:{color:"#939393"}},splitLine:{show:!0,lineStyle:{type:"dashed",color:["rgba(255,255,255,0.1)"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{normal:{borderColor:"#999999"},emphasis:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",
width:1}}},dataZoom:{backgroundColor:"#525252",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"#737373",handleColor:"#BDBDBD",handleSize:"100%",borderColor:"#525252",textStyle:{color:"#939393"}}}):"undefined"!==typeof console&&console&&console.error&&console.error("ECharts is not Loaded")})},"widgets/Infographic/utils":function(){define("dojo/on jimu/utils dojo/_base/lang dojo/_base/Color dojo/_base/array dojo/Deferred esri/layers/FeatureLayer".split(" "),function(n,f,h,l,e,a,c){return{getClientFeaturesFromMap:function(a,
c,k,d){return f.getClientFeaturesFromMap(a,c,k,d)},listenClientFeaturesFromMap:function(a,c,k,d,f){var b=[];k&&(b.push(n(c,"selection-complete",h.hitch(this,function(){f(this.getClientFeaturesFromMap(a,c,k,d))}))),b.push(n(c,"selection-clear",h.hitch(this,function(){f(this.getClientFeaturesFromMap(a,c,k,d))}))));d&&b.push(n(a,"extent-change",h.hitch(this,function(){0<c.graphics.length&&f(this.getClientFeaturesFromMap(a,c,k,d))})));b.push(n(c,"update-end",h.hitch(this,function(){f(this.getClientFeaturesFromMap(a,
c,k,d))})));f(this.getClientFeaturesFromMap(a,c,k,d));return{remove:function(){b&&e.forEach(b,h.hitch(this,function(a){a.remove()}));b=null}}},getVaildIndicator:function(a,c,k){var b=[];c.map(h.hitch(this,function(c){(c=this._handleOperator(c,a,k))&&b.push(c)}));if(0<b.length)return b[b.length-1]},filterFeaturesByDataSourceSetting:function(a,c,k){if(0===a.length)return[];if(c.useSelection){var b=a[0].getLayer();if(b){var g=b.getSelectedFeatures();0<g.length&&(a=e.filter(a,function(a){return-1<g.indexOf(a)}))}}c.filterByExtent&&
(a=f.filterFeaturesByExtent(k.extent,a));return a},_handleOperator:function(a,c,k){function b(a){g={};a.valueColor&&(g.valueColor=a.valueColor);a.gaugeColor&&(g.gaugeColor=a.gaugeColor);a.iconInfo&&(g.iconInfo=a.iconInfo)}var g,e=a.value.map(h.hitch(this,function(b){return a.isRatio?b/100*k:b}));"greater"===a.operator&&c>e[0]?b(a):"smaller"===a.operator&&c<e[0]?b(a):"between"===a.operator&&c>e[0]&&c<e[1]?b(a):"equal"===a.operator&&c===e[0]?b(a):"notEqual"===a.operator&&c!==e[0]&&b(a);return g},isInteger:function(a){return"number"===
typeof a&&0===a%1},_getFieldNamesByFields:function(a){if(a&&a.length)return a.map(function(a){return this._getFieldNameByFieldInfo(a)}.bind(this))},_getFieldNameByFieldInfo:function(a){return a&&a.name},isBaseAxisChart:function(a){return"column"===a||"bar"===a||"line"===a},isEqual:function(a,c){return typeof a!==typeof c?!1:"object"!==typeof a?a===c:f.isEqual(a,c)},separationChartProperties:function(a){var b=a.type;a=a.mode;var c=["mode","type"],d=["backgroundColor","seriesStyle","legend","highLightColor"];
"feature"===a?c=c.concat(["labelField","valueFields"]):"category"===a?c=c.concat(["categoryField","dateConfig","valueFields","operation","nullValue"]):"count"===a?c=c.concat(["categoryField","dateConfig"]):"field"===a&&(c=c.concat(["valueFields","operation","nullValue"]));c=c.concat(["sortOrder","maxLabels"]);d="pie"===b?d.concat(["dataLabel","innerRadius"]):d.concat(["xAxis","yAxis","stack","area","marks"]);return{dataProperties:c,displayProperties:d}},classifyChartConfig:function(a){if(a){var b=
this.separationChartProperties(a),c=b.displayProperties,d={},e={};b.dataProperties.forEach(h.hitch(this,function(b){d[b]=a[b]}));c.forEach(h.hitch(this,function(b){e[b]=a[b]}));return{data:d,display:e}}},getCleanChartConfig:function(a){var b={mode:a.mode,type:a.type},c=this.separationChartProperties(a),d=c&&c.dataProperties,c=c&&c.displayProperties;d&&d.length&&d.forEach(h.hitch(this,function(c){b[c]=a[c]}));c&&c.length&&c.forEach(h.hitch(this,function(c){b[c]=a[c]}));return!b.mode||!("count"===b.mode||
b.valueFields&&b.valueFields.length)||"pie"===b.type&&""===b.maxLabels?null:h.clone(b)},_cloneAndFormatDS:function(a){a=h.clone(a);var b={};a.name&&(b.name=a.name);a.dataSourceType&&(b.dataSourceType=a.dataSourceType);a.layerId&&(b.layerId=a.layerId);a.frameWorkDsId&&(b.frameWorkDsId=a.frameWorkDsId);a=null;return b},isDSEqual:function(a,c){if(a&&c)return a=this._cloneAndFormatDS(a),c=this._cloneAndFormatDS(c),this.isEqual(a,c)},separationGradientColors:function(a,c){var b=[];2===a.length&&(b=this._createGradientColors(a[0],
a[a.length-1],c));return b},_createGradientColors:function(a,c,e){var b=[];a=new l(a);var g=new l(c);c=(g.r-a.r)/e;for(var k=(g.g-a.g)/e,g=(g.b-a.b)/e,f=new l,h=0,q=0,v=0,n=0;n<e;n++)h=parseInt(a.r+c*n,10),q=parseInt(a.g+k*n,10),v=parseInt(a.b+g*n,10),f.setColor([h,q,v]),b.push(f.toHex());return b},mockLayerDefinitionForSTD:function(a){var b={type:"Table",fields:[]};b.fields=a.fields;b.fields.push({name:"STAT_COUNT",type:"esriFieldTypeInteger",alias:"STAT_COUNT"});return b},getLoadedLayer:function(b){var g=
new a,e=null,e="string"===typeof b?new c(b):"esri.layers.FeatureLayer"===b.declaredClass?b:new c({layerDefinition:h.clone(b),featureSet:null});if(e.loaded)g.resolve(e);else e.on("load",function(){g.resolve(e)});return g},parseDataSourceId:function(a){var b=a.split("~"),c={};if(2>b.length)return console.error("Bad data source id:",a),c;switch(b[0]){case "map":return b=a.lastIndexOf("~"),c={from:"map",layerId:a.substring(4,b)};case "widget":return c={from:"widget",widgetId:b[1]};case "external":return c=
{from:"external"};default:console.error("Bad data source id:",a)}},getDsTypeInfoMeta:function(a,c){var b={dsTypeInfo:null,dsMeta:null};b.dsTypeInfo=this.parseDataSourceId(a);if(c=c.dataSource&&c.dataSource.dataSources)b.dsMeta=c[a];return b},getValueFromFeatures:function(a,c,e){if(!a||!c||!e)return!1;a=this.getSingleValueFromFeatures(a,c,e);a=this._getVaildValue(a);return"number"!==typeof a?!1:a},_getVaildValue:function(a){if(a||0===a)return Number(a)},cleanFeatures:function(a){if(a&&a.length)return a.map(function(a){return{attributes:a.attributes}})},
getFieldAliasByFieldInfo:function(a,c){var b="";if(!a)return b;var d=a.name,b=a.alias||d;c&&(b=this.getAliasFromPopupInfo(d,c));return b},getAliasFromPopupInfo:function(a,c){var b=a;if(!c)return b;(c=c.fieldInfos)&&0<c.length&&c.forEach(function(c){c.fieldName===a&&(b=c.label)});return b},isFolatNumber:function(a){return"number"!==typeof a?!1:/^(-?\d+)(\.\d+)?$/.test(a)},addAliasForLayerDefinition:function(a,c){a&&a.fields&&0<a.fields.length&&a.fields.forEach(h.hitch(this,function(a){var b=this.getFieldAliasByFieldInfo(a,
c);b&&(a.alias=b)}))},mockDataSourceForGaugeRange:function(a,c){var b=this.getRangeSourceInfo(a);a=this._mockDataSourceByStatSourceID(b.range1,c);c=this._mockDataSourceByStatSourceID(b.range2,c);return[a,c]},_mockDataSourceByStatSourceID:function(a,c){a=a||{};var b=a.id||c;a=a.id?a.label:c;var d;b&&(d={name:a,frameWorkDsId:b,dataSourceType:"DATA_SOURCE_FROM_FRAMEWORK"});return d},getStatisticForChart:function(a){var b,c,d,e=a.mode;c=a.valueFields;var f=a.operation,h=a.nullValue;"average"===f&&(f=
"avg");a=a.categoryField;"count"!==e?(b=c,c=f):c="count";if("category"===e||"count"===e)d=[a];return{type:c,fields:b,groupByFields:d,nullValue:h}},getStatisticForGauge:function(a){var b={};a=a.statistics;if(!a||!a.length)return b;a.forEach(function(a){"value"===a.type&&(b.value=a.config.value);"range"===a.type&&"stat"===a.config.type&&(b[a.name]=a.config.value.statistic)});return b},getStatisticForNumber:function(a){if(a&&a.statistics&&a.statistics.length)return a.statistics[0].config.value},getRangeDataSource:function(a){var b=
{};if(!a||!a.config)return b;a=a.config.statistics;if(!a||!a.length)return b;a.forEach(function(a){"range"===a.type&&"stat"===a.config.type&&(b[a.name]={name:a.config.value.sourceLabel||a.config.value.sourceID,frameWorkDsId:a.config.value.sourceID,dataSourceType:"DATA_SOURCE_FROM_FRAMEWORK"})});return b},getRangeFixedValue:function(a){var b={};a=a.config.statistics;if(!a||!a.length)return b;a.forEach(function(a){"range"===a.type&&"fixed"===a.config.type&&(b[a.name]=a.config.value)});return b},checkDataSourceIsVaild:function(a,
c,e,d,f){var b={code:0,fields:[]},g=null;a?"DATA_SOURCE_FROM_FRAMEWORK"===a.dataSourceType?(b.label=a.name||a.frameWorkDsId,d&&d.dataSource&&d.dataSource.dataSources?(a=d.dataSource.dataSources[a.frameWorkDsId])?(g=a.dataSchema&&a.dataSchema.fields,c=this._getNeededFieldsByMainDijitJson(c,f),b=this._isDataSourceContainNeededFields(g,c,b)):b.code=1:b.code=1):"DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===a.dataSourceType&&(g=a.layerId,b.label=a.name||a.layerId,g&&e?(a=e.getLayer(g))?(g=a.fields,c=this._getNeededFieldsByMainDijitJson(c,
f),b=this._isDataSourceContainNeededFields(g,c,b)):b.code=1:b.code=1):b.code=1;return b},getCheckDataSourceResultCode:function(a){if(a&&a.length){a=h.clone(a);var b=a.shift();if(b.code)return b.code;var c=0;a.some(function(a){if(a&&1===a.code)return c=3,!0;if(a&&2===a.code)return c=2,!0});return c}},getRangeSourceInfo:function(a){var b={};if(!a||!a.length)return b;a.forEach(function(a){if("range"===a.type&&"stat"===a.config.type){var c=a.name,g=a.config.value.sourceID;a=a.config.value.sourceLabel;
c&&g&&(b[c]={id:g,label:a||g})}});return b},getGaugeNumberStatisticField:function(a){var b={};if(!a||!a.length)return b;a.forEach(function(a){if("range"===a.type&&"stat"===a.config.type){var c=a.name;a=a.config.value.statistic.field;c&&a&&(b[c]=a)}else"value"===a.type&&(a=a.config.value.field,b.value=a)});return b},_isDataSourceContainNeededFields:function(a,c,e){if(!a||!a.length)return e.code=1,e;var b=this._getFieldNamesByFields(a);if(!c||!c.length)return e.code=0,e;c.forEach(function(a){0>b.indexOf(a)&&
e.fields.push(a)});e.fields.length&&(e.code=2);return e},_getNeededFieldsByMainDijitJson:function(a,c){if(a)return this._getNeededFieldsByDijitConfig(a.type,a.config,c)},_getNeededFieldsByDijitConfig:function(a,c,e){var b=null;if(c){if("chart"===a)b=[],c.labelField&&b.push(c.labelField),c.categoryField&&b.push(c.categoryField),c.valueFields&&c.valueFields.length&&(b=b.concat(c.valueFields));else if("gauge"===a||"number"===a)b=[],(a=c.statistics)&&(e=this.getGaugeNumberStatisticField(a)[e])&&b.push(e);
if(b&&b.length)return b}},formatterRangeNumber:function(a){"number"!==typeof a&&(a=Number(a));if(!a&&0!==a)return!1;this.isFolatNumber(a)&&(a=a.toFixed(2),a=Number(a));return a},upperCaseString:function(a){return a&&"string"===typeof a?a.toUpperCase():a},lowerCaseString:function(a){return a&&"string"===typeof a?a.toLowerCase():a},isStrictNaN:function(a){return"number"===typeof a&&isNaN(a)},isValidValue:function(a){return"undefined"!==typeof a&&null!==a&&""!==a&&!this.isStrictNaN(a)}}})},"widgets/Infographic/dijits/GaugeDijit":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html ./BaseDijit jimu/utils jimu/dijit/Chart ../utils ./clientStatistic".split(" "),
function(n,f,h,l,e,a,c,b){return n([l],{templateString:'\x3cdiv style\x3d"width:100%;height:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"noDataDiv"class\x3d"no-data-tip"\x3e${nls.noData}\x3c/div\x3e\x3cdiv class\x3d"gauge-dom" data-dojo-attach-point\x3d"gaugeDomNode"\x3e\x3c/div\x3e\x3c/div\x3e',type:"gauge",baseClass:"infographic-gauge-dijit",config:null,defValueStyle:{state:!0,isRatio:!1,font:{font:{fontFamily:"Arial",bold:!1,italic:!1,underline:!1},textColor:"#59bad8"},dataFormat:{unit:"none",
decimalPlaces:"",prefix:"",suffix:""}},constructor:function(a){this.inherited(arguments);this.visible=a.visible},postCreate:function(){this.inherited(arguments);this._features=null;this._upgradeConfig(this.config);this.setConfig(this.config);this._updateBackGroundColor()},_upgradeConfig:function(a){(a=(a=a&&a.display&&a.display.currentValue)&&a.dataFormat)&&"undefined"===typeof a.digitSeparator&&(a.digitSeparator=!0)},setLayerInfo:function(){},setVisible:function(a){this.visible=a},resetData:function(){this.gaugeValue=
this._valueObj=this._r2fs=this._r1fs=this._features=this.dataSource=null},onDataSourceDataUpdate:function(a,b,d){this.inSettingPage?(a&&"undefined"!==typeof a.features&&(this._features=c.cleanFeatures(a.features)),this.setRangeFeatures(b,"range1"),this.setRangeFeatures(d,"range2")):this._valueObj=a},setRangeFeatures:function(a,b){"range1"===b?this._r1fs=c.cleanFeatures(a):"range2"===b&&(this._r2fs=c.cleanFeatures(a))},resize:function(){this.chart&&this.chart.resize()},setDataSource:function(a){this.inherited(arguments);
this.dataSource=a},setConfig:function(a){a&&(this.config=a)},startRendering:function(){if(this._shouldRenderGauge()){this.chart||this._createJimuChart();this._updateBackGroundColor();var a=this._calculateGaugeValue();0===a?this.showNodata():-1===a?this.showNodata(this.nls.invalidRangeTip):(a=this._createChartOption(),this.chart.updateConfig(a))}},_splitStatistic:function(a){if(a&&a.length){var b={};a.forEach(function(a){if("value"===a.type)b.value=a.config.value;else if("range"===a.type){var c=a.name;
"stat"===a.config.type?b[c]=a.config.value.statistic:"fixed"===a.config.type&&(b[c]={value:a.config.value})}});return b}},_getValueObjForSetting:function(){var a=this.config&&this.config.statistics;if(a&&a.length){var e=this._splitStatistic(a),d=e.value,f=e.range1,e=e.range2,h=this.dataSource,a=c.mockDataSourceForGaugeRange(a),d=b.statistic(d,h,this._features);"undefined"!==typeof f.value?f=f.value:(f=b.statistic(f,a[0],this._r1fs),f=b.formatterRangeNumber(f));"undefined"!==typeof e.value?e=e.value:
(e=b.statistic(e,a[1],this._r2fs),e=b.formatterRangeNumber(e));return{value:d,ranges:[f,e]}}},_calculateGaugeValue:function(){var a;a=this.inSettingPage?this._getValueObjForSetting():this._valueObj;if(!c.isValidValue(a)||!c.isValidValue(a.value))return 0;if(!this._isEffectiveRange(a))return-1;this.gaugeValue=a;return 1},_createChartOption:function(){var a=this._splitValueObj(this.gaugeValue),b=a.min,c=a.max,a=a.value,a=this._parseRealValueDecimal(a),a={series:[{data:[a]}]};a.shape=this.config.shape;
a.type="gauge";a.theme=this.isDarkTheme()?"dark":"light";var e=this._createGaugeOption();a.gaugeOption=e;a.max=c;a.min=b;return a},_parseRealValueDecimal:function(a){var b=this._getVaildValueDisplay();if(b=this._getVaildDecimalPlaces(b))a=a.toFixed(b),a=Number(a);return a},_createGaugeOption:function(){var a=this._splitValueObj(this.gaugeValue),b=a.value,c=this.config,e={},f=this._getValueStyle();f&&(e.valueStyle=f);this._setGaugeDisplay(e);a=this._getIndicatorInfo(c,b,a);a.targetValue&&(b=this._isShowTargetValue(),
e.targetValue=b?a.targetValue:[]);a.columnColor&&(e.columnColor=a.columnColor);return e},_getIndicatorInfo:function(a,b,d){var g=!1,f=!1,k=!1,h=this._getIndicatorValues(a,d);e.isNotEmptyObject(h,!0)&&(g=h);if(a=a.indicators)(b=c.getVaildIndicator(b,a,d.max))&&b.gaugeColor&&(f=b.gaugeColor),b&&b.valueColor&&(k=b.valueColor);return{targetValue:g,columnColor:f,valueColor:k}},_getIndicatorValues:function(a,b){var c=[];a.indicators&&(a.indicators.forEach(function(a){a.value&&a.value.forEach(f.hitch(this,
function(d){c.push(a.isRatio?d/100*b.max:d)}))}),c.sort(function(a,b){return a-b}),c=e.uniqueArray(c));return c},_splitValueObj:function(a){var b;b=a.value;a=a.ranges;a.sort(function(a,b){return a-b});return{min:a[0],max:a[1],value:b}},_isEffectiveRange:function(a){var b=this._splitValueObj(a);a=b.min;b=b.max;return"undefined"===typeof a||"undefined"===typeof b||b===a?!1:!0},_isRangeNeedFeatures:function(a,b){var c=!1;a=a.statistics;if(!a||!a.length)return c;a.some(function(a){if("range"===a.type&&
a.name===b&&"stat"===a.config.type)return c=!0});return c},_shouldRenderGauge:function(){if(this.visible&&this.config){var a;if(this.inSettingPage){var b=this._isRangeNeedFeatures(this.config,"range1");a=this._isRangeNeedFeatures(this.config,"range2");b=b?this._r1fs:!0;a=a?this._r2fs:!0;a=this.domNode&&this._features&&b&&a}else b=(a=this._valueObj)&&a.ranges,a=this.domNode&&a&&b&&"number"===typeof a.value&&"number"===typeof b[0]&&"number"===typeof b[1];a?this.hideNodata():this.showNodata();return!!a}},
_updateBackGroundColor:function(){var a=this.config;(a=a&&a.display&&a.display.backgroundColor)&&h.setStyle(this.domNode,"backgroundColor",a)},_createJimuChart:function(){var b=this._getDefaultChartOption();this.chart=new a({chartDom:this.gaugeDomNode,config:b});this.chart.placeAt(this.gaugeDomNode);this.chart.resize()},_generateValueFormatter:function(a){var b=this._splitValueObj(this.gaugeValue),c=b.max,g=b.min;if(a)return f.hitch(this,function(a,b){var d="",f,k,h=a.dataFormat;if(!h)return b;f=
h.decimalPlaces;k=h.digitSeparator;if(f||0===f)f=Number(f);a.isRatio?b=b<=g?e.convertNumberToPercentage(0,f,k):e.convertNumberToPercentage((b-g)/(c-g),f,k):"percentage"===h.unit?b=e.convertNumberToPercentage(b,f,k):"thousand"===h.unit?(d=this.nls.thousandAbbreviation,b/=1E3):"million"===h.unit?(d=this.nls.millionAbbreviation,b/=1E6):"billion"===h.unit&&(d=this.nls.billionAbbreviation,b/=1E9);a.isRatio||"percentage"===h.unit||(b=e.localizeNumberByFieldInfo(b,{format:{places:f,digitSeparator:k}}));
d&&(b+=d);a=b;h.prefix&&(a=h.prefix+" "+a);h.suffix&&(a+=" "+h.suffix);return a},a,b.value)},_getVaildDecimalPlaces:function(a){if(a){if((a=(a=a.dataFormat)&&a.decimalPlaces)||0===a)a=Number(a);if("number"===typeof a)return a}},_getVaildValueDisplay:function(){var a=this.config;if(a=a&&a.display)return a.currentValue&&a.currentValue.state?a.currentValue:f.clone(this.defValueStyle)},_generateTextStyle:function(a){var b=this._splitValueObj(this.gaugeValue),b=this._getIndicatorInfo(this.config,b.value,
b),c=a&&a.font;if(c){a={};"undefined"!==typeof c.fontSize&&(a.fontSize=Number(c.fontSize));a.color=b.valueColor||c.textColor;b=c.font;if(!b)return a;a.fontWeight=b.bold?"bold":"normal";b.fontFamily&&(a.fontFamily=b.fontFamily);a.fontStyle=b.italic?"italic":"normal";return a}},_isShowTargetValue:function(){var a=this.config&&this.config.display&&this.config.display.dataLabels;if(a)return!!a.targetValue},_setGaugeDisplay:function(a){var b=this.config.display;b&&(b.gaugeColor&&(a.columnColor=b.gaugeColor),
b.bgColor&&(a.bgColor=b.bgColor),b.dataLabels&&b.dataLabels.state&&(b=b.dataLabels,a.showDataRangeLabel=!!b.dataRange,a.showTargetValueLabel=!!b.targetValue,a.labelColor=b.textColor||""))},_getValueStyle:function(){var a=this._getVaildValueDisplay();if(a){var b={},c=this._getVaildDecimalPlaces(a);"number"===typeof c&&(b.decimalPlaces=c);b.formatter=this._generateValueFormatter(a);if(a=this._generateTextStyle(a))b.textStyle=a;return b}},_getDefaultChartOption:function(){var a={type:"gauge",confine:!0,
shape:"curved",min:0,max:100,series:[{data:[0]}]};this.config&&this.config.shape&&(a.shape=this.config.shape);a.theme=this.isDarkTheme()?"dark":"light";return a},showNodata:function(a){this.chart&&this.chart.clear();h.addClass(this.domNode,"no-data");a&&(this.noDataDiv.innerHTML=a)},hideNodata:function(){h.removeClass(this.domNode,"no-data")}})})},"widgets/Infographic/dijits/clientStatistic":function(){define(["jimu/DataSourceManager","jimu/statisticsUtils","../utils"],function(n,f,h){return{getSingleValueForServerStatFeature:function(f){f=
f&&f[0]&&f[0].attributes;if(!f)return null;var e=Object.keys(f)[0];return Number(f[e])},getResultForExtraStatFeature:function(f,e){var a=e.field;e=e.type;a="count"===e?"STAT_COUNT":h.upperCaseString(a+"_"+e);e=f&&f[0]&&f[0].attributes;if(!e)return null;f=e[a];"undefined"===typeof f&&(a=h.lowerCaseString(a),f=e[a]);return Number(f)},statistic:function(f,e,a,c){return f&&e&&a?"DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===e.dataSourceType?this.getStatisticResultFromFeatures(a,f):"Features"===this._getExtalDataSourceType(e,
c)?this.getStatisticResultFromFeatures(a,f):this.statisticExtraStatSource(f,a):null},formatterRangeNumber:function(f){if(!f&&0!==f)return!1;"number"!==typeof f&&(f=Number(f));this.isFolatNumber(f)&&(f=f.toFixed(2),f=Number(f));return f},isFolatNumber:function(f){return"number"!==typeof f?!1:/^\d+(\.\d+)$/.test(f)},statisticExtraStatSource:function(f,e){var a;if(e){if(0===e.length)a=void 0;else if(1===e.length)a=this._getValueFromFeatureOfExtraStatFeatures(e[0],f);else if(1<e.length){var c={count:0,
sum:0},b,g,k,d=0,h=0;e.forEach(function(a){b=this._getValueFromFeatureOfExtraStatFeatures(a,f);switch(f.type){case "count":c.count+=b;break;case "sum":c.sum+=b;break;case "min":c.min="undefined"===typeof c.min?b:Math.min(c.min,b);break;case "max":c.max="undefined"===typeof c.max?b:Math.max(c.max,b);break;case "avg":k=this._getValueFromFeatureOfExtraStatFeatures(a,{type:"count"}),g=this._getValueFromFeatureOfExtraStatFeatures(a,{field:f.field,type:"sum"}),d+=g,h+=k}}.bind(this));"avg"===f.type&&(c.avg=
0===h?0:d/h);a=c[f.type]}return a}},_getValueFromFeatureOfExtraStatFeatures:function(f,e){if(!f||!f.attributes)return"count"===e.type?0:void 0;e="count"===e.type?"STAT_COUNT":h.upperCaseString(e.field+"_"+e.type);f=f.attributes;var a=f[e];"undefined"===typeof a&&(e=h.lowerCaseString(e),a=f[e]);return a},_getCountValueFromFeatureOfExtraStatFeatures:function(f){if(f&&f.attributes){f=f.attributes;var e,a="STAT_COUNT";e=f[a];"undefined"===typeof e&&(a=h.lowerCaseString(a),e=f[a]);return e||0}},getStatisticResultFromFeatures:function(h,
e){if(h){if("count"===e.type)return h.length;var a=e.type;return f.getStatisticsResultFromClientSync({featureSet:{features:h},fieldName:e.field,statisticTypes:[a]})[a+"Field"]}},_getExtalDataSourceType:function(f,e){return this._getExtalDataSourceInfo(f,e).type},_getExtalDataSourceInfo:function(f,e){if(f){e=e||this.appConfig;var a=f.frameWorkDsId;if("undefined"!==typeof a){var c={};return c=(e=e&&e.dataSource&&e.dataSource.dataSources)?e[a]:n.getInstance().getDataSourceConfig(f.frameWorkDsId)}}}}})},
"widgets/Infographic/dijits/NumberDijit":function(){define("dojo/_base/declare ./BaseDijit dojo/dom-style dojo/_base/html jimu/utils ../utils ./clientStatistic ./styleUtils".split(" "),function(n,f,h,l,e,a,c,b){return n([f],{templateString:'\x3cdiv style\x3d"height:100%;width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"noDataDiv"class\x3d"no-data-tip"\x3e${nls.noData}\x3c/div\x3e\x3ca data-dojo-attach-point\x3d"numberContent" class\x3d"number-content no-trim" target\x3d"_blank"\x3e\x3cdiv data-dojo-attach-point\x3d"leftIcon" class\x3d"icon"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"number" class\x3d"number"\x3e\x3cdiv data-dojo-attach-point\x3d"prefix" class\x3d"prefix"\x3e\x3c/div\x3e\x3cdiv class\x3d"value-content" data-dojo-attach-point\x3d"valueContent"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"suffix" class\x3d"suffix"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"rightIcon" class\x3d"icon"\x3e\x3c/div\x3e\x3c/a\x3e\x3c/div\x3e',
baseClass:"infographic-number-dijit",type:"number",config:null,constructor:function(a){this.visible=a.visible},postCreate:function(){this.inherited(arguments);this._value=this._features=null;this._upgradeConfig(this.config);this.setConfig(this.config);this._updateBackGroundColor()},_upgradeConfig:function(a){(a=a&&a.dataFormat)&&"undefined"===typeof a.digitSeparator&&(a.digitSeparator=!0)},setLayerInfo:function(){},setVisible:function(a){this.visible=a},resetData:function(){this.numberValue=this._value=
this._features=this.dataSource=null},onDataSourceDataUpdate:function(b){this.inSettingPage?b&&"undefined"!==typeof b.features&&(this._features=a.cleanFeatures(b.features)):"number"===typeof b&&(this._value=b)},setDataSource:function(a){this.inherited(arguments);this.dataSource=a},setConfig:function(a){a&&(this.config=a)},startRendering:function(){this._shouldRenderNumber()&&(this._updateBackGroundColor(),this._calculateNumberValue(),"number"!==typeof this.numberValue?this.showNodata():this._renderNumber(this.numberValue))},
_calculateNumberValue:function(){var b;this.inSettingPage?(b=a.getStatisticForNumber(this.config),b=c.statistic(b,this.dataSource,this._features)):b=this._value;"undefined"!==typeof b&&!1!==b&&(this.numberValue=b)},_renderNumber:function(a){this._cleanNumberContent();this.valueContent.innerHTML=e.localizeNumber(a);this._setValueDisplay()},_setValueDisplay:function(){var a=this.config;a&&(this._setBackground(a),this._setFont(a),this._setDataFormat(a),this._setIndicatorStyle())},_shouldRenderNumber:function(){if(this.visible&&
this.config){var a;(a=this.inSettingPage?this.domNode&&this._features:this.domNode&&"number"===typeof this._value)?this.hideNodata():this.showNodata();return!!a}},_getIndicatorColor:function(){var b=!1,c=!1,d=this.config.indicators;d&&((d=a.getVaildIndicator(this.numberValue,d))&&d.valueColor&&(b=d.valueColor),d&&e.isNotEmptyObject(d.iconInfo)&&(c=d.iconInfo));return{color:b,icon:c}},_cleanNumberContent:function(){l.removeClass(this.leftIcon);l.addClass(this.leftIcon,["icon"]);l.removeClass(this.rightIcon);
l.addClass(this.rightIcon,["icon"]);this.replaceIcon&&(l.destroy(this.replaceIcon),this.replaceIcon=null);l.empty(this.valueContent);l.empty(this.prefix);l.empty(this.suffix);this._setValueColor("")},_updateBackGroundColor:function(){var a=this.config;(a=a&&a.background&&a.background.backgroundColor)&&l.setStyle(this.domNode,"backgroundColor",a)},_setBackground:function(a){if(a=a&&a.background){a.backgroundColor&&l.setStyle(this.domNode,"backgroundColor",a.backgroundColor);var b=a.alignment;b&&(l.removeClass(this.domNode),
l.addClass(this.domNode,"infographic-number-dijit"),b.horizontal&&l.addClass(this.domNode,"horizontal-"+b.horizontal),b.vertical&&l.addClass(this.domNode,"vertical-"+b.vertical));a.link?l.setAttr(this.numberContent,"href",a.link):l.removeAttr(this.numberContent,"href")}},_setFont:function(a){if(a&&a.font){var c={};b.font.setStyle(a.font,c);l.setStyle(this.number,c)}},_setDataFormat:function(a){var b,c="",f;b=this.numberValue;var g=a.dataFormat;g&&(a=g.decimalPlaces,f=g.digitSeparator,a&&(a=Number(a)),
"percentage"===g.unit?b=e.convertNumberToPercentage(b,a,f):"thousand"===g.unit?(c=this.nls.thousandAbbreviation,b/=1E3):"million"===g.unit?(c=this.nls.millionAbbreviation,b/=1E6):"billion"===g.unit&&(c=this.nls.billionAbbreviation,b/=1E9),"percentage"!==g.unit&&(b=e.localizeNumberByFieldInfo(b,{format:{places:a,digitSeparator:f}})),c&&(b+=c),this.valueContent.innerHTML=b,g.prefix&&(this.prefix.innerHTML=g.prefix),g.suffix&&(this.suffix.innerHTML=g.suffix))},_setIndicatorStyle:function(){var a=this._getIndicatorColor();
a.color&&this._setValueColor(a.color);a.icon&&this._setIndicatorIcon(a.icon)},_setValueColor:function(a){h.set(this.number,"color",a)},_setIndicatorIcon:function(a){a&&("left"===a.placement||"right"===a.placement?this._setLeftRightIcon(a):"replace"===a.placement&&this._setReplaceIcon(a))},_setReplaceIcon:function(a){var b=l.create("div",{"class":"indicator-icon "+a.icon});l.empty(this.valueContent);l.place(b,this.valueContent);h.set(b,"color",a.color);h.set(b,"display","inline-flex")},_setLeftRightIcon:function(a){var b;
"left"===a.placement?b=this.leftIcon:"right"===a.placement&&(b=this.rightIcon);l.addClass(b,"indicator-icon "+a.icon);h.set(b,"color",a.color)},showNodata:function(a){this._cleanNumberContent();l.addClass(this.domNode,"no-data");a&&(this.noDataDiv.innerHTML=a)},hideNodata:function(){l.removeClass(this.domNode,"no-data")}})})},"widgets/Infographic/dijits/SourceLauncher":function(){define("dojo/_base/declare dojo/_base/lang dojo/Evented dojo/on dojo/Deferred dijit/_WidgetBase jimu/utils ../utils jimu/LayerInfos/LayerInfos esri/geometry/geometryEngine esri/tasks/query esri/tasks/QueryTask esri/tasks/StatisticDefinition esri/layers/FeatureLayer ./clientStatistic".split(" "),
function(n,f,h,l,e,a,c,b,g,k,d,m,p,t,u){return n([a,h],{oidFieldType:"esriFieldTypeOID",constructor:function(a){this.uniqueID=c.getRandomString();this.map=a.map;this.useSelection=a.useSelection;this.filterByExtent=a.filterByExtent;this.returnFeatures=a.returnFeatures;this.statistic=a.statistic;this.dataSource=a.dataSource;this.config=a.config;this.isDateType=!!this.config.dateConfig;this.layerInfosObj=g.getInstanceSync();this.layerObject=a.layerObject;this.timeIntervalHandle=this.filterChangedHandle=
this.updateEndHandle=this.refreshIntervalHandle=this.selectionHandle=this.exchetChangeHandle=this._oldQueryParameter=this._queryParameter=this._layerUrl=null;this._loadingTypes={}},start:function(){this.showLoading("sl-get-lyobj");this._tryGetLayerObject("sl-get-lyobj").then(function(){this.hideLoading("sl-get-lyobj");this.awake();this._listenEventsContinuousAccessFeatures()}.bind(this),function(a){console.error(a.message||a);this.hideLoading("sl-get-lyobj");this._onFailed()}.bind(this))},awake:function(){this.sleeping=
!1;this._getFeaturesForFirst()},sleep:function(){this.sleeping=!0},destroy:function(){this._loadingTypes={};this._removeHandles();this.inherited(arguments)},_getFeaturesForFirst:function(){this._trigerCallback()},_listenEventsContinuousAccessFeatures:function(){if(this.layerObject&&this.layerInfo){var a=this._shouldAccessClientFeatures();this.useSelection&&(this._resetSelectionHandle(),this.selectionHandle=l(this.layerObject,"selection-complete,selection-clear",f.hitch(this,function(){this._trigerCallback()})));
a||(this._resetFilterChangedHandle(),this.filterChangedHandle=l(this.layerInfo,"filterChanged",f.hitch(this,function(a){a&&a.zoomAfterFilter&&this.filterByExtent||this._trigerCallback()})));a&&(this._resetUpdateEndHandle(),this.updateEndHandle=l(this.layerObject,"update-end",f.hitch(this,function(){this._trigerCallback()})));this.filterByExtent&&this.map&&(this._resetExtentChangeHandle(),this.exchetChangeHandle=l(this.map,"extent-change",f.hitch(this,function(){this.emit("start");this._trigerCallback(!0)})));
a||(this._setTimeListener(),this._resetRefreshIntervalHandle(),this.refreshIntervalHandle=l(this.layerObject,"refresh-interval-change",f.hitch(this,this._setTimeListener)))}},_setTimeListener:function(){var a=this._getLayerRefreshInterval();a?(this._resetTimeIntervalHandle(),this.timeIntervalHandle=setInterval(f.hitch(this,function(){this._trigerCallback()}),6E4*a)):this._resetTimeIntervalHandle()},_trigerCallback:function(a){var b=this.computingTheWayToGetFeatures();if(!a||2!==b||!this._isLayerOnDemandMode())switch(this.emit("start"),
b){case 1:this._getFeaturesFromSelection(this.map,this.layerObject,this.filterByExtent,f.hitch(this,this._onDataUpdate));break;case 2:this._getClientFeaturesFromMap(this.map,this.layerObject,this.filterByExtent,f.hitch(this,this._onDataUpdate));break;case 3:this._getStatisticsFeaturesForServer(f.hitch(this,this._onDataUpdate))}},computingTheWayToGetFeatures:function(){var a=0;return this.sleeping||!this.layerObject?a:a=this._isMapLayer()?this._shouldAccessFeaturesBySelection()?1:this._shouldAccessClientFeatures()?
2:3:0},_getClientFeaturesFromMap:function(a,b,c,d){var e=b.graphics;c&&(e=this._filterFeaturesByExtent(a.extent,e));e=this._sortClientFeaturesByObjID(e,b);d(e)},_getFeaturesFromSelection:function(a,b,c,d){var e=[],f=!1,e=b.getSelectedFeatures(),f=!0;c&&(e=this._filterFeaturesByExtent(a.extent,e));e.isSelectedFeatures=f;e=this._sortClientFeaturesByObjID(e,b);d(e)},_getStatisticsFeaturesForServer:function(a){this._updateLayerInfoFilter();this._tryGenerateQueryParameter();this._shouldLaunchQuery()&&
(this.showLoading("sl-sev-st"),this.queryDeferred=this._doQuery(),this.queryDeferred.then(f.hitch(this,function(b){this.queryDeferred=null;this.hideLoading("sl-sev-st");b=b.features||[];b=this._calculateAverageWithNullValueAsZero(b,this.config);a(b,!0)}),f.hitch(this,function(a){this.queryDeferred=null;console.error(a.message||a);this.hideLoading("sl-sev-st");this._onFailed("sl-sev-st")})))},_updateLayerInfoFilter:function(){if(this.dataSource&&"undefined"!==typeof this.dataSource.layerId){var a=
this.layerInfosObj.getLayerInfoById(this.dataSource.layerId);a&&(this._layerFilter=a.getFilter())}},_onFailed:function(){this.emit("failed")},hideLoading:function(a){this._loadingTypes[a]=!1;this._shouldHideLoading()&&this._hideLoading()},showLoading:function(a){this._loadingTypes[a]=!0;this._showLoading()},_showLoading:function(){this.emit("loading",this.uniqueID)},_hideLoading:function(){this.emit("unloading",this.uniqueID)},_shouldHideLoading:function(){if(this._loadingTypes)return Object.keys(this._loadingTypes).map(function(a){return this._loadingTypes[a]}.bind(this)).every(function(a){return!a})},
_onDataUpdate:function(a,b){a=this._getValueByFeatures(a,b);this.emit("data-update",a);setTimeout(function(){this.emit("done")}.bind(this),500)},_getValueByFeatures:function(a,b){if(!a||!a.length)return null;var c=null;this.returnFeatures?a&&(c={features:a,hasStatisticsed:!!b}):c=this._getValueForNumber(a);return c},_getValueForNumber:function(a){return this._isNeededCalculateForClient()?u.statistic(this.statistic,this.dataSource,a):u.getSingleValueForServerStatFeature(a)},_isMapLayer:function(){return"DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===
this.dataSource.dataSourceType},_isLayerOnDemandMode:function(){return this.layerObject&&this.layerObject.currentMode===t.MODE_ONDEMAND},_shouldAccessFeaturesBySelection:function(){return this.useSelection&&this.layerObject&&this.layerObject.getSelectedFeatures().length},_shouldAccessClientFeatures:function(){var a=this.config&&"feature"===this.config.mode,b=this.isDateType,c=this._isSupportServerStatByExtent();return a||b||!c},_isSupportServerStatByExtent:function(){var a=this.layerObject&&this.layerObject.version&&
10.11<=Number(this.layerObject.version),b=this._isLayerSupportStatistics();return a&&b},_isLayerSupportStatistics:function(){if(this.layerObject&&this.layerObject.url){var a=!1;return a=this.layerObject.advancedQueryCapabilities?!!this.layerObject.advancedQueryCapabilities.supportsStatistics:!!this.layerObject.supportsStatistics}},_getLayerRefreshInterval:function(){if(this.layerObject&&this.layerObject.refreshInterval)return this.layerObject.refreshInterval},_sortClientFeaturesByObjID:function(a,
b){if(0<a.length){var d=c.getObjectIdField(b);d&&(b=a[0])&&b.attributes&&b.attributes.hasOwnProperty(d)&&a.sort(function(a,b){a.attributes||(a.attributes={});b.attributes||(b.attributes={});a=a.attributes[d];b=b.attributes[d];return a<b?-1:a>b?1:0})}return a},_filterFeaturesByExtent:function(a,b){var c=a.normalize();return b=b.filter(f.hitch(this,function(a){try{if(a.geometry){var b="point"===a.geometry.type||"multipoint"===a.geometry;return c.some(f.hitch(this,function(c){return b?c.contains(a.geometry):
k.intersects(c,a.geometry)}))}}catch(y){console.error(y)}return!1}))},_calculateAverageWithNullValueAsZero:function(a,c){if(!this._shouldCalcAvgForNullValue(c)||!a||!a.length)return a;c=c.valueFields;if(!c||!c.length)return a;var d=c.map(function(a){return a+"_sum"});a.forEach(function(a){var c=a.attributes;if(c){var e=c.STAT_COUNT;"undefined"===typeof e?(e=c.stat_count,delete c.stat_count):delete c.STAT_COUNT;var f,g,h;d.forEach(function(a){h=a.replace(/_SUM$/gi,"");var d=b.upperCaseString(a);a=
b.lowerCaseString(a);var k=b.upperCaseString(h+"_AVG");f=c[d];"undefined"===typeof f?(f=c[a],delete c[a]):delete c[d];!f&&"number"!==typeof f||!e?c[k]=null:(g=f/e,c[k]=g)})}});return a},_shouldCalcAvgForNullValue:function(a){var b=a&&a.mode;return b&&("category"===b||"field"===b)&&a.nullValue&&"average"===a.operation},_shouldLaunchQuery:function(){var a=!0,b=!(!this.queryDeferred||this.queryDeferred.isResolved()||this.queryDeferred.isRejected()),d=c.isEqual(this._queryParameter,this._oldQueryParameter);
b&&d&&(a=!1);this._oldQueryParameter=f.clone(this._queryParameter);return a},_getOutStatistics:function(a){var c=a.fields,d=a.type,e=a.nullValue,f=d;e&&"avg"===d&&(f="sum");a=null;c&&c.length?(a=c.map(function(a){var c=b.upperCaseString(a+"_"+f),d=new p;d.statisticType=f;d.onStatisticField=a;d.outStatisticFieldName=c;return d}.bind(this)),e&&"avg"===d&&(c=new p,c.statisticType="count",c.onStatisticField=this._getStatisticsFieldForCountType(this.layerObject),c.outStatisticFieldName="STAT_COUNT",a.push(c))):
(c=new p,c.statisticType="count",c.onStatisticField=this._getStatisticsFieldForCountType(this.layerObject),c.outStatisticFieldName="STAT_COUNT",a=[c]);return a},_tryGenerateQueryParameter:function(){this._queryParameter={};this._layerUrl&&(this._queryParameter.url=this._layerUrl);this._layerFilter&&(this._queryParameter.where=this._layerFilter);var a,c,d;if(this.returnFeatures)this.statistic&&(this._queryParameter.outStatistics=this._getOutStatistics(this.statistic),this.statistic.groupByFields&&
(this._queryParameter.groupByFieldsForStatistics=this.statistic.groupByFields));else if(this.statistic){a=this.statistic.type;c=this.statistic.field;d=b.upperCaseString(c+"_"+a);"count"===this.statistic.type&&(c=this._getStatisticsFieldForCountType(this.layerObject),d="STAT_COUNT");var e=new p;e.statisticType=a;e.onStatisticField=c;e.outStatisticFieldName=d;this._queryParameter.outStatistics=[e]}},_getStatisticsFieldForCountType:function(a){var b=null;a&&(b=(a=(a=a.fields)&&a.filter(function(a){return a.type===
this.oidFieldType}.bind(this))[0])&&a.name);return b||"*"},_doQuery:function(){var a=new e;if(!this._queryParameter)return a.reject("Empty query parameter."),a;if(!this._queryParameter.url)return a.reject("Empty layer url."),a;var b=new m(this._queryParameter.url),c=new d;c.where=this._queryParameter.where||"1\x3d1";c.returnGeometry=!1;this.dataSource.filterByExtent&&this.map&&(c.geometry=this.map.extent);this._queryParameter.groupByFieldsForStatistics&&(c.groupByFieldsForStatistics=this._queryParameter.groupByFieldsForStatistics);
if(this._hasVaildOutStatistics(this._queryParameter.outStatistics))c.outStatistics=this._queryParameter.outStatistics;else return a.reject("Invaild outStatistics of query params."),a;this._queryParameter.orderByFields&&(c.orderByFields=this._queryParameter.orderByFields);return b.execute(c)},_hasVaildOutStatistics:function(a){return a&&a.length?a.every(function(a){return this._isTrueOrZero(a.onStatisticField)&&this._isTrueOrZero(a.outStatisticFieldName)&&!!a.statisticType}.bind(this)):!1},_isTrueOrZero:function(a){return!!a||
0===a},_tryGetLayerObject:function(){var a=new e;if("DATA_SOURCE_FEATURE_LAYER_FROM_MAP"!==this.dataSource.dataSourceType)return a.resolve(),a;var b=this.layerInfosObj.getLayerInfoById(this.dataSource.layerId);if(b)return this.layerInfo=b,this.layerObject?(this._layerUrl=this.layerObject.url,a.resolve(),a):b.getLayerObject().then(f.hitch(this,function(a){this.layerObject=a;this._layerUrl=this.layerObject.url}));a.reject("invaild data source");return a},_isNeededCalculateForClient:function(){var a=
this.layerObject&&this.useSelection&&0<this.layerObject.getSelectedFeatures().length,b=this._isSupportServerStatByExtent();return a||!b},_resetExtentChangeHandle:function(){this.exchetChangeHandle&&this.exchetChangeHandle.remove&&(this.exchetChangeHandle.remove(),this.exchetChangeHandle=null)},_resetUpdateEndHandle:function(){this.updateEndHandle&&this.updateEndHandle.remove&&(this.updateEndHandle.remove(),this.updateEndHandle=null)},_resetFilterChangedHandle:function(){this.filterChangedHandle&&
this.filterChangedHandle.remove&&(this.filterChangedHandle.remove(),this.filterChangedHandle=null)},_resetSelectionHandle:function(){this.selectionHandle&&this.selectionHandle.remove&&(this.selectionHandle.remove(),this.selectionHandle=null)},_resetRefreshIntervalHandle:function(){this.refreshIntervalHandle&&this.refreshIntervalHandle.remove&&(this.refreshIntervalHandle.remove(),this.refreshIntervalHandle=null)},_resetTimeIntervalHandle:function(){this.timeIntervalHandle&&(clearInterval(this.timeIntervalHandle),
this.timeIntervalHandle=null)},_removeHandles:function(){this._resetExtentChangeHandle();this._resetUpdateEndHandle();this._resetFilterChangedHandle();this._resetSelectionHandle();this._resetRefreshIntervalHandle();this._resetTimeIntervalHandle();this._resetSelectionHandle()}})})},"widgets/Infographic/dijits/ExtraSourceLauncher":function(){define("dojo/_base/declare dojo/Evented dijit/_WidgetBase jimu/DataSourceManager ../utils ./clientStatistic".split(" "),function(n,f,h,l,e,a){return n([h,f],{constructor:function(a){this.dataSourceManager=
l.getInstance();this.appConfig=a.appConfig;this.frameWorkDsId=a.dataSource.frameWorkDsId;this.returnFeatures=a.returnFeatures;this.formatResult=a.formatResult;this.statistic=a.statistic;this.exdsBeginUpdateHandle=null;this._isStatisticDataSource()},start:function(){this.awake()},awake:function(){this.sleeping=!1;this._getFeaturesForFirst()},sleep:function(){this.sleeping=!0},destroy:function(){this._removeHandles();this.inherited(arguments)},setAppConfigDSFeatures:function(a){this.sleeping||this._onDataUpdate(a)},
_getFeaturesForFirst:function(){var a=this.dataSourceManager.getData(this.dataSource.frameWorkDsId);this._onDataUpdate(a&&a.features)},_onDataUpdate:function(c){var b;this.returnFeatures?c&&(b={features:c,hasStatisticsed:!!this._isStatDataSource}):(b=this._isStatDataSource?a.statisticExtraStatSource(this.statistic,c):a.getStatisticResultFromFeatures(c,this.statistic),this.formatResult&&(b=e.formatterRangeNumber(b)));this.emit("data-update",b)},_isStatisticDataSource:function(){var a=this.appConfig.dataSource&&
this.appConfig.dataSource.dataSources,a=a&&a[this.frameWorkDsId];this._isStatDataSource=!(!a||"FeatureStatistics"!==a.type)},_resetExdsBeginUpdateHandle:function(){this.exdsBeginUpdateHandle&&this.exdsBeginUpdateHandle.remove&&(this.exdsBeginUpdateHandle.remove(),this.exdsBeginUpdateHandle=null)},_removeHandles:function(){this._resetExdsBeginUpdateHandle()}})})},"widgets/Infographic/_ChartSetting":function(){define(["dojo/_base/declare","dojo/_base/html","dijit/_WidgetBase","dijit/_TemplatedMixin",
"dojo/text!./_ChartSetting.html"],function(n,f,h,l,e){return n([h,l],{templateString:e,baseClass:"ig-chart-setting-dlg",postCreate:function(){var a=this.chartJson.config,c=a.type;"pie"===c?(f.setStyle(this.verticalAxisSection,"display","none"),f.setStyle(this.horizontalAxisSection,"display","none"),f.setStyle(this.withoutRecordsSection,"display","none")):f.setStyle(this.dataLabelsSection,"display","none");this.chartJson.config.dateConfig||f.setStyle(this.withoutRecordsSection,"display","none");this._calcuteLegendDisplay(a)||
f.setStyle(this.legendSection,"display","none");"count"!==this.chartJson.config.mode&&"field"!==this.chartJson.config.mode||"pie"===c||f.setStyle(this.legendSection,"display","none");(a=this.chartJson.config.legend)&&a.show&&this._toggle(this.legendToggle);(a=this.chartJson.config.dataLabel)&&a.show&&this._toggle(this.dataLabelsToggle);(a=this.chartJson.config.xAxis)&&a.show&&this._toggle(this.horizontalAxisToggle);(a=this.chartJson.config.yAxis)&&a.show&&this._toggle(this.verticalAxisToggle);this.chartJson.config.dateConfig&&
this.chartJson.config.dateConfig.isNeedFilled&&this._toggle(this.withoutRecordsToggle)},_calcuteLegendDisplay:function(a){var c=a.mode,b;"pie"===a.type?b=!0:(b=!0,"count"===c||"field"===c?b=!1:a.seriesStyle&&(b="layerSymbol"!==a.seriesStyle.type));return b},_toggle:function(a){f.hasClass(a,"toggle-on")?(f.removeClass(a,"toggle-on"),f.addClass(a,"toggle-off")):(f.removeClass(a,"toggle-off"),f.addClass(a,"toggle-on"))},_onToggleClick:function(a){var c=a.target;this._toggle(c);a=f.hasClass(c,"toggle-on")?
!0:!1;c=f.attr(c,"data-id");"legend"===c?this.chartJson.config.legend.show=a:"dataLabels"===c?this.chartJson.config.dataLabel.show=a:"horizontalAxis"===c?this.chartJson.config.xAxis.show=a:"verticalAxis"===c?this.chartJson.config.yAxis.show=a:"withoutRecords"===c&&this.chartJson.config.dateConfig&&(this.chartJson.config.dateConfig.isNeedFilled=a);this.chartDijit.setConfig(this.chartJson.config);this.chartDijit.startRendering()}})})},"widgets/Infographic/IGUtils":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/promise/all esri/tasks/query esri/tasks/QueryTask jimu/LayerInfos/LayerInfos jimu/DataSourceManager jimu/utils ./utils".split(" "),
function(n,f,h,l,e,a,c,b,g,k){return n([],{constructor:function(a){this.appConfig=a.appConfig;this.map=a.map;this.layerInfosObj=c.getInstanceSync();this.dataSourceManager=b.getInstance()},preprocessingDataSource:function(a){var b=new f;if(!a)return b.resolve(),b;var c=this._tryGetLayerIdDataSchema(a),d=c.dataSchema,c=this._tryGetLayerObject(c.layerId);a=this._tryGetLayerForFrameWork(d,a);l([c,a]).then(function(a){var c=a[0];b.resolve({layerObject:c&&c.layerObject,popupInfo:c&&c.popupInfo,featureLayerForFrameWork:a[1]})},
function(a){b.reject(a)});return b},preprocessingDataSourceForSetting:function(a){var b=new f;if(!a)return b.resolve(),b;var c=this._tryGetLayerIdDataSchema(a),d=c.layerId,e=c.dataSchema,c=this._tryGetLayerObject(d),e=this._tryGetLayerForFrameWork(e,a),d=this.getLayerDefinitionByDataSource(a,d);a=this.getFeaturesByDataSource(a);l([c,e,d,a]).then(function(a){var c=a[0],d=c&&c.layerObject,c=c&&c.popupInfo,e=a[1],f=a[2];a=a[3];a=this._cutFeaturesForSetting(a);b.resolve({layerObject:d,popupInfo:c,featureLayerForFrameWork:e,
definition:f,features:a})}.bind(this),function(a){b.reject(a)});return b},preprocessingDataSourceForRange:function(a){var b=new f;if(!a)return b.resolve(),b;var c=this._tryGetLayerIdDataSchema(a).layerId,c=this.getLayerDefinitionByDataSource(a,c);a=this.getFeaturesByDataSource(a);l([c,a]).then(function(a){var c=a[0];a=a[1];a=this._cutFeaturesForSetting(a);b.resolve({definition:c,features:a})}.bind(this),function(a){b.reject(a)});return b},_tryGetLayerIdDataSchema:function(a){var b={layerId:"",dataSchema:null};
if(a.layerId)this.dsType="CLIENT_FEATURES",b.layerId=a.layerId;else if(a.frameWorkDsId){a=(a=k.getDsTypeInfoMeta(a.frameWorkDsId,this.appConfig))&&a.dsMeta;if(!a)return b;"Features"===a.type?this.dsType="FRAMEWORK_FEATURES":"FeatureStatistics"===a.type&&(this.dsType="FRAMEWORK_STATISTICS");b.dataSchema=a.dataSchema;a=k.parseDataSourceId(a.id);b.layerId=a&&a.layerId}return b},_tryGetLayerObject:function(a){var b=new f;if(!a)return b.resolve(),b;a=this._tryGetLayerInfo(a);if(!a)return console.error("Invalid data source"),
b.resolve(),b;var c=a.getPopupInfo();a.getLayerObject().then(function(a){b.resolve({layerObject:a,popupInfo:c})}.bind(this),function(a){b.reject(a)});return b},_tryGetLayerForFrameWork:function(a,b){var c=new f;if(!a)return c.resolve(),c;var d=a;"FRAMEWORK_STATISTICS"===this._getDataSourceType(b)&&(d=k.mockLayerDefinitionForSTD(a));k.getLoadedLayer(d).then(function(a){c.resolve(a)}.bind(this),function(a){c.reject(a)});return c},_tryGetLayerInfo:function(a){var b=this.layerInfosObj.getLayerInfoById(a);
b||(b=this.layerInfosObj.getTableInfoById(a));return b},getLayerDefinitionByDataSource:function(a,b){var c=new f;if(!a)return console.error("Invalid data source"),c.resolve(),c;var d;if(a.layerId){b=this._tryGetLayerInfo(a.layerId);if(!b)return c.reject("Invalid data source"),c;d=b.getPopupInfo();this._getServiceDefinitionByLayerInfo(b).then(function(a){k.addAliasForLayerDefinition(a,d);c.resolve(a)}.bind(this),function(a){c.reject(a)});return c}if(a.frameWorkDsId){b&&(b=this._tryGetLayerInfo(b))&&
(d=b.getPopupInfo());b=null;a=(this.appConfig.dataSource&&this.appConfig.dataSource.dataSources)[a.frameWorkDsId];if("Features"===a.type)return b=h.clone(a.dataSchema),k.addAliasForLayerDefinition(b,d),c.resolve(b),c;if("FeatureStatistics"===a.type)return b={type:"Table",fields:[]},a=h.clone(a.dataSchema),b.fields=a.fields,a.groupByFields&&a.groupByFields[0]&&(b.groupByFields=h.clone(a.groupByFields)),k.addAliasForLayerDefinition(b,d),c.resolve(b),c}},_getDataSourceType:function(a){if(a){if(a.layerId)return"CLIENT_FEATURES";
if(a.frameWorkDsId&&(a=(a=k.getDsTypeInfoMeta(a.frameWorkDsId,this.appConfig))&&a.dsMeta)){if("Features"===a.type)return"FRAMEWORK_FEATURES";if("FeatureStatistics"===a.type)return"FRAMEWORK_STATISTICS"}}},_getServiceDefinitionByLayerInfo:function(a){var b=new f;a.getServiceDefinition().then(h.hitch(this,function(c){c?b.resolve(c):a.getLayerObject().then(function(a){a?(a=g.getFeatureLayerDefinition(a),b.resolve(a)):b.resolve(null)},function(a){b.reject(a)})}));return b},getFeaturesByDataSource:function(a){var b=
new f,c=null;if("DATA_SOURCE_FEATURE_LAYER_FROM_MAP"===a.dataSourceType){a=a.layerId;if(!a)return b.resolve(),b;this._getFeaturesForMapDS(a).then(function(a){c=a.features;b.resolve(c)},function(a){b.reject(a)})}else{a=a.frameWorkDsId;if(!a)return b.resolve(),b;this.getFeaturesForFrameDS(a).then(function(a){c=a.features;b.resolve(c)},function(a){b.reject(a)})}return b},_cutFeaturesForSetting:function(a){a&&1E3<a.length&&(a=a.slice(0,1E3));return a},_getFeaturesForMapDS:function(b){var c=new f,d=this._tryGetLayerInfo(b);
if(!d)return c.reject("Can not get layerInfo by the layer id of this data source."),c;b=d.getUrl();var g=d.getFilter();if(!b)return console.warn("Invalid layer url of data source, use client features."),d.getLayerObject().then(function(a){c.resolve({features:a.graphics})}),c;d=new e;d.outSpatialReference=this.map.spatialReference;d.where=g||"1\x3d1";d.outFields=["*"];d.returnGeometry=!1;return(new a(b)).execute(d)},getFeaturesForFrameDS:function(a){var b=new f;if("widget"===k.parseDataSourceId(a).from)return b.resolve({}),
b;a=this.dataSourceManager.getDataSourceConfig(a);a=h.clone(a);if(!a)return b.reject("Can not get vaild data source config by the frameWorkDsId of this data source."),b;a.filterByExtent=!1;this.dataSourceManager.doQuery(a).then(function(a){b.resolve(a)},function(a){b.reject(a)});return b}})})},"widgets/Infographic/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Infographic/dijits/ChartDijit.html":'\x3cdiv style\x3d"width:100%;height:100%;"\x3e\r\n    \x3cdiv style\x3d"display: none;" data-dojo-attach-point\x3d"yAxisName" class\x3d"y-axis-name rotate"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"chart-dijit" style\x3d"width:100%;height:100%;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"noDataDiv" class\x3d"no-data-tip"\x3e${nls.noData}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"overlap" class\x3d"over-lay hide"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"chart-dom" data-dojo-attach-point\x3d"chartDomNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Infographic/_ChartSetting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"legendSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.legend}"\x3e${nls.legend}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"legendToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"legend"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"dataLabelsSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.dataLabels}"\x3e${nls.dataLabels}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"dataLabelsToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"dataLabels"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"horizontalAxisSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.horizontalAxis}"\x3e${nls.horizontalAxis}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"horizontalAxisToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"horizontalAxis"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"verticalAxisSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.verticalAxis}"\x3e${nls.verticalAxis}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"verticalAxisToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"verticalAxis"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n   \x3cdiv class\x3d"flex section" data-dojo-attach-point\x3d"withoutRecordsSection"\x3e\r\n    \x3cdiv class\x3d"label textOverFlow" title\x3d"${nls.showPeriodsWithoutRecords}"\x3e${nls.showPeriodsWithoutRecords}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"withoutRecordsToggle" data-dojo-attach-event\x3d"onclick:_onToggleClick" class\x3d"jimu-leading-margin10 toggle toggle-off" data-id\x3d"withoutRecords"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:widgets/Infographic/Widget.html":'\x3cdiv style\x3d"width: 100%;height: 100%;"\x3e\r\n\t \x3cdiv data-dojo-attach-point\x3d"shelter" class\x3d"loading hide"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Infographic/css/style.css":'@font-face {font-family: \'icomoon\'; src: url("fonts/icomoon.eot?oflavm"); src: url("fonts/icomoon.eot?oflavm#iefix") format(\'embedded-opentype\'), url("fonts/icomoon.ttf?oflavm") format(\'truetype\'), url("fonts/icomoon.woff?oflavm") format(\'woff\'), url("fonts/icomoon.svg?oflavm#icomoon") format(\'svg\'); font-weight: normal; font-style: normal;}.jimu-widget-infographic .indicator-icon,.jimu-widget-infographic-setting .indicator-icon {font-family: \'icomoon\' !important; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.jimu-widget-infographic .loading {position: absolute; overflow: hidden; bottom: 4px; right: 0; width: 17px; height: 17px; z-index: 101;}.jimu-rtl .jimu-widget-infographic .loading {left: 2px; right: auto;}.jimu-widget-infographic .loading {font-size: 10px; text-indent: -9999em; border-top: 3px solid rgba(219, 206, 206, 0.7); border-right: 3px solid rgba(219, 206, 206, 0.7); border-bottom: 3px solid rgba(219, 206, 206, 0.7); border-left: 3px solid #ffffff; -webkit-transform: translateZ(0); -ms-transform: translateZ(0); transform: translateZ(0); -webkit-animation: load8 1.1s infinite linear; animation: load8 1.1s infinite linear; box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.2); border-radius: 8px;}.jimu-widget-infographic .loading:after {border-radius: 50%; width: 24px; height: 24px;}.jimu-widget-infographic .hide {display: none !important;}.icon-like:before {content: "\\e900";}.icon-unlike:before {content: "\\e904";}.icon-stop:before {content: "\\e902";}.icon-danger:before {content: "\\e901";}.icon-star:before {content: "\\e903";}.icon-alarm:before {content: "\\e906";}.icon-down:before {content: "\\e909";}.icon-right:before {content: "\\e90f";}.icon-up:before {content: "\\e911";}.icon-wrong:before {content: "\\e912";}.lm_goldenlayout .lm_item .lm_content {position: relative;}.lm_goldenlayout .lm_item .lm_content .table-layout-container {display: table; table-layout: fixed; overflow: hidden; width: 100%; height: 100%;}.lm_goldenlayout .lm_item .lm_content .table-layout-container \x3e div {padding: 10px 15px;}.lm_goldenlayout .lm_item .lm_content .image-node {display: table-cell; overflow: hidden; position: relative; width: 100%; height: 100%;}.lm_goldenlayout .lm_item .lm_content .no-trim {white-space: pre-wrap;}.infographic-number-dijit {display: flex; justify-content: center; align-items: center;}.infographic-number-dijit .number-content .value-content {white-space: nowrap;}.infographic-number-dijit a,.infographic-number-dijit a:hover,.infographic-number-dijit a:visited,.infographic-number-dijit a:link,.infographic-number-dijit a:active {text-decoration: none;}.infographic-number-dijit.horizontal-left {justify-content: flex-start;}.infographic-number-dijit.horizontal-center {justify-content: center;}.infographic-number-dijit.horizontal-right {justify-content: flex-end;}.infographic-number-dijit.vertical-top {align-items: flex-start;}.infographic-number-dijit.vertical-middle {align-items: center;}.infographic-number-dijit.vertical-bottom {align-items: flex-end;}.infographic-number-dijit .number-content {display: flex; justify-content: center; max-width: 340px;}.infographic-number-dijit .number {display: flex; justify-content: space-between; align-items: baseline;}.infographic-number-dijit .indicator-icon {font-size: 22px; align-self: center; text-align: center;}.infographic-number-dijit .number .prefix {margin-right: 6px;}.infographic-number-dijit .number .suffix {margin-left: 6px;}.infographic-number-dijit .rightImgDiv {width: 35%; height: 100%; text-align: left;}.jimu-widget-infographic .infographic-number-dijit,.jimu-widget-infographic .infographic-chart-dijit,.jimu-widget-infographic .infographic-gauge-dijit {position: relative;}.infographic-chart-dijit .over-lay.hide {display: none !important;}.infographic-chart-dijit .over-lay {display: block; z-index: 99; position: absolute; left: 0; top: 0; height: 100%; width: 100%;}.infographic-number-dijit .no-data-tip,.infographic-chart-dijit .no-data-tip,.infographic-gauge-dijit .no-data-tip {display: none; position: absolute; left: 0; right: 0; height: 30px; top: calc(50% - 10px); text-align: center; color: #666;}.infographic-number-dijit.no-data .no-data-tip,.infographic-chart-dijit.no-data .no-data-tip,.infographic-gauge-dijit.no-data .no-data-tip {display: block; margin: 0 10px;}.infographic-number-dijit.no-data .chart-dom,.infographic-chart-dijit.no-data .chart-dom,.infographic-gauge-dijit.no-data .gauge-dom {visibility: hidden;}.infographic-number-dijit .chart-dom,.infographic-chart-dijit .chart-dom,.infographic-gauge-dijit .gauge-dom {visibility: visible; width: 100%; height: 100%;}.infographic-chart-dijit {display: flex;}.infographic-chart-dijit .y-axis-name {width: 30px; height: 100%; flex: 0 1 auto; justify-content: center; align-items: center; display: flex; white-space: nowrap; font-family: sans-serif; font-size: 12px;}.infographic-chart-dijit .y-axis-name.rotate {transform: rotate(-90deg); -webkit-transform: rotate(-90deg); -moz-transform: rotate(-90deg); -ms-transform: rotate(-90deg); -o-transform: rotate(-90deg); filter: progid:DXImageTransform.Microsoft.BasicImage(rotation\x3d3);}.infographic-chart-dijit .chart-dijit {width: calc(100% - 30px); height: 100%; flex: 1 1 auto;}.jimu-widget-infographic {position: relative; width: 100%; height: 100%;}.jimu-widget-infographic .chart-setting {position: absolute; top: 0; right: 0; cursor: pointer; width: 16px; height: 16px; background: no-repeat center center url(images/chart-setting.svg); z-index: 1;}.jimu-rtl .jimu-widget-infographic .chart-setting {left: 0; right: auto;}.ig-chart-setting-dlg .jimu-leading-margin10 {margin-left: 10px; margin-right: 0;}.jimu-rtl .ig-chart-setting-dlg .jimu-leading-margin10 {margin-right: 10px; margin-left: 0;}.ig-chart-setting-dlg .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.ig-chart-setting-dlg .flex {display: flex; justify-content: space-between; margin-top: 8px;}.ig-chart-setting-dlg .label {width: 120px;}.ig-chart-setting-dlg .toggle {width: 38px; height: 18px; cursor: pointer;}.ig-chart-setting-dlg .toggle.toggle-on {background: no-repeat center left url(./images/toggle_on_light.svg);}.ig-chart-setting-dlg .toggle.toggle-off {background: no-repeat center left url(./images/toggle_off_light.svg);}',
"*now":function(n){n(['dojo/i18n!*preload*widgets/Infographic/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Deferred dijit/_WidgetsInTemplateMixin dijit/popup dijit/TooltipDialog jimu/BaseWidget jimu/dijit/GridLayout jimu/LayerInfos/LayerInfos jimu/utils ./DijitFactory jimu/DataSourceManager ./dijits/SourceLauncher ./dijits/ExtraSourceLauncher ./_ChartSetting ./IGUtils ./utils".split(" "),function(n,f,h,l,e,a,c,b,g,k,d,m,p,t,u,q,v,w,x,r){return n([k,c],{name:"Infographic",baseClass:"jimu-widget-infographic",dijits:null,
clientFeaturesHandle:null,layerInfosObj:null,dataSource:null,mainDijit:null,mainDijitJson:null,mainDijitVisible:!1,postMixInProperties:function(){this.inherited(arguments);this.layerInfosObj=m.getInstanceSync();this._loadingTypes={}},postCreate:function(){this.inherited(arguments);this._initGolbalInfo();this._listenDSManagerUpdateEvent();this._initDijitFactory();this._initSettingIconEvent()},startup:function(){this.inherited(arguments);this._renderByConfig(this.config);this.mainDijit=this._getMainDijit();
this._createRuntimeSettingIocn(this.config);this._checkDataSource(this.config);this.mainDijitVisible&&this._avalidDataSource&&(this._processdsdef=this._preprocessingDataSource())},_listenDSManagerUpdateEvent:function(){this.exdsBeginUpdateHandle=e(this.dataSourceManager,"begin-update",f.hitch(this,function(a){this._handleLoadingStatusForExds(a,!0)}))},_checkDataSource:function(a){a=this._checkDataSourceCode(a&&a.dataSource);this._avalidDataSource=0===a.code;!this._avalidDataSource&&this.mainDijit&&
this.mainDijit.showNodata(a.message)},onOpen:function(){this._processdsdef?this._processDataSource():this._onOpenTriger()},_onOpenTriger:function(){this.mainDijitVisible&&this._avalidDataSource&&this._isDOMInitialized().then(function(){clearInterval(this.domReadyInterval);this._initSourceLaunchers();this.resize()}.bind(this))},_onMainValueUpdate:function(a){if(this.mainDijit&&this._shouldUpdateValue(a,"MAIN")){if("gauge"===this.mainDijit.type&&(a=this._spellGaugeValueObj(),!this._isGaugeValueObjValid(a)))return;
this.mainDijit.onDataSourceDataUpdate(a);this.mainDijit.startRendering()}},_onRangeValueUpdate:function(a,b){this._shouldUpdateValue(a,b?"RANGE1":"RANGE2")&&(a=this._spellGaugeValueObj(),this._isGaugeValueObjValid(a)&&(this.mainDijit.onDataSourceDataUpdate(a),this.mainDijit.startRendering()))},_processDataSource:function(){this.showLoading("process-ds");this._processdsdef.then(function(){this.hideLoading("process-ds");this._processdsdef=null;this._setDataSource();this._setLayerInfoToMainDijit();this._onOpenTriger()}.bind(this),
function(a){this.hideLoading("process-ds");this._processdsdef=null;console.error(a)}.bind(this))},_setDataSource:function(){var a=this.config&&this.config.dataSource;a&&this.dijits&&this.dijits.length&&this.dijits.forEach(function(b){b.setDataSource(a)})},_initSourceLaunchers:function(){if(this.config.dataSource){var a=this.mainDijitJson||this._getMainDijitJson();this.sourceLauncher?this.sourceLauncher.awake():(this._initSourceLauncher(),this.sourceLauncher.start());"gauge"===a.type&&this._initRangeSourceLauncher(a)}},
resize:function(){this.inherited(arguments);this.layout&&this.layout.resize();this.mainDijit&&this.mainDijit.resize&&this.mainDijit.resize()},onClose:function(){this.sourceLauncher&&this.sourceLauncher.sleep();this.rangeSourceLauncher1&&this.rangeSourceLauncher1.sleep();this.rangeSourceLauncher2&&this.rangeSourceLauncher2.sleep();this.runtimeSettingDialog&&this.runtimeSettingDialog.isShow&&(b.close(this.runtimeSettingDialog),this.runtimeSettingDialog.isShow=!1)},onDataSourceDataUpdate:function(a,
b){this._handleLoadingStatusForExds(a,!1);var c=this.config.dataSource,d=this.rangeDataSource1,e=this.rangeDataSource2;c&&a===c.frameWorkDsId&&this.sourceLauncher&&this.sourceLauncher.setAppConfigDSFeatures(b.features);d&&a===d.frameWorkDsId&&this.rangeSourceLauncher1&&this.rangeSourceLauncher1.setAppConfigDSFeatures(b.features);e&&a===e.frameWorkDsId&&this.rangeSourceLauncher2&&this.rangeSourceLauncher2.setAppConfigDSFeatures(b.features)},_handleLoadingStatusForExds:function(a,b){var c=this.config.dataSource,
d=this.rangeDataSource1,e=this.rangeDataSource2,d=d&&d.frameWorkDsId,e=e&&e.frameWorkDsId;if(a===(c&&c.frameWorkDsId)||a===d||a===e)b?this.showLoading(a):this.hideLoading(a)},destroy:function(){this.sourceLauncher&&this.sourceLauncher.destroy();this.rangeSourceLauncher1&&this.rangeSourceLauncher1.destroy();this.rangeSourceLauncher2&&this.rangeSourceLauncher2.destroy();this.runtimeSettingDialog&&(this.runtimeSettingDialog.destroy(),this.runtimeSettingDialog=null);this.exdsBeginUpdateHandle&&this.exdsBeginUpdateHandle.remove&&
(this.exdsBeginUpdateHandle.remove(),this.exdsBeginUpdateHandle=null);this._loadingTypes={};this.inherited(arguments)},_initGolbalInfo:function(){this.dataSourceManager=u.getInstance();this._features=[];this.featureLayerForFrameWork=this.popupInfo=this.layerObject=null;if(this.mainDijitJson=this._getMainDijitJson())this._initRangeValue(this.mainDijitJson),this._ininRangeDataSource(this.mainDijitJson),this.mainDijitVisible=this.mainDijitJson&&this.mainDijitJson.visible,this.dijits=[],this.igUtils=
new x({appConfig:this.appConfig,map:this.map})},_initDijitFactory:function(){t.setNls(this.nls);t.setMap(this.map);t.setInSettingPage(!1);t.setAppConfig(this.appConfig);t.setContext({folderUrl:this.folderUrl})},_initSettingIconEvent:function(){this.on("click",f.hitch(this,function(){this.runtimeSettingDialog&&b.close(this.runtimeSettingDialog)}))},_renderByConfig:function(a){a&&a.layout&&a.dijits&&(this._clearDijits(),this._createLayoutWithDijits(a))},_initRangeSourceLauncher:function(a){var b=this._initRangeData(a);
a=b.rst1;b=b.rst2;this.rangeSourceLauncher1?this.rangeSourceLauncher1.awake():a&&this.rangeDataSource1&&(this._initRangeLauncher(a,this.rangeDataSource1,!0),this.rangeSourceLauncher1.start());this.rangeSourceLauncher2?this.rangeSourceLauncher2.awake():b&&this.rangeDataSource2&&(this._initRangeLauncher(b,this.rangeDataSource2,!1),this.rangeSourceLauncher2.start())},showLoading:function(a){this._loadingTypes[a]=!0;this._showLoading()},hideLoading:function(a){this._loadingTypes[a]=!1;this._shouldHideLoading()&&
this._hideLoading()},_shouldHideLoading:function(){if(this._loadingTypes)return Object.keys(this._loadingTypes).map(function(a){return this._loadingTypes[a]}.bind(this)).every(function(a){return!a})},_showLoading:function(){l.hasClass(this.shelter,"hide")&&l.removeClass(this.shelter,"hide")},_hideLoading:function(){l.hasClass(this.shelter,"hide")||l.addClass(this.shelter,"hide")},_HandlingOutliers:function(a){if(this.mainDijit&&!r.isValidValue(a))return this.mainDijit.showNodata(),!0},_spellGaugeValueObj:function(){return{value:this.MAIN_VALUE,
ranges:[this.RANGE1_VALUE,this.RANGE2_VALUE]}},_isGaugeValueObjValid:function(a){var b=a&&a.ranges;if(!a||!b)return!1;var c=b[0],b=b[1];(a=r.isValidValue(a.value)&&r.isValidValue(c)&&r.isValidValue(b))||this.mainDijit.showNodata();return a},_checkDataSourceCode:function(a){var b=this.mainDijitJson;if(!b)return{};var c,d;a=r.checkDataSourceIsVaild(a,b,this.map,this.appConfig,"value");"gauge"===b.type&&(this.rangeDataSource1&&(c=r.checkDataSourceIsVaild(this.rangeDataSource1,b,this.map,this.appConfig,
"range1")),this.rangeDataSource2&&(d=r.checkDataSourceIsVaild(this.rangeDataSource2,b,this.map,this.appConfig,"range2")));var b=[a,c,d],e="";c=r.getCheckDataSourceResultCode(b);b.forEach(function(a){e+=this._getDSErrorString(a)}.bind(this));return{code:c,message:e}},_getDSErrorString:function(a){var b="";if(!a)return b;if(1===a.code||3===a.code)a.label===this._lastDataSourceLabel?b="":(b=this.nls.dataSource+" "+a.label+" "+this.nls.dsErrorTipSuf,this._lastDataSourceLabel=a.label);2===a.code&&(b=this.nls.fieldString+
" "+a.fields.join(",")+" "+this.nls.dsErrorTipSuf);return b},_clearDijits:function(){this.dijits&&this.dijits.length&&this.dijits.forEach(f.hitch(this,function(a){a.destroy()}));this.dijits=[]},_createLayoutWithDijits:function(a){var b=a.dijits;b&&b.length&&(b=b.map(function(a){var b=t.createDijit(a);this.dijits.push(b);return{id:a.id,dijit:b}},this),this.layout=new d({components:b,layoutDefinition:a.layout.definition,container:this.domNode,editable:!1}),this.layout.on("initialised",f.hitch(this,
function(){h.forEach(this.dijits,f.hitch(this,function(a){a.startup()}))})))},_getMainDijit:function(){if(this.dijits&&this.dijits.length){var a=null,b=["number","gauge","chart"];return a=this.dijits.filter(function(a){return-1<b.indexOf(a.type)})[0]}},_getMainDijitJson:function(){if(this.config&&this.config.dijits&&this.config.dijits.length){var a=null,b=["number","gauge","chart"];return a=this.config.dijits.filter(function(a){return-1<b.indexOf(a.type)})[0]}},_initRangeValue:function(a){a&&"gauge"===
a.type&&(a=r.getRangeFixedValue(a),this.RANGE1_VALUE=a.range1,this.RANGE2_VALUE=a.range2)},_ininRangeDataSource:function(a){a=r.getRangeDataSource(a);this.rangeDataSource1=a.range1;this.rangeDataSource2=a.range2},_setLayerInfoToMainDijit:function(){this.mainDijit&&this.mainDijit.setLayerInfo(this.layerObject,this.featureLayerForFrameWork,this.popupInfo)},_createRuntimeSettingIocn:function(a){this.mainDijitVisible&&a.dijits&&a.dijits.length&&a.dijits.some(function(a){return a.visible&&"chart"===a.type},
this)&&(this.runtimeSettingIcon=l.create("div",{"class":"chart-setting"},this.domNode),this.own(e(this.runtimeSettingIcon,"click",f.hitch(this,this._onRuntimeSettingIconClicked))),this.runtimeSettingDialog=new g({content:this._createChartSettingContent(a)}),this.runtimeSettingDialog.isShow=!1)},_onRuntimeSettingIconClicked:function(a){this.runtimeSettingDialog.isShow?(b.close(this.runtimeSettingDialog),this.runtimeSettingDialog.isShow=!1):(b.open({popup:this.runtimeSettingDialog,around:this.runtimeSettingIcon}),
this.runtimeSettingDialog.isShow=!0);a.stopPropagation()},_createChartSettingContent:function(a){var b=a.dijits.filter(function(a){return"chart"===a.type})[0];return b?b.config?(new w({chartJson:b,chartDijit:this.dijits.filter(function(a){return a.jsonId===b.id})[0],nls:this.nls})).domNode:"\x3cdiv\x3e\x3c/div\x3e":(console.error("Unknow error"),"\x3cdiv\x3e\x3c/div\x3e")},_isDOMInitialized:function(){var b=new a;setTimeout(function(){this.domReadyInterval=setInterval(function(){var a=this.mainDijit&&
this.mainDijit.domNode;a&&(a=l.getMarginBox(a),a.w&&a.h&&b.resolve())}.bind(this),200)}.bind(this),200);return b},_initSourceLauncher:function(){var a=this.config.dataSource;if(a){var b=this._getMainDijitJson();if(b&&b.config){var c=null,c="chart"===b.type?r.getStatisticForChart(b.config):r.getStatisticForGauge(b.config).value;this.sourceLauncher="DATA_SOURCE_FROM_FRAMEWORK"===a.dataSourceType?new v({appConfig:this.appConfig,dataSource:a,statistic:c,returnFeatures:"chart"===b.type,formatResult:!1}):
new q({layerObject:this.layerObject,map:this.map,appConfig:this.appConfig,useSelection:a.useSelection,filterByExtent:a.filterByExtent,dataSource:a,config:b.config,statistic:c,returnFeatures:"chart"===b.type});this._listenSourceLauncherEvent()}}},_initRangeData:function(a){if("gauge"===a.type&&a&&a.config)return a=r.getStatisticForGauge(a.config),{rst1:a.range1,rst2:a.range2}},_initRangeLauncher:function(a,b,c){c?a&&(this.rangeSourceLauncher1=new v({appConfig:this.appConfig,dataSource:b,statistic:a,
returnFeatures:!1,formatResult:!0}),this._listenRangeLauncherEvent(this.rangeSourceLauncher1,!0)):a&&(this.rangeSourceLauncher2=new v({appConfig:this.appConfig,dataSource:b,statistic:a,returnFeatures:!1,formatResult:!0}),this._listenRangeLauncherEvent(this.rangeSourceLauncher2,!1))},_listenSourceLauncherEvent:function(){this.own(e(this.sourceLauncher,"data-update",f.hitch(this,function(a){this._onMainValueUpdate(a)})));this.own(e(this.sourceLauncher,"loading",f.hitch(this,function(a){this.showLoading(a)})));
this.own(e(this.sourceLauncher,"unloading",f.hitch(this,function(a){this.hideLoading(a)})));this.own(e(this.sourceLauncher,"failed",f.hitch(this,function(){this._HandlingOutliers()})));this.own(e(this.sourceLauncher,"start",f.hitch(this,function(){this._onMainSourceLauncherStart()})));this.own(e(this.sourceLauncher,"done",f.hitch(this,function(){this._onMainSourceLauncherDone()})))},_onMainSourceLauncherStart:function(){if(this.mainDijit&&"function"===typeof this.mainDijit.onUpdateDataStart)this.mainDijit.onUpdateDataStart()},
_onMainSourceLauncherDone:function(){if(this.mainDijit&&"function"===typeof this.mainDijit.onUpdateDataDone)this.mainDijit.onUpdateDataDone()},_listenRangeLauncherEvent:function(a,b){a&&this.own(e(a,"data-update",f.hitch(this,function(a){this._onRangeValueUpdate(a,b)})))},_isDifferentValues:function(a,b){var c=!0,d=this[b+"_VALUE"];if(a&&"undefined"!==typeof a.hasStatisticsed){var e=null,f=null;a.features&&(e=a.features.map(function(a){return a.attributes}));d&&d.features&&(f=d.features.map(function(a){return a.attributes}));
p.isEqual(f,e)&&(c=!1)}else c=a!==d;c&&(this[b+"_VALUE"]=a);return c},_shouldUpdateValue:function(a,b){b=this._isDifferentValues(a,b);a=this._HandlingOutliers(a);return b&&!a},_preprocessingDataSource:function(){var b=this.config&&this.config.dataSource,c=new a;return b?this.igUtils.preprocessingDataSource(b).then(function(a){this.layerObject=a&&a.layerObject;this.popupInfo=a&&a.popupInfo;this.featureLayerForFrameWork=a&&a.featureLayerForFrameWork}.bind(this)):(c.reject("Empty data source"),c)}})});